import{e as G,d as k,g as L,r as R,j as e,C as P,c as z,T as b,z as F,Y as E,U as O}from"./index-DSFjr4LC.js";import{T as f}from"./target-Br11xYyw.js";import{C as K}from"./calendar-DV25Uk9k.js";import{D}from"./dollar-sign-BAYeXQUA.js";import{T as Q}from"./trending-down-Ds5j0a5S.js";import{A as V}from"./activity-oOeqT2p4.js";import{R as v,C as N,T as y,L as H}from"./generateCategoricalChart-DOu4sEKH.js";import{P as w,a as C}from"./PieChart-0xBMv0O7.js";import{m as Y}from"./proxy-Bhx3FPuK.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=G("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);function $(t){if(!t.endDate)return"amber";const s=new Date,n=new Date(t.endDate),r=new Date(t.startDate),l=k(n,r),a=k(s,r),c=t.progress||0,o=l>0?a/l*100:0,x=c-o;return x>=-5?"green":x>=-15?"amber":"red"}function W(t){const s=t.budget||t.totalBudget||0,n=t.actualCost||t.budgetUsed||0,r=t.progress||0;if(s===0)return"amber";const l=r/100*s,a=(n-l)/s*100;return a<=5?"green":a<=15?"amber":"red"}function X(t){const n=(t.risks||[]).filter(a=>a.status!=="resolved"&&a.status!=="accepted");if(n.length===0)return"green";const r=n.filter(a=>a.priority==="critical").length,l=n.filter(a=>a.priority==="high").length;return r>0?"red":l>2||n.length>5?"amber":"green"}function T(t){const s=t.tasks||[];if(s.length===0)return"amber";const r=s.filter(c=>c.progress===100).length/s.length*100,l=t.progress||0,a=Math.abs(r-l);return a<=10?"green":a<=25?"amber":"red"}function Z(t){const s=$(t),n=T(t);return s==="green"&&n==="green"?"green":s==="red"||n==="red"?"red":"amber"}function _(t){const s=[t.scheduleHealth,t.budgetHealth,t.scopeHealth,t.qualityHealth,t.riskHealth],n=s.filter(l=>l==="red").length,r=s.filter(l=>l==="amber").length;return n>0?"red":r>2||r>0?"amber":"green"}function M(t){const s=$(t),n=W(t),r=T(t),l=Z(t),a=X(t),c=_({projectId:t.id,projectName:t.name,scheduleHealth:s,budgetHealth:n,scopeHealth:r,qualityHealth:l,riskHealth:a});return{projectId:t.id,projectName:t.name,scheduleHealth:s,budgetHealth:n,scopeHealth:r,qualityHealth:l,riskHealth:a,overallHealth:c,trend:"stable"}}function ee(t){const s=t.filter(i=>i.status==="active"),n=t.filter(i=>i.status==="completed"),r=t.filter(i=>i.status==="on-hold"),l=t.reduce((i,d)=>i+(d.budget||d.totalBudget||0),0),a=t.reduce((i,d)=>i+(d.actualCost||d.budgetUsed||0),0),c=t.reduce((i,d)=>i+(d.score||0)*1e5,0),o=s.map(M),x=o.filter(i=>i.overallHealth==="green").length,m=o.filter(i=>i.overallHealth==="amber").length,g=o.filter(i=>i.overallHealth==="red").length,p=t.flatMap(i=>i.risks||[]).filter(i=>i.status!=="resolved"&&i.status!=="accepted"),A=p.reduce((i,d)=>i+(d.estimatedCostImpact||0),0),I=p.filter(i=>i.priority==="critical").length,j=t.reduce((i,d)=>{const U=d.resourceRequirements||[];return i+U.reduce((S,q)=>S+q.count,0)},0),B=j>0?75:0;return{totalProjects:t.length,activeProjects:s.length,completedProjects:n.length,onHoldProjects:r.length,totalBudget:l,totalSpent:a,totalValue:c,healthDistribution:{green:x,amber:m,red:g},totalRiskExposure:A,criticalRisks:I,totalResourcesAllocated:j,resourceUtilizationRate:B}}function h(t,s="bg"){return{green:{bg:"bg-green-100 dark:bg-green-900/20",text:"text-green-700 dark:text-green-400",border:"border-green-500"},amber:{bg:"bg-orange-100 dark:bg-orange-900/20",text:"text-orange-700 dark:text-orange-400",border:"border-orange-500"},red:{bg:"bg-red-100 dark:bg-red-900/20",text:"text-red-700 dark:text-red-400",border:"border-red-500"}}[t][s]}const u=({status:t,label:s})=>{const n=h(t,"bg"),r=h(t,"text");return e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${n} ${r} text-center`,title:s,children:t==="green"?"●":t==="amber"?"▲":"■"})},te=({trend:t})=>t==="improving"?e.jsx(b,{size:14,className:"text-green-600 dark:text-green-400"}):t==="declining"?e.jsx(Q,{size:14,className:"text-red-600 dark:text-red-400"}):e.jsx(J,{size:14,className:"text-slate-400"}),se=({projects:t})=>{const s=L(),n=R.useMemo(()=>t.filter(r=>r.status==="active"||r.status==="planning").map(r=>({project:r,health:M(r)})).sort((r,l)=>{const a={red:0,amber:1,green:2};return a[r.health.overallHealth]-a[l.health.overallHealth]}),[t]);return n.length===0?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-8 text-center",children:[e.jsx(f,{size:48,className:"mx-auto mb-3 text-slate-300 dark:text-slate-600"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"暂无活跃项目"})]}):e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"项目健康状态矩阵"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:["RAG 状态：",e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"● 良好"})," ·",e.jsx("span",{className:"text-orange-600 dark:text-orange-400 ml-2",children:"▲ 警告"})," ·",e.jsx("span",{className:"text-red-600 dark:text-red-400 ml-2",children:"■ 风险"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"项目名称"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(K,{size:12}),"进度"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(D,{size:12}),"预算"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(f,{size:12}),"范围"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(P,{size:12}),"质量"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(z,{size:12}),"风险"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"综合"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"趋势"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:n.map(({project:r,health:l})=>{const a=h(l.overallHealth,"bg");return e.jsxs("tr",{onClick:()=>s(`/projects/${r.id}`),className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:r.name}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:r.manager||"未分配"})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(u,{status:l.scheduleHealth,label:"进度健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(u,{status:l.budgetHealth,label:"预算健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(u,{status:l.scopeHealth,label:"范围健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(u,{status:l.qualityHealth,label:"质量健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(u,{status:l.riskHealth,label:"风险健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full ${a}`,children:e.jsx("span",{className:`text-sm font-bold ${h(l.overallHealth,"text")}`,children:l.overallHealth==="green"?"健康":l.overallHealth==="amber"?"警告":"风险"})})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(te,{trend:l.trend})})})]},r.id)})})]})}),e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 border-t border-slate-200 dark:border-slate-700 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("span",{className:"font-medium",children:"提示："})," 点击项目行查看详情 · RAG 指标基于进度、预算、范围、质量和风险的综合评估"]})]})},ue=()=>{const t=F(),s=R.useMemo(()=>ee(t),[t]),n=[{name:"健康",value:s.healthDistribution.green,color:"#10b981"},{name:"警告",value:s.healthDistribution.amber,color:"#f59e0b"},{name:"风险",value:s.healthDistribution.red,color:"#ef4444"}].filter(a=>a.value>0),r=[{name:"活跃",value:s.activeProjects,color:"#3b82f6"},{name:"已完成",value:s.completedProjects,color:"#10b981"},{name:"暂停",value:s.onHoldProjects,color:"#6b7280"}].filter(a=>a.value>0),l=({icon:a,title:c,value:o,subtitle:x,trend:m,colorClass:g="text-blue-600 dark:text-blue-400"})=>e.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`${g}`,children:a}),e.jsx("h3",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:c})]}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:o}),x&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:x})]}),m&&e.jsxs("div",{className:`text-sm font-medium ${m==="up"?"text-green-600":m==="down"?"text-red-600":"text-slate-400"}`,children:[m==="up"&&e.jsx(b,{size:20}),m==="down"&&e.jsx(b,{size:20,className:"rotate-180"})]})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-3",children:[e.jsx(E,{className:"text-blue-600 dark:text-blue-400",size:32}),"项目组合仪表盘"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"PMO 总览 - 实时监控所有项目的健康状态"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(l,{icon:e.jsx(f,{size:24}),title:"项目总数",value:s.totalProjects,subtitle:`${s.activeProjects} 个活跃项目`,colorClass:"text-blue-600 dark:text-blue-400"}),e.jsx(l,{icon:e.jsx(D,{size:24}),title:"总预算",value:`¥${(s.totalBudget/1e4).toFixed(1)}万`,subtitle:`已使用 ¥${(s.totalSpent/1e4).toFixed(1)}万`,colorClass:"text-green-600 dark:text-green-400"}),e.jsx(l,{icon:e.jsx(z,{size:24}),title:"风险暴露",value:s.criticalRisks,subtitle:`${s.criticalRisks} 个关键风险`,colorClass:"text-red-600 dark:text-red-400"}),e.jsx(l,{icon:e.jsx(O,{size:24}),title:"资源利用率",value:`${s.resourceUtilizationRate}%`,subtitle:`${s.totalResourcesAllocated} 人已分配`,colorClass:"text-purple-600 dark:text-purple-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 flex items-center gap-2",children:[e.jsx(V,{size:20,className:"text-blue-600 dark:text-blue-400"}),"健康状态分布"]}),n.length>0?e.jsx(v,{width:"100%",height:250,children:e.jsxs(w,{children:[e.jsx(C,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:c})=>`${a} ${((c||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:n.map((a,c)=>e.jsx(N,{fill:a.color},`cell-${c}`))}),e.jsx(y,{}),e.jsx(H,{})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-slate-400",children:"暂无数据"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 flex items-center gap-2",children:[e.jsx(P,{size:20,className:"text-green-600 dark:text-green-400"}),"项目状态分布"]}),r.length>0?e.jsx(v,{width:"100%",height:250,children:e.jsxs(w,{children:[e.jsx(C,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:c})=>`${a} ${((c||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:r.map((a,c)=>e.jsx(N,{fill:a.color},`cell-${c}`))}),e.jsx(y,{}),e.jsx(H,{})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-slate-400",children:"暂无数据"})]})]}),e.jsx(se,{projects:t})]})};export{ue as default};
