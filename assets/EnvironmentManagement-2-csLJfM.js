import{e as f,a as w,r,j as e,C as N,b as y}from"./index-BPZO1skf.js";import{u as v}from"./usePMOStore-BeWNESTI.js";import{P as C,a as S}from"./PageHeader-BchuvGPP.js";import{C as x}from"./Card-DmaYBVZa.js";import{B as n,a as E}from"./Badge-CFuHzJmj.js";import{P as m}from"./plus-CrTYTQFq.js";import{C as B}from"./clock-C0NDqs7R.js";import{C as u}from"./calendar-InioYt5y.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=f("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),Q=()=>{const{t:D}=w(),{environmentResources:i,addEnvironmentResource:M,bookEnvironment:P,cancelEnvironmentBooking:A,getAvailableEnvironments:T}=v(),[L,c]=r.useState(!1),[R,g]=r.useState(!1),[q,o]=r.useState(null),[l,b]=r.useState("all"),d=r.useMemo(()=>l==="all"?i:i.filter(t=>t.type===l),[i,l]),j=t=>{switch(t){case"available":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"occupied":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"maintenance":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"offline":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-slate-100 text-slate-800 dark:bg-slate-900/30 dark:text-slate-300"}},k=t=>{switch(t){case"test":case"staging":case"production":case"integration":return e.jsx(h,{className:"w-5 h-5"});default:return e.jsx(u,{className:"w-5 h-5"})}};return e.jsxs(C,{children:[e.jsx(S,{title:"环境资源管理",description:"管理测试环境、发布窗口等非人力资源，避免基础设施冲突",actions:e.jsxs(n,{onClick:()=>c(!0),children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"添加环境资源"]})}),e.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto",children:["all","test","staging","production","integration","device","license"].map(t=>e.jsx("button",{onClick:()=>b(t),className:`px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${l===t?"bg-blue-600 text-white":"bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:t==="all"?"全部":t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(t=>{const s=t.bookings.filter(a=>a.status==="active"||a.status==="reserved"),p=t.bookings.filter(a=>a.status!=="reserved"?!1:new Date(a.startDate)>new Date);return e.jsx(x,{className:"hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:k(t.type)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-slate-100",children:t.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:t.type})]})]}),e.jsxs(E,{className:j(t.status),children:[t.status==="available"&&e.jsx(N,{className:"w-3 h-3 mr-1"}),t.status==="occupied"&&e.jsx(B,{className:"w-3 h-3 mr-1"}),t.status==="maintenance"&&e.jsx(y,{className:"w-3 h-3 mr-1"}),t.status]})]}),t.description&&e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:t.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"当前使用"}),e.jsxs("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:[s.length," 个预定"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"即将到来"}),e.jsxs("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:[p.length," 个预定"]})]})]}),s.length>0&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-200 mb-1",children:"当前占用"}),e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:s[0].projectName}),e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:[new Date(s[0].startDate).toLocaleDateString()," -"," ",new Date(s[0].endDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{onClick:()=>{o(t),g(!0)},variant:"secondary",className:"flex-1",disabled:t.status!=="available",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"预约"]}),e.jsx(n,{onClick:()=>o(t),variant:"secondary",children:"查看详情"})]})]})},t.id)})}),d.length===0&&e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(h,{className:"w-16 h-16 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"暂无环境资源"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"添加测试环境、发布窗口等资源以避免冲突"}),e.jsxs(n,{onClick:()=>c(!0),children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"添加第一个环境资源"]})]})]})};export{Q as default};
