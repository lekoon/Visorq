import{o as Re,r as w,j as e,q as Z,F,s as De,u as J,a as Fe,U as ze,t as Oe,B as E,v as O,w as at,x as lt,y as rt,z as Me,S as Ie,L as nt,K as ot,A as dt,C as Te,E as Se,p as z,G as it,H as ct,I as xt,d as Y,J as le,n as Pe}from"./index-BvQyAdiV.js";import{S as mt}from"./sparkles-D_bjv8sy.js";import{G as ut}from"./grip-vertical-BZ1vaH7H.js";import{P as qe}from"./pen-IFSPnjG1.js";import{P as bt,a as ht}from"./PageHeader-BNhrp11Q.js";import{P as re}from"./plus-CjGNTfrT.js";import{f as A}from"./format-BaDDL2Yc.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Re("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=Re("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),ft=({templates:C,onSelect:D,onClose:S})=>{const[h,v]=w.useState(null),[p,m]=w.useState("all"),N=[{id:"all",label:"全部",icon:mt},{id:"web",label:"Web应用",icon:F},{id:"mobile",label:"移动应用",icon:F},{id:"data",label:"数据分析",icon:F},{id:"infrastructure",label:"基础设施",icon:F},{id:"custom",label:"自定义",icon:F}],g=p==="all"?C:C.filter(r=>r.category===p),k=()=>{D(h),S()},I=r=>({web:"from-blue-500 to-cyan-500",mobile:"from-purple-500 to-pink-500",data:"from-green-500 to-emerald-500",infrastructure:"from-orange-500 to-red-500",custom:"from-slate-500 to-gray-500"})[r]||"from-blue-500 to-purple-500";return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"选择项目模板"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"使用模板快速创建项目，或从空白项目开始"})]}),e.jsx("button",{onClick:S,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(Z,{size:24,className:"text-slate-500"})})]}),e.jsx("div",{className:"flex gap-2 mt-4 overflow-x-auto pb-2",children:N.map(r=>{const y=r.icon;return e.jsxs("button",{onClick:()=>m(r.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap ${p===r.id?"bg-blue-600 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e.jsx(y,{size:16}),r.label]},r.id)})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"从头开始"}),e.jsx("div",{onClick:()=>v(null),className:`p-6 rounded-xl border-2 cursor-pointer transition-all ${h===null?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(F,{size:20,className:"text-slate-400"}),e.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100",children:"空白项目"})]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"创建一个全新的项目，自定义所有设置"})]}),h===null&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(De,{size:16,className:"text-white"})})]})})]}),g.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:["可用模板 (",g.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(r=>e.jsxs("div",{onClick:()=>v(r),className:`p-5 rounded-xl border-2 cursor-pointer transition-all ${(h==null?void 0:h.id)===r.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-lg":"border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700 hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${I(r.category)} flex items-center justify-center text-white shadow-lg`,children:e.jsx(F,{size:24})}),(h==null?void 0:h.id)===r.id&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(De,{size:16,className:"text-white"})})]}),e.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100 mb-2",children:r.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-3 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsxs("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded",children:[r.defaultDuration," 个月"]}),r.isBuiltIn&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded",children:"内置"})]})]},r.id))})]}),g.length===0&&p!=="all"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(F,{size:48,className:"mx-auto text-slate-300 dark:text-slate-600 mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"该分类暂无模板"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:h?e.jsxs("span",{children:["已选择: ",e.jsx("strong",{className:"text-slate-700 dark:text-slate-300",children:h.name})]}):e.jsx("span",{children:"将创建空白项目"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:S,className:"px-6 py-2 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg font-medium transition-colors",children:"取消"}),e.jsx("button",{onClick:k,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors shadow-lg shadow-blue-600/20",children:"确认选择"})]})]})]})})},jt=({onEditProject:C,groupBy:D="status"})=>{const{projects:S,updateProject:h,projectTypeDefinitions:v}=J(),{t:p}=Fe(),[m,N]=w.useState(null),[g,k]=w.useState(null),I=D==="status"?[{id:"planning",label:p("projects.planning"),color:"bg-blue-100 text-blue-700",borderColor:"border-blue-400"},{id:"active",label:p("projects.active"),color:"bg-green-100 text-green-700",borderColor:"border-green-400"},{id:"on-hold",label:p("projects.onHold"),color:"bg-orange-100 text-orange-700",borderColor:"border-orange-400"},{id:"completed",label:p("projects.completed"),color:"bg-purple-100 text-purple-700",borderColor:"border-purple-400"}]:[...v.map(x=>({id:x.id,label:x.name,color:"bg-slate-100 text-slate-700",borderColor:"border-slate-300",headerColor:x.color})),{id:"none",label:"未分类",color:"bg-slate-50 text-slate-400",borderColor:"border-slate-200"}],r=(x,j)=>{N(j),x.dataTransfer.effectAllowed="move",x.target.style.opacity="0.5"},y=x=>{x.target.style.opacity="1",N(null),k(null)},X=(x,j)=>{x.preventDefault(),x.dataTransfer.dropEffect="move",k(j)},q=()=>{k(null)},Q=(x,j)=>{if(x.preventDefault(),k(null),m){if(D==="status"&&m.status!==j)h(m.id,{status:j});else if(D==="projectType"&&m.projectType!==j)h(m.id,{projectType:j==="none"?void 0:j});else return;const T=document.createElement("div");T.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in",T.textContent=`${m.name} updated`,document.body.appendChild(T),setTimeout(()=>{T.remove()},2e3)}N(null)};return e.jsx("div",{className:"flex gap-6 overflow-x-auto pb-6",children:I.map(x=>{const j=S.filter(b=>D==="status"?b.status===x.id:b.projectType===x.id||!b.projectType&&x.id==="none"),T=g===x.id;return e.jsxs("div",{className:`min-w-[320px] rounded-2xl p-4 transition-all duration-200 ${T?`bg-blue-50 border-2 ${x.borderColor} shadow-lg scale-105`:"bg-slate-100/50 border-2 border-transparent"}`,onDragOver:b=>X(b,x.id),onDragLeave:q,onDrop:b=>Q(b,x.id),children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x.headerColor&&e.jsx("div",{className:"w-1.5 h-4 rounded-full",style:{backgroundColor:x.headerColor}}),e.jsx("div",{className:`px-3 py-2 rounded-lg font-bold text-sm ${x.color}`,children:x.label})]}),e.jsx("span",{className:"text-sm text-slate-500 font-medium",children:j.length})]}),e.jsxs("div",{className:"space-y-3 min-h-[400px]",children:[j.map(b=>e.jsx("div",{draggable:!0,onDragStart:R=>r(R,b),onDragEnd:y,className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-all cursor-move group",children:e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(ut,{size:16,className:"text-slate-400 mt-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm leading-tight",children:b.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${b.priority==="P0"?"bg-red-100 text-red-700":b.priority==="P1"?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:b.priority||"P2"}),e.jsx("span",{className:"text-xs font-bold bg-blue-50 text-blue-600 px-2 py-0.5 rounded",children:(b.score||0).toFixed(1)})]})]}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2 mb-3",children:b.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-slate-400",children:[e.jsx(ze,{size:12}),e.jsx("span",{children:(b.resourceRequirements||[]).reduce((R,ee)=>R+ee.count,0)})]}),e.jsxs("span",{className:"text-slate-400",children:["Rank #",b.rank]}),e.jsx("button",{onClick:R=>{R.stopPropagation(),C(b)},className:"p-1 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",children:e.jsx(qe,{size:14})})]})]})]})},b.id)),j.length===0&&e.jsx("div",{className:`text-center py-12 rounded-xl border-2 border-dashed transition-colors ${T?"border-blue-400 bg-blue-50":"border-slate-200 bg-slate-50"}`,children:e.jsx("p",{className:"text-sm text-slate-400",children:p(T?"projects.dropHere":"projects.noProjects")})})]})]},x.id)})})},vt=({isOpen:C,onClose:D})=>{const S=Oe(),{addKeyTaskDefinition:h,updateKeyTaskDefinition:v,deleteKeyTaskDefinition:p}=J(),[m,N]=w.useState(""),[g,k]=w.useState("#3b82f6");if(!C)return null;const I=()=>{m.trim()&&(h(m.trim(),g),N(""))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl w-full max-w-md shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-800/50",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(gt,{className:"text-blue-500",size:24}),"关键任务设置"]}),e.jsx("button",{onClick:D,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors",children:e.jsx(Z,{size:24,className:"text-slate-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"任务名称 (如: SIT)",className:"w-full p-2.5 rounded-xl border border-slate-200 dark:border-slate-700 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",value:m,onChange:r=>N(r.target.value),onKeyDown:r=>r.key==="Enter"&&I()})}),e.jsx("input",{type:"color",className:"w-12 h-10 p-1 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer",value:g,onChange:r=>k(r.target.value)}),e.jsx(E,{onClick:I,size:"sm",icon:re,children:"添加"})]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:S.map(r=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl group transition-all hover:shadow-sm",children:[e.jsx("input",{type:"color",className:"w-8 h-8 rounded p-0 border-none cursor-pointer shrink-0",value:r.color,onChange:y=>v(r.id,{color:y.target.value})}),e.jsx("input",{type:"text",className:"flex-1 bg-transparent border-none focus:ring-0 text-sm font-medium text-slate-700 dark:text-slate-300",value:r.name,onChange:y=>v(r.id,{name:y.target.value})}),e.jsx("button",{onClick:()=>p(r.id),className:"p-1.5 text-slate-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(O,{size:16})})]},r.id))})]}),e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-100 dark:border-slate-800 flex justify-end",children:e.jsx(E,{onClick:D,variant:"ghost",children:"完成"})})]})})},Nt=({isOpen:C,onClose:D})=>{const S=at(),{addProjectTypeDefinition:h,updateProjectTypeDefinition:v,deleteProjectTypeDefinition:p}=J(),[m,N]=w.useState(""),[g,k]=w.useState("#3b82f6");if(!C)return null;const I=()=>{m.trim()&&(h(m.trim(),g),N(""))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl w-full max-w-lg shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-800/50",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"项目类型配置"}),e.jsx("p",{className:"text-xs text-slate-500 font-medium mt-0.5",children:"管理可用的项目分类类型"})]}),e.jsx("button",{onClick:D,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors",children:e.jsx(Z,{size:20,className:"text-slate-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:S.map(r=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800 group",children:[e.jsx("input",{type:"color",value:r.color,onChange:y=>v(r.id,{color:y.target.value}),className:"w-8 h-8 rounded-lg border-none bg-transparent cursor-pointer"}),e.jsx("input",{type:"text",value:r.name,onChange:y=>v(r.id,{name:y.target.value}),className:"flex-1 bg-transparent border-none focus:ring-0 font-bold text-sm text-slate-700 dark:text-slate-200"}),e.jsx("button",{onClick:()=>p(r.id),className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-all opacity-0 group-hover:opacity-100",children:e.jsx(O,{size:16})})]},r.id))}),e.jsxs("div",{className:"pt-4 border-t border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-xs font-black text-slate-400 uppercase tracking-widest mb-4",children:"添加新类型"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"color",value:g,onChange:r=>k(r.target.value),className:"w-12 h-12 rounded-2xl border-2 border-slate-200 dark:border-slate-700 bg-transparent cursor-pointer p-1"}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"输入类型名称...",className:"w-full h-12 px-4 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none font-medium text-sm",value:m,onChange:r=>N(r.target.value),onKeyDown:r=>r.key==="Enter"&&I()})}),e.jsx(E,{variant:"primary",icon:re,onClick:I,className:"h-12 w-12 flex items-center justify-center p-0 rounded-2xl",children:e.jsx("span",{className:"sr-only",children:"添加"})})]})]})]}),e.jsx("div",{className:"p-6 bg-slate-50 dark:bg-slate-800/50 flex justify-end",children:e.jsx(E,{variant:"outline",onClick:D,className:"rounded-xl px-8 font-bold text-sm",children:"完成"})})]})})},Tt=()=>{var de,ie,ce,xe,me,ue,be,he,pe,ge,fe,je,ve,Ne;const{projects:C,addProject:D,deleteProject:S,updateProject:h,factorDefinitions:v,resourcePool:p,user:m,projectTypeDefinitions:N}=J(),{t:g}=Fe(),{environmentResources:k}=lt(),I=rt(),[r,y]=w.useState("list"),[X,q]=w.useState(!1),[Q,x]=w.useState(!1),[j,T]=w.useState(null),[b,R]=w.useState(!1),[ee,ne]=w.useState(!1),[K,$e]=w.useState("status"),$=Oe(),_e=[{id:"web-app",name:"Web Application",description:"Standard web application development project with frontend and backend.",category:"web",defaultDuration:3,defaultFactors:{market:8,value:7,risk:6,roi:8,strategy:7,innovation:6,cost:5},defaultResources:[{resourceId:"",count:2,duration:3,unit:"month",requiredSkills:["react","node"]},{resourceId:"",count:1,duration:3,unit:"month",requiredSkills:["design"]}],isBuiltIn:!0,createdAt:new Date().toISOString()},{id:"mobile-app",name:"Mobile App",description:"iOS and Android mobile application development.",category:"mobile",defaultDuration:4,defaultFactors:{market:9,value:8,risk:5,roi:7,strategy:8,innovation:7,cost:6},defaultResources:[{resourceId:"",count:2,duration:4,unit:"month",requiredSkills:["flutter"]},{resourceId:"",count:1,duration:2,unit:"month",requiredSkills:["qa"]}],isBuiltIn:!0,createdAt:new Date().toISOString()},{id:"data-analytics",name:"Data Analytics Platform",description:"Big data processing and analytics dashboard.",category:"data",defaultDuration:6,defaultFactors:{market:7,value:9,risk:4,roi:9,strategy:9,innovation:8,cost:4},defaultResources:[{resourceId:"",count:3,duration:6,unit:"month",requiredSkills:["python","sql"]},{resourceId:"",count:1,duration:6,unit:"month",requiredSkills:["data-science"]}],isBuiltIn:!0,createdAt:new Date().toISOString()}],[l,i]=w.useState({name:"",description:"",status:"planning",priority:"P2",startDate:"",endDate:"",category:"custom",department:"",budget:0,factors:{},resourceRequirements:[],milestones:[],environmentRequirements:[],pmoMetrics:{strategicConsistency:3,rdInvestment:0,techPlatform:"Traditional",valueRiskMetrics:{commercialROI:3,strategicFit:3,technicalFeasibility:3,marketWindow:3,resourceDependency:3},cashFlow:{annualBudget:500,currentInvestment:0,futureROI:[0,0,0]},resourceLoad:[{roleId:"ai",roleName:"AI算法工程师",monthlyUsage:{}},{roleId:"hardware",roleName:"硬件工程师",monthlyUsage:{}}]},healthIndicators:{projectId:"",projectName:"",overallHealth:"green",scheduleHealth:"green",budgetHealth:"green",scopeHealth:"green",qualityHealth:"green",riskHealth:"green",trend:"stable"},pmoAdvice:""}),Ae=()=>{const t={};return v.forEach(s=>t[s.id]=5),t},B=t=>{if(t){T(t.id);const s={...t.factors};v.forEach(a=>{s[a.id]===void 0&&(s[a.id]=5)}),i({...t,factors:s,pmoMetrics:t.pmoMetrics||{strategicConsistency:3,rdInvestment:0,techPlatform:"Traditional",valueRiskMetrics:{commercialROI:3,strategicFit:3,technicalFeasibility:3,marketWindow:3,resourceDependency:3},cashFlow:{annualBudget:500,currentInvestment:0,futureROI:[0,0,0]},resourceLoad:[{roleId:"ai",roleName:"AI算法工程师",monthlyUsage:{}},{roleId:"hardware",roleName:"硬件工程师",monthlyUsage:{}}]}}),q(!0)}else x(!0)},Ee=t=>{if(T(null),t){const s=new Date,a=le(s,t.defaultDuration),d=t.defaultResources.map(n=>{var f;return{...n,resourceId:((f=p[0])==null?void 0:f.id)||""}}),o={id:Math.random().toString(36).substr(2,9),name:`${t.name} - ${A(s,"yyyyMMdd")}`,description:t.description,status:"planning",priority:"P2",startDate:A(s,"yyyy-MM-dd"),endDate:A(a,"yyyy-MM-dd"),factors:{...t.defaultFactors},resourceRequirements:d,category:t.category,department:t.department,budget:t.defaultBudget||0,score:0,milestones:[],costHistory:[],actualCost:0,pmoMetrics:{strategicConsistency:3,rdInvestment:0,techPlatform:"Traditional",valueRiskMetrics:{commercialROI:3,strategicFit:3,technicalFeasibility:3,marketWindow:3,resourceDependency:3},cashFlow:{annualBudget:500,currentInvestment:0,futureROI:[0,0,0]},resourceLoad:[{roleId:"ai",roleName:"AI算法工程师",monthlyUsage:{}},{roleId:"hardware",roleName:"硬件工程师",monthlyUsage:{}}]}};o.score=Me(o.factors,v),D(o),x(!1),I(`/projects/${o.id}`)}else i({name:"",description:"",status:"planning",priority:"P2",startDate:"",endDate:"",category:"custom",department:"",budget:0,factors:Ae(),resourceRequirements:[],milestones:[],environmentRequirements:[],pmoMetrics:{strategicConsistency:3,rdInvestment:0,techPlatform:"Traditional",valueRiskMetrics:{commercialROI:3,strategicFit:3,technicalFeasibility:3,marketWindow:3,resourceDependency:3},cashFlow:{annualBudget:500,currentInvestment:0,futureROI:[0,0,0]},resourceLoad:[{roleId:"ai",roleName:"AI算法工程师",monthlyUsage:{}},{roleId:"hardware",roleName:"硬件工程师",monthlyUsage:{}}]}}),x(!1),q(!0)},Ke=()=>{q(!1),x(!1),T(null)},te=t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"w-8 h-8 rounded-lg bg-slate-100 text-slate-600 font-bold flex items-center justify-center",children:t.rank})}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-slate-900 cursor-pointer hover:text-blue-600",onClick:()=>I(`/projects/${t.id}`),children:t.name}),e.jsx("div",{className:"text-sm text-slate-500 truncate max-w-xs",children:t.description})]}),e.jsx("td",{className:"p-4",children:e.jsx(Pe,{variant:t.status==="active"?"success":t.status==="planning"?"primary":"neutral",size:"sm",children:t.status.toUpperCase()})}),K==="projectType"&&e.jsx("td",{className:"p-4",children:(()=>{const s=N.find(a=>a.id===t.projectType);return s?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full bg-slate-100 text-[10px] font-black text-slate-600",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:s.color}}),s.name]}):e.jsx("span",{className:"text-[10px] text-slate-400",children:"未分类"})})()}),e.jsx("td",{className:"p-4 font-bold text-blue-600",children:(t.score||0).toFixed(2)}),e.jsx("td",{className:"p-4 text-sm text-slate-500",children:e.jsxs("div",{className:"flex items-center gap-1",title:"Total Headcount Required",children:[e.jsx(ze,{size:14}),(t.resourceRequirements||[]).reduce((s,a)=>s+a.count,0)," people"]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:(m==null?void 0:m.role)!=="user"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>B(t),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(qe,{size:18})}),e.jsx("button",{onClick:()=>S(t.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(O,{size:18})})]})})})]},t.id),se=(t,s,a,d)=>{const o=z(t.startDate),n=z(t.endDate),f=Y(o,s),L=Y(n,o),U=f/a*100,ke=L/a*100,ye=t.status==="active"?"bg-gradient-to-r from-emerald-500 to-teal-600":t.status==="planning"?"bg-gradient-to-r from-blue-500 to-indigo-600":t.status==="completed"?"bg-gradient-to-r from-purple-500 to-fuchsia-600":"bg-gradient-to-r from-orange-400 to-amber-500";return e.jsxs("div",{className:"flex items-center group relative z-10 py-1.5 hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-all rounded-r-xl",children:[e.jsxs("div",{className:"w-56 shrink-0 px-6 sticky left-0 bg-white/95 dark:bg-slate-900/95 backdrop-blur-md z-20 border-r border-slate-100 dark:border-slate-800 flex items-center gap-3 shadow-[5px_0_15px_-5px_rgba(0,0,0,0.05)]",children:[e.jsx("div",{className:`w-2 h-2 rounded-full shrink-0 ${t.status==="active"?"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]":t.status==="completed"?"bg-purple-500":"bg-slate-300"} ${t.status==="active"?"animate-pulse":""}`}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-black text-[13px] text-slate-700 dark:text-slate-200 truncate group-hover:text-blue-600 transition-colors cursor-pointer",onClick:()=>I(`/projects/${t.id}`),children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Pe,{variant:"neutral",className:"text-[9px] py-0 px-1 border-none bg-slate-100 dark:bg-slate-800 font-bold opacity-60",children:["PK:",t.rank]}),e.jsxs("span",{className:"text-[10px] text-slate-400 font-black tracking-tighter",children:[A(o,"MM/dd")," » ",A(n,"MM/dd")]})]})]})]}),e.jsx("div",{className:"flex-1 relative h-12 flex items-center",children:e.jsx("div",{className:`absolute h-8 rounded-lg shadow-[0_4px_12px_rgba(0,0,0,0.1)] group-hover:shadow-[0_8px_20px_rgba(37,99,235,0.2)] transition-all cursor-pointer flex items-center px-3 group/bar overflow-hidden ${t.keyTasks&&t.keyTasks.length>0?"bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700":ye}`,style:{left:`${U}%`,width:`${ke}%`},onClick:()=>B(t),children:t.keyTasks&&t.keyTasks.length>0?e.jsx("div",{className:"absolute inset-0 p-0.5",children:t.keyTasks.map((_,P)=>{const c=d.find(st=>st.id===_.definitionId);if(!c)return null;const u=z(t.startDate).getTime(),M=z(t.endDate).getTime(),V=z(_.startDate).getTime(),et=z(_.endDate).getTime(),we=M-u,Ce=Math.max(0,(V-u)/we*100),tt=Math.min(100-Ce,(et-V)/we*100);return e.jsxs("div",{className:"absolute top-0.5 bottom-0.5 rounded-md flex items-center justify-center overflow-hidden border border-white/40 shadow-sm backdrop-blur-[2px] transition-all hover:scale-[1.05] hover:z-30 z-10",style:{backgroundColor:c.color,left:`${Ce}%`,width:`${tt}%`},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white/30 to-transparent pointer-events-none"}),e.jsx("span",{className:"text-[10px] text-white font-black truncate px-1.5 leading-none drop-shadow-[0_1px_3px_rgba(0,0,0,0.5)] pointer-events-none uppercase tracking-tighter",children:c.name})]},P)})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-0 left-0 h-full bg-white/20 pointer-events-none transition-all duration-700",style:{width:`${t.progress||0}%`}}),e.jsxs("div",{className:"relative z-10 w-full flex items-center justify-between gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-[12px] text-white font-black truncate drop-shadow-[0_1px_3px_rgba(0,0,0,0.4)]",children:t.name}),e.jsxs("span",{className:"text-[10px] text-white/90 font-black bg-black/30 px-2 py-0.5 rounded-full backdrop-blur-sm border border-white/10 shrink-0",children:[t.progress||0,"%"]})]})]})})})]},t.id)},Le=t=>{t.preventDefault(),j?h(j,l):D({...l,id:Math.random().toString(36).substr(2,9),score:0,priority:l.priority||"P2"}),q(!1)},Ue=()=>{i(t=>{var s;return{...t,resourceRequirements:[...t.resourceRequirements||[],{resourceId:((s=p[0])==null?void 0:s.id)||"",count:1,duration:1,unit:"month"}]}})},Be=t=>{i(s=>{var a;return{...s,resourceRequirements:(a=s.resourceRequirements)==null?void 0:a.filter((d,o)=>o!==t)}})},H=(t,s,a)=>{i(d=>{var o;return{...d,resourceRequirements:(o=d.resourceRequirements)==null?void 0:o.map((n,f)=>f===t?{...n,[s]:a}:n)}})},He=()=>{i(t=>({...t,milestones:[...t.milestones||[],{id:Math.random().toString(36).substr(2,9),name:"",date:"",completed:!1}]}))},We=t=>{i(s=>{var a;return{...s,milestones:(a=s.milestones)==null?void 0:a.filter((d,o)=>o!==t)}})},oe=(t,s,a)=>{i(d=>{var o;return{...d,milestones:(o=d.milestones)==null?void 0:o.map((n,f)=>f===t?{...n,[s]:a}:n)}})},Ge=()=>{i(t=>{var s,a;return{...t,environmentRequirements:[...t.environmentRequirements||[],{environmentId:((s=k[0])==null?void 0:s.id)||"",environmentName:((a=k[0])==null?void 0:a.name)||"",startDate:"",endDate:"",purpose:""}]}})},Ve=t=>{i(s=>{var a;return{...s,environmentRequirements:(a=s.environmentRequirements)==null?void 0:a.filter((d,o)=>o!==t)}})},W=(t,s,a)=>{i(d=>{var o;return{...d,environmentRequirements:(o=d.environmentRequirements)==null?void 0:o.map((n,f)=>{if(f===t){if(s==="environmentId"){const L=k.find(U=>U.id===a);return{...n,environmentId:a,environmentName:(L==null?void 0:L.name)||""}}return{...n,[s]:a}}return n})}})},Ye=()=>{i(t=>{var s;return{...t,keyTasks:[...t.keyTasks||[],{definitionId:((s=$[0])==null?void 0:s.id)||"",startDate:t.startDate||new Date().toISOString().split("T")[0],endDate:t.endDate||new Date().toISOString().split("T")[0]}]}})},ae=(t,s,a)=>{i(d=>{var o;return{...d,keyTasks:(o=d.keyTasks)==null?void 0:o.map((n,f)=>f===t?{...n,[s]:a}:n)}})},Ze=t=>{i(s=>{var a;return{...s,keyTasks:(a=s.keyTasks)==null?void 0:a.filter((d,o)=>o!==t)}})},Je=()=>{i(t=>{var s,a;return{...t,milestoneDependencies:[...t.milestoneDependencies||[],{id:`md-${Date.now()}`,sourceMilestoneId:((a=(s=t.milestones)==null?void 0:s[0])==null?void 0:a.id)||"",targetProjectId:"",targetMilestoneId:"",type:"FS"}]}})},G=(t,s,a)=>{i(d=>{var o;return{...d,milestoneDependencies:(o=d.milestoneDependencies)==null?void 0:o.map((n,f)=>f===t?{...n,[s]:a}:n)}})},Xe=t=>{i(s=>{var a;return{...s,milestoneDependencies:(a=s.milestoneDependencies)==null?void 0:a.filter((d,o)=>o!==t)}})},Qe=l.factors?Me(l.factors,v):0;return e.jsxs(bt,{children:[e.jsx(ht,{title:"Projects",description:"Manage and track all your projects",actions:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:"outline",icon:Ie,onClick:()=>R(!0),size:"sm",className:"border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800",children:"关键任务"}),e.jsx(E,{variant:"outline",icon:pt,onClick:()=>ne(!0),size:"sm",className:"border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800",children:"项目类型"})]}),e.jsxs("div",{className:"flex bg-white dark:bg-slate-800 rounded-lg p-1 border border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsxs("select",{value:K,onChange:t=>$e(t.target.value),className:"text-xs font-bold bg-transparent border-none focus:ring-0 text-slate-500 cursor-pointer pr-8",children:[e.jsx("option",{value:"status",children:"按状态分组"}),e.jsx("option",{value:"projectType",children:"按类型分组"})]}),e.jsx("div",{className:"w-[1px] h-4 bg-slate-200 dark:bg-slate-700 self-center mx-2"}),e.jsxs("button",{onClick:()=>y("list"),className:`px-3 py-1.5 rounded-md transition-all flex items-center gap-2 ${r==="list"?"bg-slate-100 dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:[e.jsx(nt,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"列表"})]}),e.jsxs("button",{onClick:()=>y("kanban"),className:`px-3 py-1.5 rounded-md transition-all flex items-center gap-2 ${r==="kanban"?"bg-slate-100 dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:[e.jsx(ot,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"看板"})]}),e.jsxs("button",{onClick:()=>y("gantt"),className:`px-3 py-1.5 rounded-md transition-all flex items-center gap-2 ${r==="gantt"?"bg-slate-100 dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:[e.jsx(dt,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"甘特图"})]})]}),(m==null?void 0:m.role)!=="user"&&e.jsx(E,{onClick:()=>B(),variant:"primary",icon:re,children:"New Project"})]})}),r==="list"?e.jsx(Te,{padding:"none",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Rank"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Project Name"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Status"}),K==="projectType"&&e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Type"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Score"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Resources"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:K==="status"?C.map(t=>te(t)):e.jsxs(e.Fragment,{children:[N.map(t=>{const s=C.filter(a=>a.projectType===t.id);return s.length===0?null:e.jsxs(Se.Fragment,{children:[e.jsx("tr",{className:"bg-slate-50/50",children:e.jsx("td",{colSpan:(m==null?void 0:m.role)!=="user"?7:5,className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-4 rounded-full",style:{backgroundColor:t.color}}),e.jsx("span",{className:"text-xs font-black text-slate-500 uppercase tracking-widest",children:t.name})]})})}),s.map(a=>te(a))]},t.id)}),(()=>{const t=C.filter(s=>!s.projectType);return t.length===0?null:e.jsxs(Se.Fragment,{children:[e.jsx("tr",{className:"bg-slate-50/50",children:e.jsx("td",{colSpan:(m==null?void 0:m.role)!=="user"?7:5,className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-4 rounded-full bg-slate-300"}),e.jsx("span",{className:"text-xs font-black text-slate-400 uppercase tracking-widest",children:"未分类项目"})]})})}),t.map(s=>te(s))]},"untyped")})()]})})]})}):r==="kanban"?e.jsx("div",{className:"overflow-x-auto pb-6",children:e.jsx(jt,{onEditProject:B,groupBy:K})}):e.jsx(Te,{padding:"none",className:"overflow-hidden",children:(()=>{const t=C.filter(c=>c.startDate&&c.endDate);if(t.length===0)return e.jsx("div",{className:"p-20 text-center text-slate-400 italic",children:"暂无排程项目"});const s=t.map(c=>z(c.startDate).getTime()),a=t.map(c=>z(c.endDate).getTime()),d=it(new Date(Math.min(...s))),o=ct(new Date(Math.max(...a))),n=xt(o,d)+1,f=Y(o,d)+1,U=n*120,_=Y(new Date,d)/f*100,P=[];for(let c=0;c<n;c++){const u=le(d,c),M=A(u,"yyyy年");P.length>0&&P[P.length-1].year===M?P[P.length-1].monthCount++:P.push({year:M,monthCount:1})}return e.jsx("div",{className:"overflow-x-auto custom-scrollbar group/gantt",children:e.jsxs("div",{style:{width:`calc(14rem + ${U}px)`},className:"relative bg-white dark:bg-slate-900 min-h-[400px]",children:[e.jsxs("div",{className:"sticky top-0 z-30 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-56 shrink-0 sticky left-0 bg-white dark:bg-slate-900 z-40 border-r border-slate-100 dark:border-slate-800"}),e.jsx("div",{className:"flex-1 flex",children:P.map((c,u)=>e.jsx("div",{className:"border-l border-slate-100 dark:border-slate-800 text-[10px] font-black text-slate-400 dark:text-slate-500 py-1 px-3 bg-slate-50/50 dark:bg-slate-800/30 uppercase tracking-widest",style:{width:`${c.monthCount/n*100}%`},children:c.year},u))})]}),e.jsxs("div",{className:"flex h-10 items-center",children:[e.jsx("div",{className:"w-56 shrink-0 font-bold text-slate-600 dark:text-slate-300 px-6 sticky left-0 bg-white dark:bg-slate-900 z-40 border-r border-slate-100 dark:border-slate-800 flex items-center",children:"项目清单"}),e.jsx("div",{className:"flex-1 flex h-full",children:Array.from({length:n}).map((c,u)=>{const M=le(d,u);return e.jsx("div",{className:"flex-1 border-l border-slate-50 dark:border-slate-800/50 text-[11px] font-bold text-slate-500 flex items-center pl-3 hover:bg-slate-50 dark:hover:bg-slate-800/20 transition-colors",children:A(M,"MM月")},u)})})]})]}),$.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-4 px-6 py-3 bg-slate-50/30 dark:bg-slate-800/10 border-b border-slate-100 dark:border-slate-800 sticky left-0 z-10",style:{width:`calc(14rem + ${U}px)`},children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest self-center mr-2",children:"战略任务图例:"}),$.map(c=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-sm shadow-sm",style:{backgroundColor:c.color}}),e.jsx("span",{className:"text-[11px] font-bold text-slate-600 dark:text-slate-400",children:c.name})]},c.id)),e.jsxs("div",{className:"flex items-center gap-2 ml-auto border-l border-slate-200 dark:border-slate-700 pl-4",children:[e.jsx("div",{className:"w-3 h-0.5 bg-red-400 shadow-[0_0_5px_rgba(248,113,113,0.5)]"}),e.jsx("span",{className:"text-[11px] font-bold text-red-500",children:"今日位置"})]})]}),e.jsxs("div",{className:"relative pt-4 pb-8",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none z-0",children:[e.jsx("div",{className:"flex h-full ml-56",children:Array.from({length:n}).map((c,u)=>e.jsx("div",{className:"flex-1 border-l border-dashed border-slate-100 dark:border-slate-800/50"},u))}),_>=0&&_<=100&&e.jsx("div",{className:"absolute top-0 bottom-0 w-[2px] bg-red-400/40 dark:bg-red-500/20 z-20",style:{left:`calc(14rem + ${_}%)`},children:e.jsx("div",{className:"w-full h-full border-l-2 border-dotted border-red-500/50"})})]}),e.jsx("div",{className:"space-y-4 px-0",children:K==="status"?t.sort((c,u)=>(c.rank||99)-(u.rank||99)).map(c=>se(c,d,f,$)):e.jsxs(e.Fragment,{children:[N.map(c=>{const u=t.filter(M=>M.projectType===c.id);return u.length===0?null:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 px-6 py-2 sticky left-0 z-20",children:[e.jsx("div",{className:"w-2 h-6 rounded-full",style:{backgroundColor:c.color}}),e.jsx("span",{className:"text-sm font-black text-slate-800 dark:text-slate-100 uppercase tracking-widest",children:c.name}),e.jsx("div",{className:"h-[1px] flex-1 bg-slate-100 dark:bg-slate-800 ml-4"})]}),u.sort((M,V)=>(M.rank||99)-(V.rank||99)).map(M=>se(M,d,f,$))]},c.id)}),(()=>{const c=t.filter(u=>!u.projectType);return c.length===0?null:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 px-6 py-2 sticky left-0 z-20",children:[e.jsx("div",{className:"w-2 h-6 rounded-full bg-slate-200"}),e.jsx("span",{className:"text-sm font-black text-slate-400 uppercase tracking-widest",children:"未分类项目"}),e.jsx("div",{className:"h-[1px] flex-1 bg-slate-100 dark:bg-slate-800 ml-4"})]}),c.sort((u,M)=>(u.rank||99)-(M.rank||99)).map(u=>se(u,d,f,$))]},"untyped")})()]})})]})]})})})()}),e.jsx(vt,{isOpen:b,onClose:()=>R(!1)}),e.jsx(Nt,{isOpen:ee,onClose:()=>ne(!1)}),X&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:j?"Edit Project":"New Project"}),e.jsx("button",{onClick:()=>q(!1),className:"p-2 hover:bg-slate-100 rounded-full",children:e.jsx(Z,{size:24})})]}),e.jsxs("form",{onSubmit:Le,className:"p-6 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Project Name"}),e.jsx("input",{required:!0,type:"text",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.name,onChange:t=>i({...l,name:t.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,value:l.description,onChange:t=>i({...l,description:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-6 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:g("projects.category")}),e.jsxs("select",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.category,onChange:t=>i({...l,category:t.target.value}),children:[e.jsx("option",{value:"web",children:"Web 应用"}),e.jsx("option",{value:"mobile",children:"移动应用"}),e.jsx("option",{value:"data",children:"数据分析"}),e.jsx("option",{value:"infrastructure",children:"基础设施"}),e.jsx("option",{value:"custom",children:"自定义"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"项目类型"}),e.jsxs("select",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.projectType,onChange:t=>i({...l,projectType:t.target.value}),children:[e.jsx("option",{value:"",children:"请选择项目类型..."}),N.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:g("projects.department")}),e.jsx("input",{type:"text",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.department,onChange:t=>i({...l,department:t.target.value}),placeholder:"输入负责部门"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[g("projects.budget")," (¥)"]}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.budget,onChange:t=>i({...l,budget:parseInt(t.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:g("projects.status")}),e.jsxs("select",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.status,onChange:t=>i({...l,status:t.target.value}),children:[e.jsx("option",{value:"planning",children:"Planning"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"on-hold",children:"On Hold"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:g("projects.startDate")}),e.jsx("input",{type:"date",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.startDate,onChange:t=>i({...l,startDate:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:g("projects.endDate")}),e.jsx("input",{type:"date",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:l.endDate,onChange:t=>i({...l,endDate:t.target.value})})]})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Resource Requirements"}),e.jsx("button",{type:"button",onClick:Ue,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Requirement"})]}),e.jsxs("div",{className:"space-y-3",children:[(de=l.resourceRequirements)==null?void 0:de.map((t,s)=>e.jsxs("div",{className:"flex gap-3 items-end bg-slate-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Resource"}),e.jsx("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.resourceId,onChange:a=>H(s,"resourceId",a.target.value),children:p.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Count"}),e.jsx("input",{type:"number",min:"1",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.count,onChange:a=>H(s,"count",parseInt(a.target.value))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Duration"}),e.jsx("input",{type:"number",min:"1",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.duration,onChange:a=>H(s,"duration",parseInt(a.target.value))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Unit"}),e.jsxs("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.unit,onChange:a=>H(s,"unit",a.target.value),children:[e.jsx("option",{value:"day",children:"Days"}),e.jsx("option",{value:"month",children:"Months"}),e.jsx("option",{value:"year",children:"Years"})]})]}),e.jsx("button",{type:"button",onClick:()=>Be(s),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(O,{size:16})})]},s)),((ie=l.resourceRequirements)==null?void 0:ie.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No resources allocated yet."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Project Milestones"}),e.jsx("button",{type:"button",onClick:He,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Milestone"})]}),e.jsxs("div",{className:"space-y-3",children:[(ce=l.milestones)==null?void 0:ce.map((t,s)=>e.jsxs("div",{className:"flex gap-3 items-end bg-slate-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Milestone Name"}),e.jsx("input",{type:"text",placeholder:"e.g. Design Review",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.name,onChange:a=>oe(s,"name",a.target.value)})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.date,onChange:a=>oe(s,"date",a.target.value)})]}),e.jsx("button",{type:"button",onClick:()=>We(s),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(O,{size:16})})]},s)),((xe=l.milestones)==null?void 0:xe.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No milestones defined."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"关键任务 (甘特图展示)"}),e.jsx("span",{className:"text-xs bg-blue-50 text-blue-600 px-2 py-0.5 rounded-full font-medium",children:"预览可用"})]}),e.jsx("button",{type:"button",onClick:Ye,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ 添加关键任务"})]}),e.jsxs("div",{className:"space-y-3",children:[(me=l.keyTasks)==null?void 0:me.map((t,s)=>e.jsxs("div",{className:"flex gap-3 items-end bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"任务名称"}),e.jsx("select",{className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.definitionId,onChange:a=>ae(s,"definitionId",a.target.value),children:$.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))})]}),e.jsxs("div",{className:"w-1/4",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"开始日期"}),e.jsx("input",{type:"date",className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.startDate,onChange:a=>ae(s,"startDate",a.target.value)})]}),e.jsxs("div",{className:"w-1/4",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"结束日期"}),e.jsx("input",{type:"date",className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.endDate,onChange:a=>ae(s,"endDate",a.target.value)})]}),e.jsx("button",{type:"button",onClick:()=>Ze(s),className:"p-2.5 text-slate-400 hover:text-red-500 transition-colors",children:e.jsx(O,{size:18})})]},s)),(!l.keyTasks||l.keyTasks.length===0)&&e.jsx("div",{className:"text-center py-6 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-dashed border-slate-300 dark:border-slate-700",children:e.jsx("p",{className:"text-sm text-slate-400",children:"暂未添加关键任务，甘特图将显示默认进度条"})})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"跨项目里程碑依赖"}),e.jsx("span",{className:"text-xs bg-purple-50 text-purple-600 px-2 py-0.5 rounded-full font-medium",children:"PMO 核心"})]}),e.jsx("button",{type:"button",onClick:Je,className:"text-sm text-purple-600 font-bold hover:underline",children:"+ 添加外部依赖"})]}),e.jsxs("div",{className:"space-y-3",children:[(ue=l.milestoneDependencies)==null?void 0:ue.map((t,s)=>{var a,d,o;return e.jsxs("div",{className:"flex flex-col gap-3 bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"本项目的里程碑"}),e.jsxs("select",{className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.sourceMilestoneId,onChange:n=>G(s,"sourceMilestoneId",n.target.value),children:[e.jsx("option",{value:"",children:"选择本项目里程碑"}),(a=l.milestones)==null?void 0:a.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"依赖类型"}),e.jsxs("select",{className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.type,onChange:n=>G(s,"type",n.target.value),children:[e.jsx("option",{value:"FS",children:"完成-开始 (FS)"}),e.jsx("option",{value:"SS",children:"开始-开始 (SS)"}),e.jsx("option",{value:"FF",children:"完成-完成 (FF)"}),e.jsx("option",{value:"SF",children:"开始-完成 (SF)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"外部依赖项目"}),e.jsxs("select",{className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.targetProjectId,onChange:n=>G(s,"targetProjectId",n.target.value),children:[e.jsx("option",{value:"",children:"选择目标项目"}),C.filter(n=>n.id!==j).map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"目标里程碑"}),e.jsxs("select",{className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.targetMilestoneId,onChange:n=>G(s,"targetMilestoneId",n.target.value),disabled:!t.targetProjectId,children:[e.jsx("option",{value:"",children:"选择目标里程碑"}),(o=(d=C.find(n=>n.id===t.targetProjectId))==null?void 0:d.milestones)==null?void 0:o.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsx("button",{type:"button",onClick:()=>Xe(s),className:"p-2.5 text-slate-400 hover:text-red-500 transition-colors bg-white dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-700",children:e.jsx(O,{size:18})})]})]})]},s)}),(!l.milestoneDependencies||l.milestoneDependencies.length===0)&&e.jsx("div",{className:"text-center py-6 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-dashed border-slate-300 dark:border-slate-700",children:e.jsx("p",{className:"text-sm text-slate-400",children:"暂未添加跨项目依赖，项目将独立运行"})})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Environment Resources"}),e.jsx("button",{type:"button",onClick:Ge,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Environment"})]}),e.jsxs("div",{className:"space-y-3",children:[(be=l.environmentRequirements)==null?void 0:be.map((t,s)=>e.jsxs("div",{className:"flex flex-col gap-3 bg-slate-50 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Environment"}),e.jsxs("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.environmentId,onChange:a=>W(s,"environmentId",a.target.value),children:[k.map(a=>e.jsxs("option",{value:a.id,children:[a.name," (",a.type,")"]},a.id)),k.length===0&&e.jsx("option",{disabled:!0,children:"No environments available"})]})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Purpose"}),e.jsx("input",{type:"text",placeholder:"e.g. UAT Testing",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.purpose,onChange:a=>W(s,"purpose",a.target.value)})]}),e.jsx("button",{type:"button",onClick:()=>Ve(s),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(O,{size:16})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Start Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.startDate,onChange:a=>W(s,"startDate",a.target.value)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"End Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.endDate,onChange:a=>W(s,"endDate",a.target.value)})]})]})]},s)),((he=l.environmentRequirements)==null?void 0:he.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No environment resources requested."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Scoring Factors"}),e.jsxs("div",{className:"bg-blue-50 text-blue-700 px-3 py-1 rounded-lg font-bold text-sm",children:["Predicted Score: ",Qe.toFixed(2)]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4",children:v.map(t=>{var s,a;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("label",{className:"font-medium text-slate-600",children:t.name}),e.jsx("span",{className:"font-bold text-blue-600",children:((s=l.factors)==null?void 0:s[t.id])||0})]}),e.jsx("input",{type:"range",min:"0",max:"10",step:"1",className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600",value:((a=l.factors)==null?void 0:a[t.id])||0,onChange:d=>i(o=>({...o,factors:{...o.factors,[t.id]:parseInt(d.target.value)}}))})]},t.id)})})]}),e.jsxs("div",{className:"border-t-4 border-blue-500 pt-8 mt-12 bg-slate-50/50 p-6 rounded-[32px] border dark:bg-slate-800/20 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"p-3 bg-blue-500 rounded-2xl text-white shadow-lg shadow-blue-500/20",children:e.jsx(Ie,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white uppercase tracking-tighter",children:"PMO 战略管控指标"}),e.jsx("p",{className:"text-xs font-bold text-slate-500 mt-0.5",children:"必填信息：用于投资组合热力图、资源负荷图及路线图展示"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-[10px] font-black text-blue-600 uppercase tracking-widest border-b border-blue-100 pb-2",children:"基础热力图维度"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black text-slate-500 uppercase mb-2",children:"战略一致性 (0-5)"}),e.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",className:"w-full p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-blue-500 font-bold dark:bg-slate-900 dark:border-slate-700 dark:text-white",value:(pe=l.pmoMetrics)==null?void 0:pe.strategicConsistency,onChange:t=>i({...l,pmoMetrics:{...l.pmoMetrics,strategicConsistency:parseFloat(t.target.value)}})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black text-slate-500 uppercase mb-2",children:"研发投入 (万元)"}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-blue-500 font-bold dark:bg-slate-900 dark:border-slate-700 dark:text-white",value:(ge=l.pmoMetrics)==null?void 0:ge.rdInvestment,onChange:t=>i({...l,pmoMetrics:{...l.pmoMetrics,rdInvestment:parseFloat(t.target.value)}})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-black text-slate-500 uppercase mb-2",children:"技术平台 (路线图分组)"}),e.jsxs("select",{className:"w-full p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-blue-500 font-bold dark:bg-slate-900 dark:border-slate-700 dark:text-white",value:(fe=l.pmoMetrics)==null?void 0:fe.techPlatform,onChange:t=>i({...l,pmoMetrics:{...l.pmoMetrics,techPlatform:t.target.value}}),children:[e.jsx("option",{value:"Traditional",children:"Traditional CT Platform"}),e.jsx("option",{value:"PCCT",children:"PCCT Next-Gen Platform"}),e.jsx("option",{value:"AI",children:"AI Cloud Platform"}),e.jsx("option",{value:"Cloud",children:"Distributed Cloud"}),e.jsx("option",{value:"Other",children:"Custom Innovation"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-[10px] font-black text-purple-600 uppercase tracking-widest border-b border-purple-100 pb-2",children:"价值 vs 风险 雷达图维度"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:[{key:"commercialROI",label:"商业回报 (NPV+Margin)"},{key:"strategicFit",label:"战略契合度"},{key:"technicalFeasibility",label:"技术可行性 (国产化)"},{key:"marketWindow",label:"市场窗口 (竞品时差)"},{key:"resourceDependency",label:"资源依赖度"}].map(t=>{var s,a;return e.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-slate-900 p-2.5 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("span",{className:"text-[11px] font-bold text-slate-600 dark:text-slate-400",children:t.label}),e.jsx("input",{type:"range",min:"0",max:"5",step:"1",className:"w-24 accent-purple-600",value:(a=(s=l.pmoMetrics)==null?void 0:s.valueRiskMetrics)==null?void 0:a[t.key],onChange:d=>i({...l,pmoMetrics:{...l.pmoMetrics,valueRiskMetrics:{...l.pmoMetrics.valueRiskMetrics,[t.key]:parseInt(d.target.value)}}})})]},t.key)})})]}),e.jsxs("div",{className:"col-span-2 space-y-6",children:[e.jsx("h4",{className:"text-[10px] font-black text-orange-600 uppercase tracking-widest border-b border-orange-100 pb-2",children:"核心资源负荷预测 (未来6个月人月需求)"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:(je=l.pmoMetrics)==null?void 0:je.resourceLoad.map((t,s)=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-2 h-4 bg-orange-500 rounded-full"}),e.jsx("span",{className:"text-xs font-black text-slate-800 dark:text-slate-100 uppercase",children:t.roleName})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:["2026-01","2026-02","2026-03","2026-04","2026-05","2026-06"].map(a=>e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 block mb-1",children:a}),e.jsx("input",{type:"number",step:"0.1",min:"0",placeholder:"0.0",className:"w-full p-2 bg-slate-50 dark:bg-slate-800 border-none rounded-lg text-xs font-bold focus:ring-1 focus:ring-orange-500 dark:text-white",value:t.monthlyUsage[a]||0,onChange:d=>{const o=[...l.pmoMetrics.resourceLoad];o[s]={...t,monthlyUsage:{...t.monthlyUsage,[a]:parseFloat(d.target.value)||0}},i({...l,pmoMetrics:{...l.pmoMetrics,resourceLoad:o}})}})]},a))})]},t.roleId))})]}),e.jsxs("div",{className:"col-span-2 space-y-6",children:[e.jsx("h4",{className:"text-[10px] font-black text-green-600 uppercase tracking-widest border-b border-green-100 pb-2",children:"现金流与投资回报 (用于瀑布图)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black text-slate-500 uppercase mb-2",children:"年度研发总预算 (万元)"}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-green-500 font-bold dark:bg-slate-900 dark:border-slate-700 dark:text-white",value:(ve=l.pmoMetrics)==null?void 0:ve.cashFlow.annualBudget,onChange:t=>i({...l,pmoMetrics:{...l.pmoMetrics,cashFlow:{...l.pmoMetrics.cashFlow,annualBudget:parseFloat(t.target.value)||0}}})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black text-slate-500 uppercase mb-2",children:"本项目研发总额 (万元)"}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-green-500 font-bold dark:bg-slate-900 dark:border-slate-700 dark:text-white",value:(Ne=l.pmoMetrics)==null?void 0:Ne.cashFlow.currentInvestment,onChange:t=>i({...l,pmoMetrics:{...l.pmoMetrics,cashFlow:{...l.pmoMetrics.cashFlow,currentInvestment:parseFloat(t.target.value)||0}}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs font-black text-slate-500 uppercase mb-2",children:"未来 3 年预期回本"}),e.jsx("div",{className:"flex gap-2",children:[0,1,2].map(t=>{var s;return e.jsx("input",{type:"number",placeholder:`Y${t+1}`,className:"flex-1 p-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-green-500 font-bold text-xs dark:bg-slate-900 dark:border-slate-700 dark:text-white",value:((s=l.pmoMetrics)==null?void 0:s.cashFlow.futureROI[t])||0,onChange:a=>{const d=[...l.pmoMetrics.cashFlow.futureROI];d[t]=parseFloat(a.target.value)||0,i({...l,pmoMetrics:{...l.pmoMetrics,cashFlow:{...l.pmoMetrics.cashFlow,futureROI:d}}})}},t)})})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:Ke,className:"px-6 py-3 rounded-xl text-slate-600 hover:bg-slate-100 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-700 shadow-lg shadow-blue-600/20 transition-colors",children:"Save Project"})]})]})]})}),Q&&e.jsx(ft,{templates:_e,onSelect:Ee,onClose:()=>x(!1)})]})};export{Tt as default};
