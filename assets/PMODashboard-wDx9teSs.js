import{e as re,r as f,j as e,C as S,c as w,T as A,d as W,i as Z,G as Y,R as O,I as le,F as U,X as de,l as ne,Z as ie,u as ce,H as oe,U as xe,J as me}from"./index-BqZSi2fU.js";import{u as he}from"./usePMOStore-L-P2G_SZ.js";import{C as N,a as H,B as L}from"./Badge-Kv9GklS-.js";import{C as B}from"./clock-Bozt3zJC.js";import{T as F}from"./trending-down-D_PZJQW5.js";import{T as _}from"./target-DSjQ7gL_.js";import{C as q}from"./calendar-B2piyF0m.js";import{D as V}from"./dollar-sign-D5aD4RMz.js";import{i as be,j as ge,k as pe,s as ue,l as je}from"./pmoExportUtils-BTHDPaTm.js";import{N as T}from"./network-D8ovDaIf.js";import{C as J}from"./chevron-right-UxlMJY9H.js";import{m as X}from"./proxy-B1jXVJP0.js";import{A as fe}from"./index-CxIDBVcs.js";import{D as Ne}from"./download-BQChd_26.js";import{R as ke}from"./ResourceRiskPredictor-CseGEbEG.js";import{S as K}from"./shield-check-Dm-W7IQB.js";import{C as Q,h as ve,f as we,G as ye}from"./stageGateManagement-DbE5op0J.js";import{R as Ce,a as De,T as Pe,L as ze}from"./generateCategoricalChart-BpsPtrl5.js";import{P as Re,a as Se}from"./PieChart-DEQ9wEch.js";import"./resourcePrediction-CuiiAjvb.js";import"./addMonths-D5X9UYZa.js";import"./format-CE-Ifukx.js";import"./activity-D-tbhC_J.js";import"./zap-DoHTuXpU.js";import"./AreaChart-Bk_Zo0wb.js";import"./Line-BnpibuuN.js";import"./filter-CV5wrPJv.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=re("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Ie=({projects:t})=>{const a=f.useMemo(()=>t.filter(s=>s.status==="active").map(s=>{const x=[];let b=100;const y=new Date(s.endDate),k=new Date,v=Math.ceil((y.getTime()-k.getTime())/(1e3*60*60*24));v<0?(x.push({type:"schedule",severity:"high",message:`已延期 ${Math.abs(v)} 天`}),b-=30):v<7&&(x.push({type:"schedule",severity:"medium",message:`即将到期（${v} 天）`}),b-=15);const n=s.actualCost&&s.budget?s.actualCost/s.budget*100:0;n>100?(x.push({type:"budget",severity:"high",message:`预算超支 ${(n-100).toFixed(1)}%`}),b-=25):n>90&&(x.push({type:"budget",severity:"medium",message:`预算使用率 ${n.toFixed(1)}%`}),b-=10);const m=s.tasks||[],g=m.filter(E=>E.status==="completed").length,c=m.length>0?g/m.length*100:0;c<30&&v<30&&(x.push({type:"quality",severity:"high",message:`任务完成率仅 ${c.toFixed(0)}%`}),b-=20),(m.length>20?Math.floor(m.length/4):0)>5&&(x.push({type:"scope",severity:"medium",message:`任务数量较多（${m.length} 个）`}),b-=10);let I="healthy";return b<50?I="critical":b<75&&(I="warning"),{projectId:s.id,projectName:s.name,healthScore:Math.max(0,b),status:I,issues:x}}).sort((s,x)=>s.healthScore-x.healthScore),[t]),o=a.filter(s=>s.status==="critical"),d=a.filter(s=>s.status==="warning"),l=a.filter(s=>s.status==="healthy"),i=s=>{switch(s){case"healthy":return e.jsx(S,{className:"w-5 h-5 text-green-600 dark:text-green-400"});case"warning":return e.jsx(w,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"});case"critical":return e.jsx(w,{className:"w-5 h-5 text-red-600 dark:text-red-400"});default:return e.jsx(B,{className:"w-5 h-5 text-slate-400"})}},r=s=>{switch(s){case"healthy":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";case"critical":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";default:return"bg-slate-50 dark:bg-slate-800 border-slate-200 dark:border-slate-700"}},h=s=>{switch(s){case"schedule":return e.jsx(B,{className:"w-4 h-4"});case"budget":return e.jsx(F,{className:"w-4 h-4"});case"scope":return e.jsx(A,{className:"w-4 h-4"});default:return e.jsx(w,{className:"w-4 h-4"})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(N,{className:"p-4 bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(S,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:"健康项目"})]}),e.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:l.length})]}),e.jsxs(N,{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(w,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"}),e.jsx("span",{className:"text-sm font-medium text-yellow-900 dark:text-yellow-100",children:"需关注"})]}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600 dark:text-yellow-400",children:d.length})]}),e.jsxs(N,{className:"p-4 bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(w,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),e.jsx("span",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:"严重问题"})]}),e.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:o.length})]})]}),e.jsxs("div",{className:"space-y-3",children:[a.slice(0,10).map(s=>e.jsxs(N,{className:`p-4 ${r(s.status)}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[i(s.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.projectName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"flex-1 bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${s.status==="healthy"?"bg-green-600":s.status==="warning"?"bg-yellow-600":"bg-red-600"}`,style:{width:`${s.healthScore}%`}})}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:s.healthScore.toFixed(0)})]})]})]}),e.jsx(H,{variant:s.status==="healthy"?"success":s.status==="warning"?"warning":"danger",children:s.status==="healthy"?"健康":s.status==="warning"?"警告":"严重"})]}),s.issues.length>0&&e.jsx("div",{className:"space-y-1",children:s.issues.map((x,b)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700 dark:text-slate-300",children:[h(x.type),e.jsx("span",{children:x.message}),e.jsx(H,{variant:x.severity==="high"?"danger":x.severity==="medium"?"warning":"neutral",size:"sm",children:x.severity})]},b))})]},s.projectId)),a.length===0&&e.jsxs(N,{className:"p-8 text-center",children:[e.jsx(S,{className:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"暂无活跃项目"})]})]})]})};function ee(t){if(!t.endDate)return"amber";const a=new Date,o=new Date(t.endDate),d=new Date(t.startDate),l=W(o,d),i=W(a,d),r=t.progress||0,h=l>0?i/l*100:0,s=r-h;return s>=-5?"green":s>=-15?"amber":"red"}function Me(t){const a=t.budget||t.totalBudget||0,o=t.actualCost||t.budgetUsed||0,d=t.progress||0;if(a===0)return"amber";const l=d/100*a,i=(o-l)/a*100;return i<=5?"green":i<=15?"amber":"red"}function Te(t){const o=(t.risks||[]).filter(i=>i.status!=="resolved"&&i.status!=="accepted");if(o.length===0)return"green";const d=o.filter(i=>i.priority==="critical").length,l=o.filter(i=>i.priority==="high").length;return d>0?"red":l>2||o.length>5?"amber":"green"}function te(t){const a=t.tasks||[];if(a.length===0)return"amber";const d=a.filter(r=>r.progress===100).length/a.length*100,l=t.progress||0,i=Math.abs(d-l);return i<=10?"green":i<=25?"amber":"red"}function Ee(t){const a=ee(t),o=te(t);return a==="green"&&o==="green"?"green":a==="red"||o==="red"?"red":"amber"}function $e(t){const a=[t.scheduleHealth,t.budgetHealth,t.scopeHealth,t.qualityHealth,t.riskHealth],o=a.filter(l=>l==="red").length,d=a.filter(l=>l==="amber").length;return o>0?"red":d>2||d>0?"amber":"green"}function se(t){const a=ee(t),o=Me(t),d=te(t),l=Ee(t),i=Te(t),r=$e({projectId:t.id,projectName:t.name,scheduleHealth:a,budgetHealth:o,scopeHealth:d,qualityHealth:l,riskHealth:i});return{projectId:t.id,projectName:t.name,scheduleHealth:a,budgetHealth:o,scopeHealth:d,qualityHealth:l,riskHealth:i,overallHealth:r,trend:"stable"}}function Ae(t){const a=t.filter(c=>c.status==="active"),o=t.filter(c=>c.status==="completed"),d=t.filter(c=>c.status==="on-hold"),l=t.reduce((c,p)=>c+(p.budget||p.totalBudget||0),0),i=t.reduce((c,p)=>c+(p.actualCost||p.budgetUsed||0),0),r=t.reduce((c,p)=>c+(p.score||0)*1e5,0),h=a.map(se),s=h.filter(c=>c.overallHealth==="green").length,x=h.filter(c=>c.overallHealth==="amber").length,b=h.filter(c=>c.overallHealth==="red").length,k=t.flatMap(c=>c.risks||[]).filter(c=>c.status!=="resolved"&&c.status!=="accepted"),v=k.reduce((c,p)=>c+(p.estimatedCostImpact||0),0),n=k.filter(c=>c.priority==="critical").length,m=t.reduce((c,p)=>{const I=p.resourceRequirements||[];return c+I.reduce((E,u)=>E+u.count,0)},0),g=m>0?75:0;return{totalProjects:t.length,activeProjects:a.length,completedProjects:o.length,onHoldProjects:d.length,totalBudget:l,totalSpent:i,totalValue:r,healthDistribution:{green:s,amber:x,red:b},totalRiskExposure:v,criticalRisks:n,totalResourcesAllocated:m,resourceUtilizationRate:g}}function G(t,a="bg"){return{green:{bg:"bg-green-100 dark:bg-green-900/20",text:"text-green-700 dark:text-green-400",border:"border-green-500"},amber:{bg:"bg-orange-100 dark:bg-orange-900/20",text:"text-orange-700 dark:text-orange-400",border:"border-orange-500"},red:{bg:"bg-red-100 dark:bg-red-900/20",text:"text-red-700 dark:text-red-400",border:"border-red-500"}}[t][a]}const $=({status:t,label:a})=>{const o=G(t,"bg"),d=G(t,"text");return e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${o} ${d} text-center`,title:a,children:t==="green"?"●":t==="amber"?"▲":"■"})},Be=({trend:t})=>t==="improving"?e.jsx(A,{size:14,className:"text-green-600 dark:text-green-400"}):t==="declining"?e.jsx(F,{size:14,className:"text-red-600 dark:text-red-400"}):e.jsx(He,{size:14,className:"text-slate-400"}),Le=({projects:t})=>{const a=Z(),o=f.useMemo(()=>t.filter(d=>d.status==="active"||d.status==="planning").map(d=>({project:d,health:se(d)})).sort((d,l)=>{const i={red:0,amber:1,green:2};return i[d.health.overallHealth]-i[l.health.overallHealth]}),[t]);return o.length===0?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-8 text-center",children:[e.jsx(_,{size:48,className:"mx-auto mb-3 text-slate-300 dark:text-slate-600"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"暂无活跃项目"})]}):e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"项目健康状态矩阵"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:["RAG 状态：",e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"● 良好"})," ·",e.jsx("span",{className:"text-orange-600 dark:text-orange-400 ml-2",children:"▲ 警告"})," ·",e.jsx("span",{className:"text-red-600 dark:text-red-400 ml-2",children:"■ 风险"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"项目名称"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(q,{size:12}),"进度"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(V,{size:12}),"预算"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(_,{size:12}),"范围"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(S,{size:12}),"质量"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(w,{size:12}),"风险"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"综合"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"趋势"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:o.map(({project:d,health:l})=>{const i=G(l.overallHealth,"bg");return e.jsxs("tr",{onClick:()=>a(`/projects/${d.id}`),className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:d.name}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:d.manager||"未分配"})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx($,{status:l.scheduleHealth,label:"进度健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx($,{status:l.budgetHealth,label:"预算健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx($,{status:l.scopeHealth,label:"范围健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx($,{status:l.qualityHealth,label:"质量健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx($,{status:l.riskHealth,label:"风险健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full ${i}`,children:e.jsx("span",{className:`text-sm font-bold ${G(l.overallHealth,"text")}`,children:l.overallHealth==="green"?"健康":l.overallHealth==="amber"?"警告":"风险"})})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(Be,{trend:l.trend})})})]},d.id)})})]})}),e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 border-t border-slate-200 dark:border-slate-700 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("span",{className:"font-medium",children:"提示："})," 点击项目行查看详情 · RAG 指标基于进度、预算、范围、质量和风险的综合评估"]})]})},Fe=()=>{var y,k,v;const t=Y(),[a,o]=f.useState(null),[d,l]=f.useState(7),i=f.useMemo(()=>be(t),[t]),r=f.useMemo(()=>ge(t,i),[t,i]),h=f.useMemo(()=>i.map(n=>({...n,criticalPath:r.includes(n.sourceProjectId)&&r.includes(n.targetProjectId)})),[i,r]),s=f.useMemo(()=>pe(t,h),[t,h]),x=f.useMemo(()=>a?ue(a,d,t,h):[],[a,d,t,h]),b=f.useMemo(()=>t.filter(m=>m.status==="active"||m.status==="planning").map(m=>({id:m.id,name:m.name,isCritical:r.includes(m.id),incomingDeps:h.filter(g=>g.targetProjectId===m.id).length,outgoingDeps:h.filter(g=>g.sourceProjectId===m.id).length})),[t,r,h]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[e.jsx(T,{size:64,className:"text-slate-300 dark:text-slate-600 mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"暂无项目数据"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"创建项目后即可查看跨项目依赖关系"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-3",children:[e.jsx(T,{className:"text-purple-600 dark:text-purple-400",size:32}),"跨项目依赖分析"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Cross-Project Dependency Analysis - 战略风险管理"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{size:20,className:"text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400 uppercase",children:"总依赖数"})]}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:s.totalDependencies})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(w,{size:20,className:"text-red-600 dark:text-red-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400 uppercase",children:"关键路径依赖"})]}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:s.criticalDependencies})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(F,{size:20,className:"text-orange-600 dark:text-orange-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400 uppercase",children:"最受依赖项目"})]}),e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-slate-100 truncate",children:((y=s.mostDependentProject)==null?void 0:y.name)||"无"}),s.mostDependentProject&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:[s.mostDependentProject.count," 个依赖"]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(B,{size:20,className:"text-purple-600 dark:text-purple-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400 uppercase",children:"最阻塞项目"})]}),e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-slate-100 truncate",children:((k=s.mostBlockingProject)==null?void 0:k.name)||"无"}),s.mostBlockingProject&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["阻塞 ",s.mostBlockingProject.count," 个项目"]})]})]}),r.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 rounded-xl shadow-sm border border-red-200 dark:border-red-800 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 flex items-center gap-2",children:[e.jsx(w,{className:"text-red-600 dark:text-red-400",size:20}),"全局关键路径"]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:r.map((n,m)=>{const g=t.find(c=>c.id===n);return g?e.jsxs(O.Fragment,{children:[e.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-slate-800 rounded-lg border-2 border-red-500 shadow-sm",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:g.name}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:g.manager||"未分配"})]}),m<r.length-1&&e.jsx(J,{className:"text-red-600 dark:text-red-400",size:20})]},n):null})}),e.jsx("div",{className:"mt-4 p-3 bg-white/50 dark:bg-slate-900/50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(le,{size:16,className:"text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("strong",{children:"关键路径"}),"是项目组合中最长的依赖链。任何关键路径上的项目延迟都会直接影响整个组合的完成时间。"]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4",children:"依赖网络图"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(n=>e.jsxs(X.div,{whileHover:{scale:1.02},className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${n.isCritical?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50"} ${a===n.id?"ring-2 ring-blue-500":""}`,onClick:()=>o(n.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:n.name}),n.isCritical&&e.jsx(w,{size:16,className:"text-red-600 dark:text-red-400 flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600 dark:text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{size:12}),e.jsxs("span",{children:[n.incomingDeps," 入"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{size:12}),e.jsxs("span",{children:[n.outgoingDeps," 出"]})]})]})]},n.id))})]}),e.jsx(fe,{children:a&&e.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"text-blue-600 dark:text-blue-400",size:20}),"延迟影响模拟"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"模拟延迟天数"}),e.jsx("input",{type:"number",value:d,onChange:n=>l(parseInt(n.target.value)||0),min:"1",max:"90",className:"w-32 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100"}),e.jsx("span",{className:"ml-2 text-sm text-slate-600 dark:text-slate-400",children:"天"})]}),x.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:["如果 ",e.jsx("strong",{children:(v=t.find(n=>n.id===a))==null?void 0:v.name})," 延迟 ",e.jsx("strong",{children:d})," 天，将影响以下项目："]}),x.map(n=>e.jsx("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:n.projectName}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-400 mt-1",children:["原计划: ",new Date(n.originalEndDate).toLocaleDateString("zh-CN")," → 新计划: ",new Date(n.newEndDate).toLocaleDateString("zh-CN")]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:["+",n.delayDays," 天"]})})]})},n.projectId))]}):e.jsx("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800 text-center",children:e.jsx("p",{className:"text-sm text-green-700 dark:text-green-400",children:"✓ 该项目延迟不会影响其他项目"})})]})})]})},Ge=()=>{const t=Y();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-3",children:[e.jsx(T,{className:"text-purple-600 dark:text-purple-400",size:32}),"跨项目依赖分析"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Cross-Project Dependency Analysis - 识别项目间的关联和连锁风险"})]}),e.jsxs("button",{onClick:()=>je(t),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors",children:[e.jsx(Ne,{size:16}),"导出依赖分析"]})]}),e.jsx(Fe,{}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-xl shadow-sm border border-purple-200 dark:border-purple-800 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4",children:"使用指南"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"依赖类型"}),e.jsxs("ul",{className:"space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"完成-开始 (FS):"})," 项目A完成后项目B才能开始"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"开始-开始 (SS):"})," 两个项目同时开始"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"完成-完成 (FF):"})," 两个项目同时完成"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"资源依赖:"})," 共享相同的资源池"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"关键路径"}),e.jsxs("ul",{className:"space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"• 标记为红色边框的项目在关键路径上"}),e.jsx("li",{children:"• 关键路径上的任何延迟都会影响整体交付"}),e.jsx("li",{children:"• 优先关注关键路径上的项目"}),e.jsx("li",{children:"• 使用延迟模拟评估风险影响"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"延迟影响模拟"}),e.jsxs("ul",{className:"space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"1. 点击任意项目卡片"}),e.jsx("li",{children:"2. 设置模拟延迟天数"}),e.jsx("li",{children:"3. 查看受影响的下游项目"}),e.jsx("li",{children:"4. 评估连锁反应和风险"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"最佳实践"}),e.jsxs("ul",{className:"space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"• 定期审查项目间依赖关系"}),e.jsx("li",{children:"• 识别并消除不必要的依赖"}),e.jsx("li",{children:"• 为关键路径项目预留缓冲时间"}),e.jsx("li",{children:"• 建立跨项目沟通机制"})]})]})]})]})]})},Ue=({request:t,onClose:a,onApprove:o,onReject:d,isPMO:l})=>{var x,b,y;const[i,r]=O.useState(""),h=t.status==="pending",s=t.category==="project_status"&&((x=t.metadata)==null?void 0:x.type)==="stage_gate";return e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[100] flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs(N,{className:"w-full max-w-2xl bg-white dark:bg-slate-900 shadow-2xl rounded-[32px] overflow-hidden",children:[e.jsxs("div",{className:`p-6 flex justify-between items-center ${s?"bg-indigo-50 dark:bg-indigo-900/20":"bg-blue-50 dark:bg-blue-900/20"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center shadow-lg text-white ${s?"bg-indigo-600 shadow-indigo-500/30":"bg-blue-600 shadow-blue-500/30"}`,children:s?e.jsx(K,{size:24}):e.jsx(U,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(H,{variant:"neutral",size:"sm",children:t.projectName}),e.jsx(H,{variant:t.status==="approved"?"success":t.status==="rejected"?"danger":"warning",size:"sm",children:t.status==="pending"?"待审批":t.status==="approved"?"已批准":"已拒绝"})]})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-white dark:hover:bg-slate-800 rounded-full transition-colors",children:e.jsx(de,{size:24,className:"text-slate-400"})})]}),e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"申请人"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-slate-900 dark:text-slate-100",children:[e.jsx(ne,{size:14,className:"text-slate-400"}),t.requestedByName||t.requestedBy]})]}),e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"申请日期"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-slate-900 dark:text-slate-100",children:[e.jsx(B,{size:14,className:"text-slate-400"}),new Date(t.requestDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"变更类型"}),e.jsx("div",{className:"flex items-center gap-2 text-sm font-bold text-slate-900 dark:text-slate-100",children:e.jsx(H,{variant:"neutral",size:"sm",children:t.category==="project_status"?"项目状态":t.category})})]}),e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"影响等级"}),e.jsxs("div",{className:`flex items-center gap-2 text-sm font-bold ${t.impactLevel==="critical"||t.impactLevel==="high"?"text-red-600":"text-orange-600"}`,children:[e.jsx(w,{size:14}),t.impactLevel.toUpperCase()]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2",children:"变更详情"}),e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800 text-slate-700 dark:text-slate-300 whitespace-pre-wrap",children:t.description})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2",children:"变更理由"}),e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800 text-slate-700 dark:text-slate-300",children:t.businessJustification})]}),!s&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/10 rounded-2xl border border-blue-100 dark:border-blue-900/30",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400 mb-1",children:[e.jsx(B,{size:16}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"工时增加"})]}),e.jsxs("div",{className:"text-2xl font-black text-slate-900 dark:text-slate-100",children:[t.estimatedEffortHours," hr"]})]}),e.jsxs("div",{className:"p-4 bg-emerald-50 dark:bg-emerald-900/10 rounded-2xl border border-emerald-100 dark:border-emerald-900/30",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600 dark:text-emerald-400 mb-1",children:[e.jsx(V,{size:16}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"预算影响"})]}),e.jsxs("div",{className:"text-2xl font-black text-slate-900 dark:text-slate-100",children:["¥",t.estimatedCostIncrease.toLocaleString()]})]}),e.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/10 rounded-2xl border border-amber-100 dark:border-amber-900/30",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-600 dark:text-amber-400 mb-1",children:[e.jsx(A,{size:16}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"进度偏差"})]}),e.jsxs("div",{className:"text-2xl font-black text-slate-900 dark:text-slate-100",children:["+",t.scheduleImpactDays," d"]})]})]})]}),h&&l&&e.jsxs("div",{className:"pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-900 dark:text-slate-100 mb-3 flex items-center gap-2",children:[e.jsx(K,{size:18,className:"text-indigo-600"}),"PMO 审批决策"]}),e.jsx("textarea",{value:i,onChange:k=>r(k.target.value),className:"w-full px-4 py-3 rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-4 focus:ring-indigo-100 outline-none transition-all mb-4",placeholder:"请输入审批意见或拒绝原因...",rows:3}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>o(t.id,i),className:"flex-1 py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-2xl font-bold shadow-xl shadow-indigo-500/20 transition-all flex items-center justify-center gap-2",children:[e.jsx(S,{size:20}),"核准变更"]}),e.jsxs("button",{onClick:()=>d(t.id,i),className:"flex-1 py-4 bg-red-600 hover:bg-red-700 text-white rounded-2xl font-bold shadow-xl shadow-red-500/20 transition-all flex items-center justify-center gap-2",children:[e.jsx(Q,{size:20}),"拒绝请求"]})]})]}),!h&&e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase",children:"审批结果"}),e.jsx("div",{className:"text-xs text-slate-400",children:new Date(t.approvalDate).toLocaleString()})]}),e.jsxs("div",{className:"font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2 mb-2",children:[t.status==="approved"?e.jsx(S,{size:16,className:"text-emerald-500"}):e.jsx(Q,{size:16,className:"text-red-500"}),t.approvedByName]}),(t.rejectionReason||((b=t.metadata)==null?void 0:b.approvalComment))&&e.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400 italic",children:['"',t.rejectionReason||((y=t.metadata)==null?void 0:y.approvalComment),'"']})]})]})]})})},_e=({projects:t,stats:a,changeRequests:o,setSelectedRequest:d,navigate:l,setActiveTab:i})=>{const r=f.useMemo(()=>Ae(t),[t]),h=[{name:"健康",value:r.healthDistribution.green,color:"#10b981"},{name:"警告",value:r.healthDistribution.amber,color:"#f59e0b"},{name:"风险",value:r.healthDistribution.red,color:"#ef4444"}].filter(s=>s.value>0);return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-5",children:[e.jsxs(N,{className:"lg:col-span-2 p-6 bg-gradient-to-br from-blue-600 to-indigo-700 text-white border-none shadow-xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute -right-4 -top-4 opacity-10 group-hover:scale-110 transition-transform",children:e.jsx(_,{size:140})}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 opacity-80",children:[e.jsx(ye,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"战略执行总览 (CTPM Portfolio)"})]}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-4xl font-black mb-1",children:[a.activeProjects," / ",a.totalProjects]}),e.jsx("p",{className:"text-blue-100 text-sm",children:"活跃项目数 / 总项目库"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-emerald-300",children:[a.completionRate.toFixed(1),"%"]}),e.jsx("p",{className:"text-blue-200 text-xs text-nowrap",children:"全组合平均进度"})]})]})]}),e.jsx("div",{className:"mt-6 w-full bg-white/20 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-white h-full shadow-[0_0_10px_rgba(255,255,255,0.5)] transition-all duration-1000",style:{width:`${a.completionRate}%`}})})]})]}),e.jsxs(N,{className:"p-6 bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 shadow-lg flex flex-col justify-between hover:shadow-xl transition-all",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 text-orange-500",children:[e.jsx(w,{size:20}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"关键变更审批"})]}),e.jsx("div",{className:"text-3xl font-black text-slate-900 dark:text-slate-100",children:a.pendingChangeRequests})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 dark:border-slate-700 flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] font-bold text-red-500 uppercase",children:"Urgent Action Required"}),e.jsx(L,{size:"sm",variant:"ghost",onClick:()=>l("/pmo"),className:"hover:bg-orange-50 dark:hover:bg-orange-900/20 text-orange-600",children:e.jsx(U,{size:16})})]})]}),e.jsxs(N,{className:"p-6 bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 shadow-lg flex flex-col justify-between hover:shadow-xl transition-all",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 text-emerald-500",children:[e.jsx(V,{size:20}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"组合预算执行"})]}),e.jsxs("div",{className:"text-3xl font-black text-slate-900 dark:text-slate-100",children:["¥",(r.totalBudget/1e4).toFixed(0),"w"]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 dark:border-slate-700 text-[10px]",children:[e.jsxs("div",{className:"flex justify-between text-slate-500 mb-1 font-bold",children:[e.jsx("span",{children:"BUDGET BURN"}),e.jsxs("span",{className:"text-emerald-600",children:[(r.totalSpent/r.totalBudget*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-100 dark:bg-slate-700 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-emerald-500 h-full rounded-full transition-all duration-1000",style:{width:`${r.totalSpent/r.totalBudget*100}%`}})})]})]}),e.jsxs(N,{className:"p-6 bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 shadow-lg flex flex-col justify-between hover:shadow-xl transition-all",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 text-indigo-500",children:[e.jsx(xe,{size:20}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"人力资源效能"})]}),e.jsxs("div",{className:"text-3xl font-black text-slate-900 dark:text-slate-100",children:[r.resourceUtilizationRate,"%"]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-100 dark:border-slate-700 text-xs text-slate-400",children:e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:e.jsxs(H,{variant:"neutral",className:"bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 border-none font-bold text-[9px]",children:[r.totalResourcesAllocated," RESOURCES ACTIVE"]})})})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Le,{projects:t})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs(N,{className:"lg:col-span-4 p-6 bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsxs("h3",{className:"text-base font-black text-slate-900 dark:text-slate-100 mb-6 flex items-center justify-between border-b pb-4 border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 uppercase tracking-tight",children:[e.jsx(A,{size:18,className:"text-emerald-500"}),"Health Status Distribution"]}),e.jsx(H,{variant:"success",children:"LIVE DATA"})]}),e.jsx("div",{className:"h-[220px]",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(Re,{children:[e.jsx(Se,{data:h,cx:"50%",cy:"50%",innerRadius:60,outerRadius:85,paddingAngle:8,dataKey:"value",stroke:"none",children:h.map((s,x)=>e.jsx(De,{fill:s.color},`cell-${x}`))}),e.jsx(Pe,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgba(0,0,0,0.1)"}}),e.jsx(ze,{verticalAlign:"bottom",height:36,iconType:"circle",wrapperStyle:{fontSize:"12px",fontWeight:"bold"}})]})})})]}),e.jsxs(N,{className:"lg:col-span-8 p-0 bg-slate-900 border-none shadow-2xl overflow-hidden flex flex-col md:flex-row min-h-[300px] group",children:[e.jsxs("div",{className:"p-8 flex-1 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-black text-white mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"w-2.5 h-2.5 bg-emerald-500 rounded-full animate-pulse shadow-[0_0_8px_#10b981]"}),"PMO INTELLIGENCE SHIELD"]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-slate-800/80 p-5 rounded-2xl border border-white/5 backdrop-blur-sm",children:[e.jsxs("p",{className:"text-slate-500 text-[10px] font-black uppercase mb-2 tracking-widest flex items-center gap-2",children:[e.jsx(S,{size:12,className:"text-emerald-500"}),"Autonomous Analytics Report"]}),e.jsxs("p",{className:"text-slate-200 text-sm leading-relaxed font-medium",children:["系统防御层运行稳定。检测到 ",e.jsx("span",{className:"text-red-400 font-black px-1.5 py-0.5 bg-red-500/10 rounded",children:r.criticalRisks})," 项关键风险暴露， 建议针对当前环境负载为 ",e.jsxs("span",{className:"text-emerald-400 font-black",children:[((1-a.availableEnvironments/Math.max(1,a.totalEnvironments))*100).toFixed(0),"%"]})," 的瓶颈项开启推演。"]})]})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-8",children:[e.jsxs(L,{onClick:()=>l("/simulation"),variant:"primary",className:"bg-blue-600 hover:bg-blue-500 text-white border-none px-6 py-6 font-bold shadow-xl shadow-blue-900/40 rounded-xl",children:[e.jsx(A,{className:"mr-2 h-4 w-4"})," 开启 What-If 推演"]}),e.jsxs(L,{onClick:()=>i("dependencies"),variant:"secondary",className:"bg-slate-800 hover:bg-slate-700 text-white border-slate-700 px-6 py-6 font-bold rounded-xl",children:[e.jsx(T,{className:"mr-2 h-4 w-4"})," 跨项目深度分析"]})]})]}),e.jsx("div",{className:"bg-white/5 p-8 w-full md:w-72 border-l border-white/5 flex flex-col justify-center backdrop-blur-xl",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-[10px] font-black text-slate-500 mb-1 tracking-widest uppercase",children:"需求交付完成率"}),e.jsxs("div",{className:"text-4xl font-black text-white",children:[a.requirementCompletionRate.toFixed(0),e.jsx("span",{className:"text-lg opacity-40 ml-1",children:"%"})]}),e.jsx("div",{className:"absolute -left-3 top-0 bottom-0 w-1 bg-emerald-500 rounded-full"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-[10px] font-black text-slate-500 mb-1 tracking-widest uppercase",children:"环境可用资源"}),e.jsxs("div",{className:"text-4xl font-black text-white",children:[a.availableEnvironments,e.jsxs("span",{className:"text-lg opacity-40 ml-1",children:["/",a.totalEnvironments]})]}),e.jsx("div",{className:"absolute -left-3 top-0 bottom-0 w-1 bg-indigo-500 rounded-full"})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-emerald-500/10 text-emerald-400 rounded-full text-[10px] font-black border border-emerald-500/20",children:[e.jsx(S,{size:14})," DEFENSE SECURE"]})})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs(N,{className:"lg:col-span-7 p-6 bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 shadow-sm relative overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8 border-b pb-4 border-slate-100 dark:border-slate-700",children:[e.jsxs("h3",{className:"text-base font-black flex items-center gap-2 uppercase tracking-tight",children:[e.jsx(U,{size:18,className:"text-blue-500"}),"Pending Change Control"]}),e.jsx(L,{variant:"ghost",size:"sm",className:"text-[10px] uppercase font-black text-blue-600 tracking-widest",onClick:()=>l("/pmo"),children:"Open Control Center"})]}),o.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-400 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("th",{className:"pb-4 font-black text-[10px] uppercase tracking-widest",children:"Project Name"}),e.jsx("th",{className:"pb-4 font-black text-[10px] uppercase tracking-widest",children:"Type"}),e.jsx("th",{className:"pb-4 font-black text-[10px] uppercase tracking-widest",children:"Priority"}),e.jsx("th",{className:"pb-4 font-black text-[10px] uppercase tracking-widest text-right",children:"Time"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:o.slice(0,5).map(s=>e.jsxs("tr",{onClick:()=>d(s),className:"group hover:bg-slate-50/50 dark:hover:bg-slate-800/50 transition-colors cursor-pointer",children:[e.jsx("td",{className:"py-5 font-bold text-slate-800 dark:text-slate-200 truncate max-w-[200px]",children:s.projectName}),e.jsx("td",{className:"py-5",children:e.jsx(H,{variant:"neutral",className:"bg-slate-100 dark:bg-slate-700 border-none text-[9px] font-black uppercase",children:s.category})}),e.jsx("td",{className:"py-5",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${s.status==="pending"?"bg-orange-500":"bg-emerald-500"}`}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase",children:s.status})]})}),e.jsx("td",{className:"py-5 text-right text-slate-400 font-mono text-[10px]",children:new Date(s.requestDate).toLocaleDateString()})]},s.id))})]})}):e.jsxs("div",{className:"py-20 text-center",children:[e.jsx(me,{size:40,className:"mx-auto text-slate-200 mb-4 opacity-50"}),e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"变更请求队列为空"})]})]}),e.jsxs(N,{className:"lg:col-span-5 p-6 bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsxs("h3",{className:"text-base font-black mb-8 flex items-center gap-2 uppercase tracking-tight border-b pb-4 border-slate-100 dark:border-slate-700",children:[e.jsx(w,{size:18,className:"text-red-500"}),"Exception Watchlist"]}),e.jsx("div",{className:"max-h-[380px] overflow-y-auto no-scrollbar scroll-smooth",children:e.jsx(Ie,{projects:t})})]})]})]})},ut=()=>{const t=Z(),[a,o]=ie(),d=a.get("tab"),{projects:l,updateProject:i,user:r,resourcePool:h}=ce(),{changeRequests:s,approveChangeRequest:x,rejectChangeRequest:b,environmentResources:y,requirements:k,simulations:v}=he(),[n,m]=f.useState(null),[g,c]=f.useState(d&&["overview","portfolio","dependencies","risks"].includes(d)?d:"overview");O.useEffect(()=>{const u=a.get("tab");u&&["overview","portfolio","dependencies","risks"].includes(u)&&c(u)},[a]);const p=u=>{c(u),o({tab:u})},I=f.useMemo(()=>{const u=l.filter(z=>z.status==="active"),C=l.length,R=l.filter(z=>z.status==="completed").length,j=s.filter(z=>z.status==="pending").length,P=s.length,M=k.length,D=k.filter(z=>z.status==="completed").length,ae=y.filter(z=>z.status==="available").length;return{activeProjects:u.length,totalProjects:C,completedProjects:R,completionRate:C>0?R/C*100:0,pendingChangeRequests:j,totalChangeRequests:P,totalRequirements:M,completedRequirements:D,requirementCompletionRate:M>0?D/M*100:0,availableEnvironments:ae,totalEnvironments:y.length,totalSimulations:v.length}},[l,s,k,y,v]),E=f.useMemo(()=>[...s].sort((u,C)=>new Date(C.requestDate).getTime()-new Date(u.requestDate).getTime()).slice(0,5),[s]);return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"PMO 战略管控中心"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"项目组合管理、范围防御、资源冲突管控一站式平台"})]})}),e.jsxs("div",{className:"flex gap-2 border-b border-slate-200 dark:border-slate-700 mb-6 overflow-x-auto no-scrollbar scrollbar-hide whitespace-nowrap",children:[e.jsxs("button",{onClick:()=>p("overview"),className:`flex-shrink-0 flex items-center gap-2 px-4 py-3 font-medium transition-all whitespace-nowrap ${g==="overview"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"} `,children:[e.jsx(oe,{size:18}),"管控概览"]}),e.jsxs("button",{onClick:()=>p("dependencies"),className:`flex-shrink-0 flex items-center gap-2 px-4 py-3 font-medium transition-all whitespace-nowrap ${g==="dependencies"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"} `,children:[e.jsx(T,{size:18}),"依赖分析"]}),e.jsxs("button",{onClick:()=>p("risks"),className:`flex-shrink-0 flex items-center gap-2 px-4 py-3 font-medium transition-all whitespace-nowrap ${g==="risks"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"} `,children:[e.jsx(w,{size:18}),"风险预测"]})]}),e.jsxs("div",{className:"space-y-6",children:[g==="overview"&&e.jsx(_e,{projects:l,stats:I,changeRequests:E,setSelectedRequest:m,navigate:t,setActiveTab:c}),g==="dependencies"&&e.jsx("div",{className:"animate-fadeIn",children:e.jsx(Ge,{})}),g==="risks"&&e.jsx("div",{className:"animate-fadeIn",children:e.jsx(ke,{projects:l,resourcePool:h})})]}),n&&e.jsx(Ue,{request:n,onClose:()=>m(null),isPMO:(r==null?void 0:r.role)==="admin",onApprove:(u,C)=>{var R;if(r){if(x(u,r.id,r.name||r.username),n.category==="project_status"&&((R=n.metadata)==null?void 0:R.type)==="stage_gate"){const j=l.find(P=>P.id===n.projectId);if(j&&j.gates&&j.id){const P=n.metadata.gateId,M=j.gates.map(D=>D.id===P?we(D,r.id,r.name||r.username,C):D);i(j.id,{...j,gates:M})}}m(null)}},onReject:(u,C)=>{var R;if(r){if(b(u,r.id,r.name||r.username,C),n.category==="project_status"&&((R=n.metadata)==null?void 0:R.type)==="stage_gate"){const j=l.find(P=>P.id===n.projectId);if(j&&j.gates&&j.id){const P=n.metadata.gateId,M=j.gates.map(D=>D.id===P?ve(D,r.id,r.name||r.username,C):D);i(j.id,{...j,gates:M})}}m(null)}}})]})};export{ut as default};
