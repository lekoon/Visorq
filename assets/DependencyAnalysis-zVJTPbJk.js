import{z as f,r as d,j as e,c as h,R as P,I as C}from"./index-DSFjr4LC.js";import{i as z,j as S,k as I,s as A,l as M}from"./pmoExportUtils-65LPkl23.js";import{N as m,A as B}from"./index-CaiY4BTd.js";import{T as u}from"./trending-down-Ds5j0a5S.js";import{C as E}from"./clock-DM8iXjrD.js";import{C as k}from"./chevron-right-CZbCw5Jy.js";import{m as N}from"./proxy-Bhx3FPuK.js";import{C as F}from"./calendar-DV25Uk9k.js";import{D as R}from"./download-CxXFJODp.js";const T=()=>{var g,b,p;const t=f(),[c,v]=d.useState(null),[x,y]=d.useState(7),o=d.useMemo(()=>z(t),[t]),r=d.useMemo(()=>S(t,o),[t,o]),i=d.useMemo(()=>o.map(s=>({...s,criticalPath:r.includes(s.sourceProjectId)&&r.includes(s.targetProjectId)})),[o,r]),l=d.useMemo(()=>I(t,i),[t,i]),j=d.useMemo(()=>c?A(c,x,t,i):[],[c,x,t,i]),w=d.useMemo(()=>t.filter(a=>a.status==="active"||a.status==="planning").map(a=>({id:a.id,name:a.name,isCritical:r.includes(a.id),incomingDeps:i.filter(n=>n.targetProjectId===a.id).length,outgoingDeps:i.filter(n=>n.sourceProjectId===a.id).length})),[t,r,i]);return t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[e.jsx(m,{size:64,className:"text-slate-300 dark:text-slate-600 mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"暂无项目数据"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"创建项目后即可查看跨项目依赖关系"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-3",children:[e.jsx(m,{className:"text-purple-600 dark:text-purple-400",size:32}),"跨项目依赖分析"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Cross-Project Dependency Analysis - 战略风险管理"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{size:20,className:"text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400 uppercase",children:"总依赖数"})]}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:l.totalDependencies})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{size:20,className:"text-red-600 dark:text-red-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400 uppercase",children:"关键路径依赖"})]}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:l.criticalDependencies})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(u,{size:20,className:"text-orange-600 dark:text-orange-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400 uppercase",children:"最受依赖项目"})]}),e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-slate-100 truncate",children:((g=l.mostDependentProject)==null?void 0:g.name)||"无"}),l.mostDependentProject&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:[l.mostDependentProject.count," 个依赖"]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(E,{size:20,className:"text-purple-600 dark:text-purple-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400 uppercase",children:"最阻塞项目"})]}),e.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-slate-100 truncate",children:((b=l.mostBlockingProject)==null?void 0:b.name)||"无"}),l.mostBlockingProject&&e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["阻塞 ",l.mostBlockingProject.count," 个项目"]})]})]}),r.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 rounded-xl shadow-sm border border-red-200 dark:border-red-800 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 flex items-center gap-2",children:[e.jsx(h,{className:"text-red-600 dark:text-red-400",size:20}),"全局关键路径"]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:r.map((s,a)=>{const n=t.find(D=>D.id===s);return n?e.jsxs(P.Fragment,{children:[e.jsxs("div",{className:"px-4 py-2 bg-white dark:bg-slate-800 rounded-lg border-2 border-red-500 shadow-sm",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:n.name}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:n.manager||"未分配"})]}),a<r.length-1&&e.jsx(k,{className:"text-red-600 dark:text-red-400",size:20})]},s):null})}),e.jsx("div",{className:"mt-4 p-3 bg-white/50 dark:bg-slate-900/50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(C,{size:16,className:"text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:[e.jsx("strong",{children:"关键路径"}),"是项目组合中最长的依赖链。任何关键路径上的项目延迟都会直接影响整个组合的完成时间。"]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4",children:"依赖网络图"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(s=>e.jsxs(N.div,{whileHover:{scale:1.02},className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${s.isCritical?"border-red-500 bg-red-50 dark:bg-red-900/20":"border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50"} ${c===s.id?"ring-2 ring-blue-500":""}`,onClick:()=>v(s.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:s.name}),s.isCritical&&e.jsx(h,{size:16,className:"text-red-600 dark:text-red-400 flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-600 dark:text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{size:12}),e.jsxs("span",{children:[s.incomingDeps," 入"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{size:12}),e.jsxs("span",{children:[s.outgoingDeps," 出"]})]})]})]},s.id))})]}),e.jsx(B,{children:c&&e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 flex items-center gap-2",children:[e.jsx(F,{className:"text-blue-600 dark:text-blue-400",size:20}),"延迟影响模拟"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"模拟延迟天数"}),e.jsx("input",{type:"number",value:x,onChange:s=>y(parseInt(s.target.value)||0),min:"1",max:"90",className:"w-32 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100"}),e.jsx("span",{className:"ml-2 text-sm text-slate-600 dark:text-slate-400",children:"天"})]}),j.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-3",children:["如果 ",e.jsx("strong",{children:(p=t.find(s=>s.id===c))==null?void 0:p.name})," 延迟 ",e.jsx("strong",{children:x})," 天，将影响以下项目："]}),j.map(s=>e.jsx("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.projectName}),e.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-400 mt-1",children:["原计划: ",new Date(s.originalEndDate).toLocaleDateString("zh-CN")," → 新计划: ",new Date(s.newEndDate).toLocaleDateString("zh-CN")]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:["+",s.delayDays," 天"]})})]})},s.projectId))]}):e.jsx("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800 text-center",children:e.jsx("p",{className:"text-sm text-green-700 dark:text-green-400",children:"✓ 该项目延迟不会影响其他项目"})})]})})]})},Q=()=>{const t=f();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-3",children:[e.jsx(m,{className:"text-purple-600 dark:text-purple-400",size:32}),"跨项目依赖分析"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Cross-Project Dependency Analysis - 识别项目间的关联和连锁风险"})]}),e.jsxs("button",{onClick:()=>M(t),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors",children:[e.jsx(R,{size:16}),"导出依赖分析"]})]}),e.jsx(T,{}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-xl shadow-sm border border-purple-200 dark:border-purple-800 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4",children:"使用指南"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"依赖类型"}),e.jsxs("ul",{className:"space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"完成-开始 (FS):"})," 项目A完成后项目B才能开始"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"开始-开始 (SS):"})," 两个项目同时开始"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"完成-完成 (FF):"})," 两个项目同时完成"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"资源依赖:"})," 共享相同的资源池"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"关键路径"}),e.jsxs("ul",{className:"space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"• 标记为红色边框的项目在关键路径上"}),e.jsx("li",{children:"• 关键路径上的任何延迟都会影响整体交付"}),e.jsx("li",{children:"• 优先关注关键路径上的项目"}),e.jsx("li",{children:"• 使用延迟模拟评估风险影响"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"延迟影响模拟"}),e.jsxs("ul",{className:"space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"1. 点击任意项目卡片"}),e.jsx("li",{children:"2. 设置模拟延迟天数"}),e.jsx("li",{children:"3. 查看受影响的下游项目"}),e.jsx("li",{children:"4. 评估连锁反应和风险"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"最佳实践"}),e.jsxs("ul",{className:"space-y-1 text-slate-700 dark:text-slate-300",children:[e.jsx("li",{children:"• 定期审查项目间依赖关系"}),e.jsx("li",{children:"• 识别并消除不必要的依赖"}),e.jsx("li",{children:"• 为关键路径项目预留缓冲时间"}),e.jsx("li",{children:"• 建立跨项目沟通机制"})]})]})]})]})]})};export{Q as default};
