import{r as m,j as e,B as v,c as j,E as y,T as h,w as k}from"./index-DJ7gcr39.js";import{a as w,b as z}from"./resourcePrediction-owZoTQTt.js";import{C as x,a as o,B as g}from"./Badge-D2vINjcr.js";import{A}from"./activity-DELHMbTo.js";import{Z as C}from"./zap-CRi3v1pK.js";import{R as L,C as R,X as E,Y as T,T as B}from"./generateCategoricalChart-3LnHQFA-.js";import{A as M,a as O}from"./AreaChart-BcmU72Z2.js";import{L as $}from"./Line-CnhX7gjC.js";import{F as D}from"./filter-C3u088DJ.js";const U=({projects:p,resourcePool:d})=>{const c=m.useMemo(()=>w(d,p,6),[p,d]),l=m.useMemo(()=>z(c,d),[c,d]),b=m.useMemo(()=>{const s={};return c.forEach(t=>{const r=d.find(a=>a.id===t.resourceId),i=(r==null?void 0:r.totalQuantity)||0;t.predictions.forEach(a=>{s[a.month]||(s[a.month]={month:a.month,predicted:0,capacity:0}),s[a.month].predicted+=a.predicted,s[a.month].capacity+=i})}),Object.values(s).sort((t,r)=>t.month.localeCompare(r.month))},[c,d]);return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-700",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(x,{className:"p-6 bg-gradient-to-br from-indigo-900 to-slate-900 text-white border-none shadow-xl lg:col-span-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg",children:e.jsx(v,{className:"text-indigo-400",size:24})}),e.jsx("h3",{className:"text-xl font-bold",children:"AI 资源风险预测引擎"})]}),e.jsxs("p",{className:"text-indigo-100/80 max-w-xl mb-6 leading-relaxed",children:["基于线性回归与移动平均算法，系统已对未来 6 个月的资源平衡进行了深度扫描。 预测显示 ",l.summary]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"bg-white/10 px-4 py-2 rounded-xl backdrop-blur-sm border border-white/10",children:[e.jsx("div",{className:"text-xs text-indigo-300 mb-1",children:"风险警告"}),e.jsxs("div",{className:"text-2xl font-bold flex items-center gap-2",children:[l.warnings.length,l.warnings.length>0&&e.jsx(j,{size:18,className:"text-amber-400"})]})]}),e.jsxs("div",{className:"bg-white/10 px-4 py-2 rounded-xl backdrop-blur-sm border border-white/10",children:[e.jsx("div",{className:"text-xs text-indigo-300 mb-1",children:"优化建议"}),e.jsx("div",{className:"text-2xl font-bold",children:l.opportunities.length})]}),e.jsxs("div",{className:"bg-white/10 px-4 py-2 rounded-xl backdrop-blur-sm border border-white/10",children:[e.jsx("div",{className:"text-xs text-indigo-300 mb-1",children:"预测置信度"}),e.jsx("div",{className:"text-2xl font-bold",children:"88.5%"})]})]})]}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(A,{className:"text-indigo-500/30 w-32 h-32"})})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs(x,{className:"p-4 bg-emerald-50 dark:bg-emerald-900/10 border-emerald-100 dark:border-emerald-800/20 h-full",children:[e.jsxs("h4",{className:"font-bold text-emerald-900 dark:text-emerald-400 mb-3 flex items-center gap-2",children:[e.jsx(C,{size:18}),"优化路径推荐"]}),e.jsxs("div",{className:"space-y-3",children:[l.opportunities.slice(0,3).map((s,t)=>e.jsxs("div",{className:"flex gap-2 text-sm text-emerald-800 dark:text-emerald-300/80",children:[e.jsx("div",{className:"mt-1 flex-shrink-0 animate-pulse bg-emerald-400 w-1.5 h-1.5 rounded-full"}),s]},t)),l.opportunities.length===0&&e.jsx("p",{className:"text-slate-500 text-sm",children:"暂未发现明显的资源冗余优化空间。"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(x,{className:"p-6 lg:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:"总体人力负载预测趋势 (6M)"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"未来半年总资源需求 vs 总可用容量"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-indigo-500"}),e.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"预测负载"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-slate-200"}),e.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"基准容量"})]})]})]}),e.jsx("div",{className:"h-[300px] w-full mt-4",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(M,{data:b,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorLoad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),e.jsx(R,{strokeDasharray:"3 3",vertical:!1,stroke:"#e2e8f0"}),e.jsx(E,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#64748b"},dy:10}),e.jsx(T,{axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#64748b"}}),e.jsx(B,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},cursor:{stroke:"#6366f1",strokeWidth:2}}),e.jsx(O,{type:"monotone",dataKey:"predicted",stroke:"#6366f1",strokeWidth:3,fillOpacity:1,fill:"url(#colorLoad)",name:"预测需求"}),e.jsx($,{type:"stepAfter",dataKey:"capacity",stroke:"#cbd5e1",strokeWidth:2,strokeDasharray:"5 5",dot:!1,name:"资源容量"})]})})})]}),e.jsxs(x,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center justify-between",children:["待处理风险项",e.jsx(o,{variant:"danger",children:l.warnings.length})]}),e.jsxs("div",{className:"space-y-4",children:[l.warnings.map((s,t)=>e.jsx("div",{className:"group p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-100 dark:border-slate-700 hover:border-red-200 dark:hover:border-red-900/50 transition-all cursor-pointer",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 text-red-600 rounded-lg",children:e.jsx(j,{size:18})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 leading-snug",children:s}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-slate-500 uppercase tracking-wider font-bold",children:"高优先级"}),e.jsxs(g,{variant:"ghost",size:"sm",className:"h-6 px-1 py-0 text-blue-600 hover:text-blue-700",children:["自动寻找替补 ",e.jsx(y,{size:12,className:"ml-1"})]})]})]})]})},t)),l.warnings.length===0&&e.jsxs("div",{className:"py-12 text-center text-slate-400",children:[e.jsx(h,{size:48,className:"mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"未来预测期内无显著负载风险"})]})]})]})]}),e.jsxs(x,{className:"p-6 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:"资源预测明细 (By Role)"}),e.jsx("p",{className:"text-sm text-slate-500",children:"分角色查看未来负载动态"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),e.jsx("input",{type:"text",placeholder:"搜索资源角色...",className:"pl-9 pr-4 py-2 border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all w-48"})]}),e.jsxs(g,{variant:"secondary",size:"sm",className:"h-9",children:[e.jsx(D,{size:16,className:"mr-2"})," 筛选"]})]})]}),e.jsx("div",{className:"overflow-x-auto -mx-6",children:e.jsxs("table",{className:"w-full text-left border-collapse min-w-[800px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-y border-slate-100 dark:border-slate-700",children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest",children:"资源角色"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest text-center",children:"当前余量"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest text-center",children:"未来趋势"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest",children:"未来 6 个月预估负载"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest text-right",children:"风险系数"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800/50",children:c.map(s=>{const t=d.find(n=>n.id===s.resourceId),r=0,i=(t==null?void 0:t.totalQuantity)||1,a=s.peakLoad/i*100;return e.jsxs("tr",{className:"hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100",children:s.resourceName}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Total Capacity: ",i]})]}),e.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium",children:e.jsx("span",{className:i-r>0?"text-emerald-600":"text-red-500",children:i-r})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex justify-center",children:s.trend==="increasing"?e.jsxs(o,{variant:"danger",className:"gap-1 animate-bounce",children:[e.jsx(h,{size:12})," 上升"]}):s.trend==="decreasing"?e.jsxs(o,{variant:"success",className:"gap-1",children:[e.jsx(h,{className:"rotate-180",size:12})," 下降"]}):e.jsx(o,{variant:"neutral",children:"稳定"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-end gap-1 h-12",children:s.predictions.map((n,f)=>{const N=n.predicted/(i*1.5)*100,u=n.predicted>i;return e.jsx("div",{title:`${n.month}: ${n.predicted} (Conf: ${n.confidence}%)`,className:`flex-1 min-w-[12px] rounded-t-sm transition-all duration-500 ${u?"bg-red-500 shadow-[0_-5px_10px_rgba(239,68,68,0.3)]":"bg-blue-400"}`,style:{height:`${Math.max(10,N)}%`}},f)})})}),e.jsxs("td",{className:"px-6 py-4 text-right",children:[e.jsxs("div",{className:`text-lg font-black ${a>100?"text-red-600":a>80?"text-amber-500":"text-slate-900 dark:text-slate-100"}`,children:[a.toFixed(0),"%"]}),e.jsx("div",{className:"text-[10px] text-slate-400 font-bold",children:"PEAK LOAD INDEX"})]})]},s.resourceId)})})]})})]})]})};export{U as R};
