import{e as ve,t as M,r as R,j as e,X as te,F as S,f as X,u as se,a as Ne,U as ae,g as ye,h as J,K as we,i as F,p as I,d as _}from"./index-B83_YXak.js";import{S as ke}from"./sparkles-CwxvfJur.js";import{G as De}from"./grip-vertical-BLIbIG2S.js";import{P as le}from"./pen-BcIEAH6T.js";import{P as Ce,a as Re}from"./PageHeader-BSDny0b_.js";import{B as Se,C as Q,a as Me}from"./Badge-3naow-O-.js";import{u as Pe}from"./usePMOStore-CtC-GJFk.js";import{C as qe}from"./calendar-CGNe2G8S.js";import{P as Ie}from"./plus-C9a8qCvh.js";import{e as B,s as Z}from"./startOfMonth-B4Aj1hNH.js";import{e as ze}from"./endOfDay-kQ9sVZS_.js";import{a as ee}from"./addMonths-DAG2PvW6.js";import{f as T}from"./format-Bp4-CsHB.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=ve("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);function L(m,f){const c=M(m),l=M(f),o=c.getTime()-l.getTime();return o<0?-1:o>0?1:o}function Oe(m,f){const c=M(m),l=M(f),o=c.getFullYear()-l.getFullYear(),u=c.getMonth()-l.getMonth();return o*12+u}function Ee(m){const f=M(m);return+ze(f)==+B(f)}function Fe(m,f){const c=M(m),l=M(f),o=L(c,l),u=Math.abs(Oe(c,l));let g;if(u<1)g=0;else{c.getMonth()===1&&c.getDate()>27&&c.setDate(30),c.setMonth(c.getMonth()-o*u);let j=L(c,l)===-o;Ee(M(m))&&u===1&&L(m,l)===1&&(j=!1),g=o*(u-Number(j))}return g===0?0:g}const Te=({templates:m,onSelect:f,onClose:c})=>{const[l,o]=R.useState(null),[u,g]=R.useState("all"),j=[{id:"all",label:"全部",icon:ke},{id:"web",label:"Web应用",icon:S},{id:"mobile",label:"移动应用",icon:S},{id:"data",label:"数据分析",icon:S},{id:"infrastructure",label:"基础设施",icon:S},{id:"custom",label:"自定义",icon:S}],k=u==="all"?m:m.filter(i=>i.category===u),D=()=>{f(l),c()},P=i=>({web:"from-blue-500 to-cyan-500",mobile:"from-purple-500 to-pink-500",data:"from-green-500 to-emerald-500",infrastructure:"from-orange-500 to-red-500",custom:"from-slate-500 to-gray-500"})[i]||"from-blue-500 to-purple-500";return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"选择项目模板"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"使用模板快速创建项目，或从空白项目开始"})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(te,{size:24,className:"text-slate-500"})})]}),e.jsx("div",{className:"flex gap-2 mt-4 overflow-x-auto pb-2",children:j.map(i=>{const w=i.icon;return e.jsxs("button",{onClick:()=>g(i.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap ${u===i.id?"bg-blue-600 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e.jsx(w,{size:16}),i.label]},i.id)})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"从头开始"}),e.jsx("div",{onClick:()=>o(null),className:`p-6 rounded-xl border-2 cursor-pointer transition-all ${l===null?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(S,{size:20,className:"text-slate-400"}),e.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100",children:"空白项目"})]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"创建一个全新的项目，自定义所有设置"})]}),l===null&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(X,{size:16,className:"text-white"})})]})})]}),k.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:["可用模板 (",k.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(i=>e.jsxs("div",{onClick:()=>o(i),className:`p-5 rounded-xl border-2 cursor-pointer transition-all ${(l==null?void 0:l.id)===i.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-lg":"border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700 hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${P(i.category)} flex items-center justify-center text-white shadow-lg`,children:e.jsx(S,{size:24})}),(l==null?void 0:l.id)===i.id&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(X,{size:16,className:"text-white"})})]}),e.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100 mb-2",children:i.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-3 line-clamp-2",children:i.description}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsxs("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded",children:[i.defaultDuration," 个月"]}),i.isBuiltIn&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded",children:"内置"})]})]},i.id))})]}),k.length===0&&u!=="all"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{size:48,className:"mx-auto text-slate-300 dark:text-slate-600 mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"该分类暂无模板"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:l?e.jsxs("span",{children:["已选择: ",e.jsx("strong",{className:"text-slate-700 dark:text-slate-300",children:l.name})]}):e.jsx("span",{children:"将创建空白项目"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:c,className:"px-6 py-2 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg font-medium transition-colors",children:"取消"}),e.jsx("button",{onClick:D,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors shadow-lg shadow-blue-600/20",children:"确认选择"})]})]})]})})},Ae=({onEditProject:m})=>{const{projects:f,updateProject:c}=se(),{t:l}=Ne(),[o,u]=R.useState(null),[g,j]=R.useState(null),k=[{id:"planning",label:l("projects.planning"),color:"bg-blue-100 text-blue-700",borderColor:"border-blue-400"},{id:"active",label:l("projects.active"),color:"bg-green-100 text-green-700",borderColor:"border-green-400"},{id:"on-hold",label:l("projects.onHold"),color:"bg-orange-100 text-orange-700",borderColor:"border-orange-400"},{id:"completed",label:l("projects.completed"),color:"bg-purple-100 text-purple-700",borderColor:"border-purple-400"}],D=(d,v)=>{u(v),d.dataTransfer.effectAllowed="move",d.target.style.opacity="0.5"},P=d=>{d.target.style.opacity="1",u(null),j(null)},i=(d,v)=>{d.preventDefault(),d.dataTransfer.dropEffect="move",j(v)},w=()=>{j(null)},A=(d,v)=>{if(d.preventDefault(),j(null),o&&o.status!==v){c(o.id,{status:v});const y=document.createElement("div");y.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in",y.textContent=`${o.name} moved to ${v}`,document.body.appendChild(y),setTimeout(()=>{y.remove()},2e3)}u(null)};return e.jsx("div",{className:"flex gap-6 overflow-x-auto pb-6",children:k.map(d=>{const v=f.filter(h=>h.status===d.id),y=g===d.id;return e.jsxs("div",{className:`min-w-[320px] rounded-2xl p-4 transition-all duration-200 ${y?`bg-blue-50 border-2 ${d.borderColor} shadow-lg scale-105`:"bg-slate-100/50 border-2 border-transparent"}`,onDragOver:h=>i(h,d.id),onDragLeave:w,onDrop:h=>A(h,d.id),children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("div",{className:`px-3 py-2 rounded-lg font-bold text-sm ${d.color}`,children:d.label}),e.jsx("span",{className:"text-sm text-slate-500 font-medium",children:v.length})]}),e.jsxs("div",{className:"space-y-3 min-h-[400px]",children:[v.map(h=>e.jsx("div",{draggable:!0,onDragStart:r=>D(r,h),onDragEnd:P,className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-all cursor-move group",children:e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(De,{size:16,className:"text-slate-400 mt-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm leading-tight",children:h.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${h.priority==="P0"?"bg-red-100 text-red-700":h.priority==="P1"?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:h.priority||"P2"}),e.jsx("span",{className:"text-xs font-bold bg-blue-50 text-blue-600 px-2 py-0.5 rounded",children:(h.score||0).toFixed(1)})]})]}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2 mb-3",children:h.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-slate-400",children:[e.jsx(ae,{size:12}),e.jsx("span",{children:(h.resourceRequirements||[]).reduce((r,b)=>r+b.count,0)})]}),e.jsxs("span",{className:"text-slate-400",children:["Rank #",h.rank]}),e.jsx("button",{onClick:r=>{r.stopPropagation(),m(h)},className:"p-1 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",children:e.jsx(le,{size:14})})]})]})]})},h.id)),v.length===0&&e.jsx("div",{className:`text-center py-12 rounded-xl border-2 border-dashed transition-colors ${y?"border-blue-400 bg-blue-50":"border-slate-200 bg-slate-50"}`,children:e.jsx("p",{className:"text-sm text-slate-400",children:l(y?"projects.dropHere":"projects.noProjects")})})]})]},d.id)})})},Ze=()=>{var U,K,Y,G,V,W;const{projects:m,addProject:f,deleteProject:c,updateProject:l,factorDefinitions:o,resourcePool:u,user:g}=se(),{environmentResources:j}=Pe(),k=ye(),[D,P]=R.useState("list"),[i,w]=R.useState(!1),[A,d]=R.useState(!1),[v,y]=R.useState(null),h=[{id:"web-app",name:"Web Application",description:"Standard web application development project with frontend and backend.",category:"web",defaultDuration:3,defaultFactors:{market:8,value:7,risk:6,roi:8,strategy:7,innovation:6,cost:5},defaultResources:[{count:2,duration:3,unit:"month",requiredSkills:["react","node"]},{count:1,duration:3,unit:"month",requiredSkills:["design"]}],isBuiltIn:!0,createdAt:new Date().toISOString()},{id:"mobile-app",name:"Mobile App",description:"iOS and Android mobile application development.",category:"mobile",defaultDuration:4,defaultFactors:{market:9,value:8,risk:5,roi:7,strategy:8,innovation:7,cost:6},defaultResources:[{count:2,duration:4,unit:"month",requiredSkills:["flutter"]},{count:1,duration:2,unit:"month",requiredSkills:["qa"]}],isBuiltIn:!0,createdAt:new Date().toISOString()},{id:"data-analytics",name:"Data Analytics Platform",description:"Big data processing and analytics dashboard.",category:"data",defaultDuration:6,defaultFactors:{market:7,value:9,risk:4,roi:9,strategy:9,innovation:8,cost:4},defaultResources:[{count:3,duration:6,unit:"month",requiredSkills:["python","sql"]},{count:1,duration:6,unit:"month",requiredSkills:["data-science"]}],isBuiltIn:!0,createdAt:new Date().toISOString()}],[r,b]=R.useState({name:"",description:"",status:"planning",priority:"P2",startDate:"",endDate:"",factors:{},resourceRequirements:[],milestones:[],environmentRequirements:[]}),re=()=>{const t={};return o.forEach(a=>t[a.id]=5),t},$=t=>{if(t){y(t.id);const a={...t.factors};o.forEach(s=>{a[s.id]===void 0&&(a[s.id]=5)}),b({...t,factors:a}),w(!0)}else d(!0)},ne=t=>{if(y(null),t){const a=new Date,s=ee(a,t.defaultDuration),x=t.defaultResources.map(N=>{var p;return{...N,resourceId:((p=u[0])==null?void 0:p.id)||""}}),n={id:Math.random().toString(36).substr(2,9),name:`${t.name} - ${T(a,"yyyyMMdd")}`,description:t.description,status:"planning",priority:"P2",startDate:T(a,"yyyy-MM-dd"),endDate:T(s,"yyyy-MM-dd"),factors:{...t.defaultFactors},resourceRequirements:x,score:0,milestones:[],costHistory:[],budget:0,actualCost:0};n.score=J(n.factors,o),f(n),d(!1),k(`/projects/${n.id}`)}else b({name:"",description:"",status:"planning",priority:"P2",startDate:"",endDate:"",factors:re(),resourceRequirements:[],milestones:[],environmentRequirements:[]}),d(!1),w(!0)},oe=t=>{t.preventDefault(),v?l(v,r):f({...r,id:Math.random().toString(36).substr(2,9),score:0,priority:r.priority||"P2"}),w(!1)},ie=()=>{b(t=>{var a;return{...t,resourceRequirements:[...t.resourceRequirements||[],{resourceId:((a=u[0])==null?void 0:a.id)||"",count:1,duration:1,unit:"month"}]}})},de=t=>{b(a=>{var s;return{...a,resourceRequirements:(s=a.resourceRequirements)==null?void 0:s.filter((x,n)=>n!==t)}})},O=(t,a,s)=>{b(x=>{var n;return{...x,resourceRequirements:(n=x.resourceRequirements)==null?void 0:n.map((N,p)=>p===t?{...N,[a]:s}:N)}})},ce=()=>{b(t=>({...t,milestones:[...t.milestones||[],{id:Math.random().toString(36).substr(2,9),name:"",date:"",completed:!1}]}))},xe=t=>{b(a=>{var s;return{...a,milestones:(s=a.milestones)==null?void 0:s.filter((x,n)=>n!==t)}})},H=(t,a,s)=>{b(x=>{var n;return{...x,milestones:(n=x.milestones)==null?void 0:n.map((N,p)=>p===t?{...N,[a]:s}:N)}})},me=()=>{b(t=>{var a,s;return{...t,environmentRequirements:[...t.environmentRequirements||[],{environmentId:((a=j[0])==null?void 0:a.id)||"",environmentName:((s=j[0])==null?void 0:s.name)||"",startDate:"",endDate:"",purpose:""}]}})},ue=t=>{b(a=>{var s;return{...a,environmentRequirements:(s=a.environmentRequirements)==null?void 0:s.filter((x,n)=>n!==t)}})},E=(t,a,s)=>{b(x=>{var n;return{...x,environmentRequirements:(n=x.environmentRequirements)==null?void 0:n.map((N,p)=>{if(p===t){if(a==="environmentId"){const C=j.find(z=>z.id===s);return{...N,environmentId:s,environmentName:(C==null?void 0:C.name)||""}}return{...N,[a]:s}}return N})}})},he=r.factors?J(r.factors,o):0;return e.jsxs(Ce,{children:[e.jsx(Re,{title:"Projects",description:"Manage and track all your projects",actions:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex bg-white dark:bg-slate-800 rounded-lg p-1 border border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsx("button",{onClick:()=>P("list"),className:`p-2 rounded-md transition-colors ${D==="list"?"bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-slate-100":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e.jsx($e,{size:20})}),e.jsx("button",{onClick:()=>P("kanban"),className:`p-2 rounded-md transition-colors ${D==="kanban"?"bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-slate-100":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e.jsx(we,{size:20})}),e.jsx("button",{onClick:()=>P("gantt"),className:`p-2 rounded-md transition-colors ${D==="gantt"?"bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-slate-100":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:e.jsx(qe,{size:20})})]}),(g==null?void 0:g.role)!=="user"&&e.jsx(Se,{onClick:()=>$(),variant:"primary",icon:Ie,children:"New Project"})]})}),D==="list"?e.jsx(Q,{padding:"none",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Rank"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Project Name"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Score"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Resources"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:m.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"w-8 h-8 rounded-lg bg-slate-100 text-slate-600 font-bold flex items-center justify-center",children:t.rank})}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-slate-900 cursor-pointer hover:text-blue-600",onClick:()=>k(`/projects/${t.id}`),children:t.name}),e.jsx("div",{className:"text-sm text-slate-500 truncate max-w-xs",children:t.description})]}),e.jsx("td",{className:"p-4",children:e.jsx(Me,{variant:t.status==="active"?"success":t.status==="planning"?"primary":"neutral",size:"sm",children:t.status.toUpperCase()})}),e.jsx("td",{className:"p-4 font-bold text-blue-600",children:(t.score||0).toFixed(2)}),e.jsx("td",{className:"p-4 text-sm text-slate-500",children:e.jsxs("div",{className:"flex items-center gap-1",title:"Total Headcount Required",children:[e.jsx(ae,{size:14}),(t.resourceRequirements||[]).reduce((a,s)=>a+s.count,0)," people"]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:(g==null?void 0:g.role)!=="user"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>$(t),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(le,{size:18})}),e.jsx("button",{onClick:()=>c(t.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(F,{size:18})})]})})})]},t.id))})]})}):D==="kanban"?e.jsx("div",{className:"overflow-x-auto pb-6",children:e.jsx(Ae,{onEditProject:$})}):e.jsx(Q,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-[1200px] pb-4",children:[e.jsxs("div",{className:"flex border-b border-slate-200 pb-2 mb-4",children:[e.jsx("div",{className:"w-48 shrink-0 font-bold text-slate-500",children:"Project"}),e.jsx("div",{className:"flex-1 flex relative h-6",children:(()=>{const t=m.filter(p=>p.startDate&&p.endDate);if(t.length===0)return e.jsx("div",{className:"text-sm text-slate-400",children:"No scheduled projects"});const a=t.map(p=>I(p.startDate).getTime()),s=t.map(p=>I(p.endDate).getTime()),x=Z(new Date(Math.min(...a))),n=B(new Date(Math.max(...s))),N=Fe(n,x)+1;return Array.from({length:N}).map((p,C)=>{const z=ee(x,C);return e.jsx("div",{className:"flex-1 text-xs text-slate-400 border-l border-slate-100 pl-1",children:T(z,"MMM yy")},C)})})()})]}),e.jsx("div",{className:"space-y-3",children:m.filter(t=>t.startDate&&t.endDate).map(t=>{const a=m.filter(q=>q.startDate&&q.endDate),s=a.map(q=>I(q.startDate).getTime()),x=a.map(q=>I(q.endDate).getTime()),n=Z(new Date(Math.min(...s))),N=B(new Date(Math.max(...x))),p=_(N,n)+1,C=I(t.startDate),z=I(t.endDate),be=_(C,n),pe=_(z,C),fe=be/p*100,ge=pe/p*100,je=t.status==="active"?"bg-green-500":t.status==="planning"?"bg-blue-500":t.status==="completed"?"bg-purple-500":"bg-orange-500";return e.jsxs("div",{className:"flex items-center group",children:[e.jsxs("div",{className:"w-48 shrink-0 pr-4",children:[e.jsx("div",{className:"font-medium text-sm text-slate-900 truncate",children:t.name}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Rank #",t.rank]})]}),e.jsx("div",{className:"flex-1 relative h-8 bg-slate-50 rounded-lg overflow-hidden",children:e.jsx("div",{className:`absolute top-1 bottom-1 rounded-md ${je} opacity-80 hover:opacity-100 transition-opacity cursor-pointer flex items-center px-2`,style:{left:`${fe}%`,width:`${ge}%`},onClick:()=>$(t),title:`${t.name}: ${t.startDate} to ${t.endDate}`,children:e.jsx("span",{className:"text-xs text-white font-bold truncate drop-shadow-md",children:t.name})})})]},t.id)})})]})})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:v?"Edit Project":"New Project"}),e.jsx("button",{onClick:()=>w(!1),className:"p-2 hover:bg-slate-100 rounded-full",children:e.jsx(te,{size:24})})]}),e.jsxs("form",{onSubmit:oe,className:"p-6 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Project Name"}),e.jsx("input",{required:!0,type:"text",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:r.name,onChange:t=>b({...r,name:t.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,value:r.description,onChange:t=>b({...r,description:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:r.startDate,onChange:t=>b({...r,startDate:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:r.endDate,onChange:t=>b({...r,endDate:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Status"}),e.jsxs("select",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:r.status,onChange:t=>b({...r,status:t.target.value}),children:[e.jsx("option",{value:"planning",children:"Planning"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"on-hold",children:"On Hold"}),e.jsx("option",{value:"completed",children:"Completed"})]})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Resource Requirements"}),e.jsx("button",{type:"button",onClick:ie,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Requirement"})]}),e.jsxs("div",{className:"space-y-3",children:[(U=r.resourceRequirements)==null?void 0:U.map((t,a)=>e.jsxs("div",{className:"flex gap-3 items-end bg-slate-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Resource"}),e.jsx("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.resourceId,onChange:s=>O(a,"resourceId",s.target.value),children:u.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Count"}),e.jsx("input",{type:"number",min:"1",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.count,onChange:s=>O(a,"count",parseInt(s.target.value))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Duration"}),e.jsx("input",{type:"number",min:"1",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.duration,onChange:s=>O(a,"duration",parseInt(s.target.value))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Unit"}),e.jsxs("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.unit,onChange:s=>O(a,"unit",s.target.value),children:[e.jsx("option",{value:"day",children:"Days"}),e.jsx("option",{value:"month",children:"Months"}),e.jsx("option",{value:"year",children:"Years"})]})]}),e.jsx("button",{type:"button",onClick:()=>de(a),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(F,{size:16})})]},a)),((K=r.resourceRequirements)==null?void 0:K.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No resources allocated yet."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Project Milestones"}),e.jsx("button",{type:"button",onClick:ce,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Milestone"})]}),e.jsxs("div",{className:"space-y-3",children:[(Y=r.milestones)==null?void 0:Y.map((t,a)=>e.jsxs("div",{className:"flex gap-3 items-end bg-slate-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Milestone Name"}),e.jsx("input",{type:"text",placeholder:"e.g. Design Review",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.name,onChange:s=>H(a,"name",s.target.value)})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.date,onChange:s=>H(a,"date",s.target.value)})]}),e.jsx("button",{type:"button",onClick:()=>xe(a),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(F,{size:16})})]},a)),((G=r.milestones)==null?void 0:G.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No milestones defined."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Environment Resources"}),e.jsx("button",{type:"button",onClick:me,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Environment"})]}),e.jsxs("div",{className:"space-y-3",children:[(V=r.environmentRequirements)==null?void 0:V.map((t,a)=>e.jsxs("div",{className:"flex flex-col gap-3 bg-slate-50 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Environment"}),e.jsxs("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.environmentId,onChange:s=>E(a,"environmentId",s.target.value),children:[j.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.type,")"]},s.id)),j.length===0&&e.jsx("option",{disabled:!0,children:"No environments available"})]})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Purpose"}),e.jsx("input",{type:"text",placeholder:"e.g. UAT Testing",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.purpose,onChange:s=>E(a,"purpose",s.target.value)})]}),e.jsx("button",{type:"button",onClick:()=>ue(a),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(F,{size:16})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Start Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.startDate,onChange:s=>E(a,"startDate",s.target.value)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"End Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.endDate,onChange:s=>E(a,"endDate",s.target.value)})]})]})]},a)),((W=r.environmentRequirements)==null?void 0:W.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No environment resources requested."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Scoring Factors"}),e.jsxs("div",{className:"bg-blue-50 text-blue-700 px-3 py-1 rounded-lg font-bold text-sm",children:["Predicted Score: ",he.toFixed(2)]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4",children:o.map(t=>{var a,s;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("label",{className:"font-medium text-slate-600",children:t.name}),e.jsx("span",{className:"font-bold text-blue-600",children:((a=r.factors)==null?void 0:a[t.id])||0})]}),e.jsx("input",{type:"range",min:"0",max:"10",step:"1",className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600",value:((s=r.factors)==null?void 0:s[t.id])||0,onChange:x=>b(n=>({...n,factors:{...n.factors,[t.id]:parseInt(x.target.value)}}))})]},t.id)})})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>w(!1),className:"px-6 py-3 rounded-xl text-slate-600 hover:bg-slate-100 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-700 shadow-lg shadow-blue-600/20 transition-colors",children:"Save Project"})]})]})]})}),A&&e.jsx(Te,{templates:h,onSelect:ne,onClose:()=>d(!1)})]})};export{Ze as default};
