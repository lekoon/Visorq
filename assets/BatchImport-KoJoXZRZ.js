import{e as q,u as V,a as B,r as p,j as e,y as _,C as A,b as H,X as W}from"./index-BGQIEupx.js";import{D as X}from"./download-Z7BLTVEL.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=q("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),Q=()=>{const{addProject:L,factorDefinitions:h}=V(),{t:s}=B(),N=p.useRef(null),[v,w]=p.useState(!1),[o,u]=p.useState(null),[y,f]=p.useState(!1),R=()=>{const t=["Name","Description","Status","Priority","Start Date","End Date",...h.map(m=>m.name)],r=["Sample Project","This is a sample project description","planning","P1","2025-01-01","2025-12-31",...h.map(()=>"5")],l=[t.join(","),r.join(",")].join(`
`),c=new Blob([l],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(c),n.download="project_import_template.csv",n.click()},F=t=>t.split(`
`).filter(l=>l.trim()).map(l=>l.split(",").map(c=>c.trim())),I=async t=>{var r;w(!0),u(null);try{const l=await t.text(),c=F(l);if(c.length<2)throw new Error("File is empty or invalid");const n=c[0],m=c.slice(1);let k=0,C=0;const D=[],b=n.findIndex(a=>a.toLowerCase().includes("name")),z=n.findIndex(a=>a.toLowerCase().includes("desc")),P=n.findIndex(a=>a.toLowerCase().includes("status")),O=n.findIndex(a=>a.toLowerCase().includes("priority")),T=n.findIndex(a=>a.toLowerCase().includes("start")),U=n.findIndex(a=>a.toLowerCase().includes("end"));for(let a=0;a<m.length;a++){const i=m[a],S=a+2;try{if(!i[b]||i[b].trim()==="")throw new Error(`Row ${S}: Name is required`);const d={};h.forEach((j,G)=>{const g=n.findIndex(x=>x===j.name);if(g!==-1&&i[g]){const x=parseInt(i[g]);d[j.id]=isNaN(x)?5:Math.min(10,Math.max(0,x))}else d[j.id]=5});const $={id:Math.random().toString(36).substr(2,9),name:i[b],description:i[z]||"",status:((r=i[P])==null?void 0:r.toLowerCase())||"planning",priority:i[O]||"P2",startDate:i[T]||"",endDate:i[U]||"",factors:d,score:0,resourceRequirements:[]};L($),k++}catch(d){C++,D.push(d instanceof Error?d.message:`Row ${S}: Unknown error`)}}u({success:k,failed:C,errors:D})}catch(l){u({success:0,failed:0,errors:[l instanceof Error?l.message:"Failed to parse file"]})}finally{w(!1)}},E=t=>{t.preventDefault(),f(!1);const r=t.dataTransfer.files;if(r.length>0){const l=r[0];l.type==="text/csv"||l.name.endsWith(".csv")?I(l):alert("Please upload a CSV file")}},M=t=>{const r=t.target.files;r&&r.length>0&&I(r[0])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:s("import.title")}),e.jsx("p",{className:"text-slate-500 mt-1",children:s("import.subtitle")})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Z,{className:"text-blue-600",size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:s("import.downloadTemplate")}),e.jsx("p",{className:"text-sm text-slate-600 mb-3",children:s("import.templateDescription")}),e.jsxs("button",{onClick:R,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg inline-flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(X,{size:16}),s("import.downloadCSV")]})]})]})}),e.jsxs("div",{className:`border-2 border-dashed rounded-2xl p-12 text-center transition-all ${y?"border-blue-400 bg-blue-50":"border-slate-300 bg-white hover:border-blue-400 hover:bg-blue-50/50"}`,onDragOver:t=>{t.preventDefault(),f(!0)},onDragLeave:()=>f(!1),onDrop:E,children:[e.jsx("input",{ref:N,type:"file",accept:".csv",onChange:M,className:"hidden"}),e.jsx(_,{className:"mx-auto text-slate-400 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:s(y?"import.dropFile":"import.uploadFile")}),e.jsx("p",{className:"text-slate-500 mb-4",children:s("import.dragOrClick")}),e.jsx("button",{onClick:()=>{var t;return(t=N.current)==null?void 0:t.click()},disabled:v,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:s(v?"import.importing":"import.selectFile")})]}),o&&e.jsx("div",{className:`rounded-2xl p-6 border-2 ${o.failed===0?"bg-green-50 border-green-200":"bg-orange-50 border-orange-200"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${o.failed===0?"bg-green-100":"bg-orange-100"}`,children:o.failed===0?e.jsx(A,{className:"text-green-600",size:24}):e.jsx(H,{className:"text-orange-600",size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:s("import.importComplete")}),e.jsxs("div",{className:"space-y-1 text-sm mb-3",children:[e.jsxs("p",{className:"text-green-700",children:["✓ ",o.success," ",s("import.projectsImported")]}),o.failed>0&&e.jsxs("p",{className:"text-orange-700",children:["✗ ",o.failed," ",s("import.projectsFailed")]})]}),o.errors.length>0&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-orange-200",children:[e.jsxs("h4",{className:"font-bold text-sm text-slate-900 mb-2",children:[s("import.errors"),":"]}),e.jsx("ul",{className:"text-xs text-slate-600 space-y-1 max-h-40 overflow-y-auto",children:o.errors.map((t,r)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(W,{size:12,className:"text-red-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:t})]},r))})]})]})]})}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-3",children:s("import.instructions")}),e.jsxs("ol",{className:"space-y-2 text-sm text-slate-600",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-blue-600",children:"1."}),e.jsx("span",{children:s("import.step1")})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-blue-600",children:"2."}),e.jsx("span",{children:s("import.step2")})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-blue-600",children:"3."}),e.jsx("span",{children:s("import.step3")})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold text-blue-600",children:"4."}),e.jsx("span",{children:s("import.step4")})]})]})]})]})};export{Q as default};
