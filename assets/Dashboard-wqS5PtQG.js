import{j as e,u as U,a as T,d as L,p as q,T as y,C as E,b as H,c as M,U as Q}from"./index-BISNuQBy.js";import{P as I,a as K}from"./PageHeader-il2G48Vi.js";import{C as b,B as G,a as w}from"./Badge-MXDmpC9W.js";import{D as O}from"./download-D6btnMdq.js";import{C as X}from"./clock-C8mGvBuz.js";import{D as Y}from"./dollar-sign-CCqXfiVs.js";import{R as C,C as V,X as J,Y as W,T as P,B as Z,a as D}from"./generateCategoricalChart-DIbPf4mY.js";import{B as _}from"./BarChart-DfGdk8tv.js";import{P as ee,a as te}from"./PieChart-BGhQupJ0.js";import{f as se}from"./format-WFOWXoZv.js";const h=({title:l,value:u,icon:a,iconColor:n="blue",trend:d,className:x=""})=>{const j={blue:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",green:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",orange:"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400",red:"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400",purple:"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400",slate:"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400"};return e.jsx(b,{className:x,padding:"md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-1",children:l}),e.jsx("p",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:u}),d&&e.jsxs("div",{className:`flex items-center gap-1 mt-2 text-sm ${d.isPositive?"text-green-600":"text-red-600"}`,children:[e.jsx("span",{children:d.isPositive?"↑":"↓"}),e.jsxs("span",{children:[Math.abs(d.value),"%"]})]})]}),e.jsx("div",{className:`p-3 rounded-lg ${j[n]}`,children:e.jsx(a,{size:24})})]})})},he=()=>{const{projects:l,resourcePool:u}=U(),{t:a}=T(),n=l.length,d=l.filter(t=>t.status==="active").length,x=l.filter(t=>t.status==="completed").length,j=l.length>0?(l.reduce((t,s)=>t+(s.score||0),0)/l.length).toFixed(1):"0",R=l.filter(t=>(t.score||0)>8).length,S=l.filter(t=>{if(!t.endDate||t.status==="completed")return!1;const s=L(q(t.endDate),new Date);return s<30&&s>0&&t.status==="active"}).length,g=u.reduce((t,s)=>t+s.totalQuantity,0),p=l.filter(t=>t.status==="active").reduce((t,s)=>t+(s.resourceRequirements||[]).reduce((r,i)=>r+i.count,0),0),v=g>0?(p/g*100).toFixed(1):"0",f=(()=>{if(l.length===0)return"0";const t=l.reduce((i,c)=>i+(c.score||0),0)/l.length,s=n>0?x/n*100:0,r=parseFloat(v);return((t*10+s+r)/3).toFixed(0)})(),F=[...l].sort((t,s)=>(s.score||0)-(t.score||0)).slice(0,5),N=l.map(t=>({name:t.name.length>10?t.name.substring(0,10)+"...":t.name,score:parseFloat((t.score||0).toFixed(1)),full:t})),k=[{name:a("projects.active"),value:d,color:"#10b981"},{name:a("projects.planning"),value:l.filter(t=>t.status==="planning").length,color:"#3b82f6"},{name:a("projects.onHold"),value:l.filter(t=>t.status==="on-hold").length,color:"#f59e0b"},{name:a("projects.completed"),value:x,color:"#8b5cf6"}].filter(t=>t.value>0),$=u.map(t=>{const s=l.filter(r=>r.status==="active").reduce((r,i)=>{const c=(i.resourceRequirements||[]).find(m=>m.resourceId===t.id);return r+(c?c.count:0)},0);return{name:t.name,total:t.totalQuantity,allocated:s,available:t.totalQuantity-s,utilization:(s/t.totalQuantity*100).toFixed(0)}}),z=()=>{const t=["Rank","Project Name","Status","Score","Start Date","End Date","Resources"],s=l.map(o=>[o.rank,o.name,o.status,(o.score||0).toFixed(2),o.startDate||"N/A",o.endDate||"N/A",(o.resourceRequirements||[]).reduce((A,B)=>A+B.count,0)]),r=[t.join(","),...s.map(o=>o.join(","))].join(`
`),i=new Blob([r],{type:"text/csv"}),c=window.URL.createObjectURL(i),m=document.createElement("a");m.href=c,m.download=`visorq-projects-${se(new Date,"yyyy-MM-dd")}.csv`,m.click()};return e.jsxs(I,{children:[e.jsx(K,{title:a("dashboard.title"),description:a("dashboard.subtitle"),actions:e.jsx(G,{onClick:z,variant:"primary",icon:O,children:a("common.export")})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[e.jsx(h,{title:a("dashboard.totalProjects"),value:n,icon:y,iconColor:"blue"}),e.jsx(h,{title:a("dashboard.active"),value:d,icon:X,iconColor:"green"}),e.jsx(h,{title:a("dashboard.completed"),value:x,icon:E,iconColor:"purple"}),e.jsx(h,{title:a("dashboard.avgScore"),value:j,icon:Y,iconColor:"orange"}),e.jsx(h,{title:a("dashboard.portfolioHealth"),value:`${f}%`,icon:H,iconColor:parseFloat(f)>70?"green":parseFloat(f)>50?"orange":"red"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-2xl border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(M,{className:"text-red-600",size:24}),e.jsx("h3",{className:"font-bold text-red-900",children:a("dashboard.atRisk")})]}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:S}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:a("dashboard.projectsDueSoon")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-6 rounded-2xl border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(y,{className:"text-yellow-600",size:24}),e.jsx("h3",{className:"font-bold text-yellow-900",children:a("dashboard.highPriority")})]}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:R}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:a("dashboard.scoreGt8")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-2xl border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Q,{className:"text-blue-600",size:24}),e.jsx("h3",{className:"font-bold text-blue-900",children:a("dashboard.resourceUtilization")})]}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[v,"%"]}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[p," / ",g," ",a("dashboard.allocated")]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:[e.jsxs(b,{className:"lg:col-span-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mb-6",children:a("dashboard.projectPriorityScores")}),e.jsx("div",{className:"h-80",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(_,{data:N,children:[e.jsx(V,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(J,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#64748b"}}),e.jsx(W,{axisLine:!1,tickLine:!1,tick:{fill:"#64748b"}}),e.jsx(P,{cursor:{fill:"#f8fafc"},contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),e.jsx(Z,{dataKey:"score",radius:[8,8,0,0],children:N.map((t,s)=>e.jsx(D,{fill:t.score>8?"#10b981":t.score>5?"#3b82f6":"#94a3b8"},`cell-${s}`))})]})})})]}),e.jsxs(b,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mb-6",children:a("dashboard.projectStatus")}),e.jsx("div",{className:"h-80",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(ee,{children:[e.jsx(te,{data:k,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:s})=>`${t} ${((s||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:k.map((t,s)=>e.jsx(D,{fill:t.color},`cell-${s}`))}),e.jsx(P,{})]})})})]})]}),e.jsxs(b,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mb-6",children:a("dashboard.resourceAllocationAnalysis")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 border-b border-slate-200 dark:border-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 text-left font-semibold text-slate-600 dark:text-slate-300",children:a("dashboard.resourceType")}),e.jsx("th",{className:"p-4 text-left font-semibold text-slate-600 dark:text-slate-300",children:a("dashboard.totalCapacity")}),e.jsx("th",{className:"p-4 text-left font-semibold text-slate-600 dark:text-slate-300",children:a("dashboard.allocated")}),e.jsx("th",{className:"p-4 text-left font-semibold text-slate-600 dark:text-slate-300",children:a("dashboard.available")}),e.jsx("th",{className:"p-4 text-left font-semibold text-slate-600 dark:text-slate-300",children:a("dashboard.utilization")}),e.jsx("th",{className:"p-4 text-left font-semibold text-slate-600 dark:text-slate-300",children:a("dashboard.status")})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:$.map(t=>{const s=parseFloat(t.utilization);return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e.jsx("td",{className:"p-4 font-medium text-slate-900 dark:text-slate-100",children:t.name}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-300",children:t.total}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-300",children:t.allocated}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-300",children:t.available}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-slate-200 dark:bg-slate-600 rounded-full h-2 max-w-[100px]",children:e.jsx("div",{className:`h-2 rounded-full ${s>90?"bg-red-500":s>70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(s,100)}%`}})}),e.jsxs("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:[t.utilization,"%"]})]})}),e.jsx("td",{className:"p-4",children:e.jsx(w,{variant:s>90?"danger":s>70?"warning":"success",rounded:"full",children:s>90?a("dashboard.overloaded"):s>70?a("dashboard.high"):a("dashboard.healthy")})})]},t.name)})})]})})]}),e.jsxs(b,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mb-6",children:a("dashboard.topPriorityProjects")}),e.jsx("div",{className:"space-y-4",children:F.map((t,s)=>{var r;return e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 rounded-xl transition-colors border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center text-sm font-bold ${s===0?"bg-yellow-100 text-yellow-700 ring-2 ring-yellow-300":s===1?"bg-slate-200 text-slate-600":s===2?"bg-orange-100 text-orange-600":"bg-slate-100 text-slate-600"}`,children:["#",s+1]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 dark:text-slate-100",children:t.name}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[(r=t.description)==null?void 0:r.substring(0,60),"..."]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:a("projects.score")}),e.jsx("p",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:(t.score||0).toFixed(2)})]}),e.jsx(w,{variant:t.status==="active"?"success":t.status==="planning"?"primary":"neutral",rounded:"default",children:t.status.toUpperCase()})]})]},t.id)})})]})]})};export{he as default};
