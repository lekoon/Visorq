import{r as N,j as e,U as g,c as b,g as R,u as q,T as v,F as D,C as P}from"./index-dM0Tvs4N.js";import{u as E}from"./usePMOStore-BiIJQHja.js";import{C as r}from"./Card-JAsBu9KK.js";import{a as k,B as h}from"./Badge-DIArKf6A.js";import{C as M}from"./calendar-D3hcN0HO.js";import{G as f}from"./git-branch-Bo_dfj-z.js";const I=({projects:n,resources:x})=>{const d=N.useMemo(()=>{const a=new Map;return x.forEach(l=>{const o=[];let t=0;n.forEach(i=>{var m;if(i.status!=="active")return;const s=(m=i.resourceAllocations)==null?void 0:m.find(j=>j.resourceId===l.id);s&&(o.push({projectId:i.id,projectName:i.name,allocation:s.hoursPerWeek||40,startDate:i.startDate,endDate:i.endDate}),t+=s.hoursPerWeek||40)}),t>40&&a.set(l.id,{resourceId:l.id,resourceName:l.name,conflictingProjects:o,totalAllocation:t,overallocation:t-40})}),Array.from(a.values())},[n,x]);return d.length===0?e.jsx(r,{className:"p-6 bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900 dark:text-green-100",children:"æ— èµ„æºå†²çª"}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:"å½“å‰æ‰€æœ‰èµ„æºåˆ†é…å‡åœ¨åˆç†èŒƒå›´å†…"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(b,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:["æ£€æµ‹åˆ° ",d.length," ä¸ªèµ„æºå†²çª"]})]}),d.map(a=>e.jsxs(r,{className:"p-4 bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg",children:e.jsx(g,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-900 dark:text-red-100",children:a.resourceName}),e.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300",children:["æ€»åˆ†é…: ",a.totalAllocation,"h/å‘¨ (è¶…å‡º ",a.overallocation,"h)"]})]})]}),e.jsxs(k,{variant:"danger",children:[Math.round(a.overallocation/40*100),"% è¶…è½½"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-red-800 dark:text-red-200 mb-2",children:"å†²çªé¡¹ç›®:"}),a.conflictingProjects.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-slate-800 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm text-slate-900 dark:text-slate-100",children:l.projectName})]}),e.jsxs("span",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:[l.allocation,"h/å‘¨"]})]},l.projectId))]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-red-200 dark:border-red-800",children:e.jsx("p",{className:"text-xs text-red-700 dark:text-red-300",children:"ğŸ’¡ å»ºè®®: è°ƒæ•´é¡¹ç›®ä¼˜å…ˆçº§æˆ–å¢åŠ èµ„æºä»¥è§£å†³å†²çª"})})]},a.resourceId))]})},O=()=>{const n=R(),{projects:x}=q(),{changeRequests:d,environmentResources:a,requirements:l,simulations:o}=E(),t=N.useMemo(()=>{const s=x.filter(c=>c.status==="active"),m=x.length,j=x.filter(c=>c.status==="completed").length,w=d.filter(c=>c.status==="pending").length,y=d.length,p=l.length,u=l.filter(c=>c.status==="completed").length,C=a.filter(c=>c.status==="available").length;return{activeProjects:s.length,totalProjects:m,completedProjects:j,completionRate:m>0?j/m*100:0,pendingChangeRequests:w,totalChangeRequests:y,totalRequirements:p,completedRequirements:u,requirementCompletionRate:p>0?u/p*100:0,availableEnvironments:C,totalEnvironments:a.length,totalSimulations:o.length}},[x,d,l,a,o]),i=N.useMemo(()=>[...d].sort((s,m)=>new Date(m.requestDate).getTime()-new Date(s.requestDate).getTime()).slice(0,5),[d]);return e.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"PMO æˆ˜ç•¥ç®¡æ§ä¸­å¿ƒ"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"é¡¹ç›®ç»„åˆç®¡ç†ã€èŒƒå›´é˜²å¾¡ã€èµ„æºå†²çªç®¡æ§ä¸€ç«™å¼å¹³å°"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{onClick:()=>n("/projects"),className:"cursor-pointer",children:e.jsx(r,{className:"p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx(f,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"æ´»è·ƒé¡¹ç›®"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:t.activeProjects}),e.jsxs("p",{className:"text-xs text-slate-500",children:["æ€»è®¡ ",t.totalProjects," ä¸ªé¡¹ç›®"]})]})]})})}),e.jsx(r,{className:"p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:e.jsx(v,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"å¾…å®¡æ‰¹å˜æ›´"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:t.pendingChangeRequests}),e.jsxs("p",{className:"text-xs text-slate-500",children:["æ€»è®¡ ",t.totalChangeRequests," ä¸ªå˜æ›´"]})]})]})}),e.jsx(r,{className:"p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(D,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"éœ€æ±‚å®Œæˆç‡"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[t.requirementCompletionRate.toFixed(0),"%"]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[t.completedRequirements," / ",t.totalRequirements]})]})]})}),e.jsx("div",{onClick:()=>n("/environments"),className:"cursor-pointer",children:e.jsx(r,{className:"p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(g,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"å¯ç”¨ç¯å¢ƒ"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:t.availableEnvironments}),e.jsxs("p",{className:"text-xs text-slate-500",children:["æ€»è®¡ ",t.totalEnvironments," ä¸ªç¯å¢ƒ"]})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"æœ€è¿‘å˜æ›´è¯·æ±‚"}),e.jsx(h,{variant:"ghost",size:"sm",children:"æŸ¥çœ‹å…¨éƒ¨"})]}),e.jsx("div",{className:"space-y-3",children:i.length>0?i.map(s=>e.jsx("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm",children:s.title}),e.jsx(k,{variant:s.status==="approved"?"success":s.status==="rejected"?"danger":"warning",size:"sm",children:s.status})]}),e.jsxs("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:[s.projectName," â€¢ ",new Date(s.requestDate).toLocaleDateString()]}),e.jsxs("div",{className:"flex gap-3 mt-1 text-xs text-slate-500",children:[e.jsxs("span",{children:["+",s.estimatedEffortHours,"h"]}),e.jsxs("span",{children:["+Â¥",s.estimatedCostIncrease]}),e.jsxs("span",{children:["+",s.scheduleImpactDays,"å¤©"]})]})]})},s.id)):e.jsx("div",{className:"text-center py-8 text-slate-400",children:"æš‚æ— å˜æ›´è¯·æ±‚"})})]}),e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:"èµ„æºå†²çªæ£€æµ‹"}),e.jsx(I,{projects:x,resources:[]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:"å¿«é€Ÿæ“ä½œ"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(h,{onClick:()=>n("/simulation"),variant:"primary",className:"w-full justify-start",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"What-If æ²™ç›˜æ¨æ¼”"]}),e.jsxs(h,{onClick:()=>n("/environments"),variant:"secondary",className:"w-full justify-start",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"ç¯å¢ƒèµ„æºç®¡ç†"]}),e.jsxs(h,{onClick:()=>n("/portfolio"),variant:"secondary",className:"w-full justify-start",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"é¡¹ç›®ç»„åˆè§†å›¾"]}),e.jsxs(h,{onClick:()=>n("/dependencies"),variant:"secondary",className:"w-full justify-start",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"ä¾èµ–å…³ç³»åˆ†æ"]})]})]}),e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",children:"ç³»ç»ŸçŠ¶æ€"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:"é¡¹ç›®å®Œæˆç‡"}),e.jsxs("span",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:[t.completionRate.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all",style:{width:`${t.completionRate}%`}})}),e.jsx("div",{className:"pt-3 border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(P,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"ç³»ç»Ÿè¿è¡Œæ­£å¸¸"})]})})]})]})]})]})]})})};export{O as default};
