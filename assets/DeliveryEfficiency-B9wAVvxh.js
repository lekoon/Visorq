import{d as P,r as j,j as e,c as W,f as I,ab as _,T as k,R as Q,b1 as G,i as K,X,Y as V,b2 as Y,k as Z,b3 as q,m as H,E as J,a5 as ee,b4 as C,ap as U,g as D,b as O,p as M,_ as T,at as se,s as E,ar as te,as as le,aj as ae,D as ie,a2 as re,al as ne,aq as de}from"./index-BvQyAdiV.js";import{C as ce}from"./chevron-down-D8exDbX1.js";import{C as oe}from"./chevron-right-DFoHNZMg.js";import{A as xe}from"./arrow-down-right-6cuIY2cT.js";import{S as $}from"./shield-alert-B0YzzqUT.js";import{L as B}from"./lightbulb-Dk4uKlMX.js";import{T as me}from"./target-EwM4tyRW.js";function he(i){return u=>{const n=Math.trunc,l=n(u);return l===0?0:l}}function ue(i,u,n){const l=P(i,u)/7;return he()(l)}const ge=({metrics:i,timeRange:u})=>{const n=j.useMemo(()=>i.map(a=>({name:a.projectName,throughput:a.throughput,leadTime:a.leadTime,granularity:a.granularity,utilization:a.resourceUtilization,size:Math.max(100,Math.min(1e3,a.projectSize/10)),status:a.status})),[i]),l=a=>a>95?"#EF4444":a>85?"#F59E0B":a>=70?"#10B981":a>=50?"#3B82F6":"#94A3B8",h=j.useMemo(()=>{if(i.length===0)return null;const a=i.reduce((m,d)=>m+d.throughput,0)/i.length,s=i.reduce((m,d)=>m+d.leadTime,0)/i.length,c=i.reduce((m,d)=>m+d.resourceUtilization,0)/i.length,x=i.filter(m=>m.status==="efficient").length,t=i.filter(m=>m.status==="critical").length,o=i.filter(m=>m.status==="warning").length;return{avgThroughput:a,avgLeadTime:s,avgUtilization:c,efficientCount:x,criticalCount:t,warningCount:o}},[i]),r=({active:a,payload:s})=>{if(a&&s&&s.length){const c=s[0].payload;return e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg border border-slate-200",children:[e.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:c.name}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-slate-600",children:"吞吐量:"}),e.jsxs("span",{className:"font-medium",children:[c.throughput.toFixed(2)," 事务/周"]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-slate-600",children:"前置时间:"}),e.jsxs("span",{className:"font-medium",children:[c.leadTime.toFixed(0)," 天"]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-slate-600",children:"任务颗粒度:"}),e.jsxs("span",{className:"font-medium",children:[c.granularity.toFixed(0)," 人天"]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-slate-600",children:"资源利用率:"}),e.jsxs("span",{className:`font-medium ${c.utilization>90?"text-red-600":c.utilization>80?"text-orange-600":c.utilization>=70?"text-green-600":"text-blue-600"}`,children:[c.utilization.toFixed(1),"%"]})]})]})]})}return null};return h?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(W,{className:"text-green-600",size:20})}),e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"高效项目"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:h.efficientCount}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"运行良好"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(I,{className:"text-yellow-600",size:20})}),e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"预警项目"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:h.warningCount}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"需要关注"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(_,{className:"text-red-600",size:20})}),e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"临界项目"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:h.criticalCount}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"紧急处理"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl p-5 shadow-lg text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(k,{size:20})}),e.jsx("span",{className:"text-sm font-medium",children:"平均吞吐量"})]}),e.jsx("div",{className:"text-3xl font-bold",children:h.avgThroughput.toFixed(1)}),e.jsx("div",{className:"text-xs text-blue-100 mt-1",children:"事务/周"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"项目效率三维分析"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"气泡大小代表项目规模，颜色代表资源利用率"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-slate-600",children:"超负荷 (>95%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),e.jsx("span",{className:"text-slate-600",children:"高负荷 (85-95%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-slate-600",children:"合理 (70-85%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-slate-600",children:"正常 (50-70%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-400"}),e.jsx("span",{className:"text-slate-600",children:"低负荷 (<50%)"})]})]})]}),e.jsx("div",{className:"h-[500px]",children:e.jsx(Q,{width:"100%",height:"100%",children:e.jsxs(G,{margin:{top:20,right:20,bottom:60,left:60},children:[e.jsx(K,{strokeDasharray:"3 3",stroke:"#E2E8F0"}),e.jsx(X,{type:"number",dataKey:"throughput",name:"吞吐量",unit:" 事务/周",tick:{fill:"#64748B",fontSize:12},label:{value:"事务吞吐量 (事务/周)",position:"bottom",offset:40,style:{fill:"#475569",fontWeight:600}}}),e.jsx(V,{type:"number",dataKey:"leadTime",name:"前置时间",unit:" 天",tick:{fill:"#64748B",fontSize:12},label:{value:"前置时间 (天, P85)",angle:-90,position:"left",offset:40,style:{fill:"#475569",fontWeight:600}}}),e.jsx(Y,{type:"number",dataKey:"size",range:[100,1e3],name:"项目规模"}),e.jsx(Z,{content:e.jsx(r,{}),cursor:{strokeDasharray:"3 3"}}),e.jsx(q,{name:"项目",data:n,fillOpacity:.7,children:n.map((a,s)=>e.jsx(H,{fill:l(a.utilization)},`cell-${s}`))}),e.jsx("line",{x1:"0",y1:h.avgLeadTime,x2:"100%",y2:h.avgLeadTime,stroke:"#94A3B8",strokeDasharray:"5 5",strokeWidth:1})]})})}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl border border-blue-200",children:[e.jsxs("h4",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(I,{size:18}),"解读指南"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"理想区域:"})," 高吞吐量 + 低前置时间 + 合理利用率 (70-85%)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"优化目标:"})," 将项目从右上角(低效)移向左下角(高效)"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"红色警示:"})," 资源利用率超过95%，存在过载风险"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"气泡大小:"})," 越大表示项目规模越大，需要更多关注"]})]})]})]})]}):e.jsx("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-slate-200 text-center",children:e.jsx("p",{className:"text-slate-500",children:"暂无数据"})})},pe=({projects:i,resourcePool:u,metrics:n})=>{const[l,h]=j.useState("all"),[r,a]=j.useState(null),s=j.useMemo(()=>{const t=new Set;return u.forEach(o=>{o.name.includes("开发")||o.name.includes("Dev")?t.add("人力资源"):o.name.includes("服务器")||o.name.includes("Server")?t.add("物料资源"):o.name.includes("测试")||o.name.includes("Test")?t.add("人力资源"):t.add("其他资源")}),Array.from(t)},[u]),c=j.useMemo(()=>i.filter(t=>t.status==="active").map(t=>{const o=n.find(g=>g.projectId===t.id),m=o?o.throughput:0,d={};return s.forEach(g=>{let p=0,N=0;(t.resourceRequirements||[]).forEach(z=>{const b=u.find(w=>w.id===z.resourceId);if(b){let w="其他资源";b.name.includes("开发")||b.name.includes("Dev")?w="人力资源":b.name.includes("服务器")||b.name.includes("Server")?w="物料资源":(b.name.includes("测试")||b.name.includes("Test"))&&(w="人力资源"),(w===g||g==="all")&&(p+=z.count,N+=b.totalQuantity)}}),d[g]={used:p,total:N,percentage:N>0?p/N*100:0}}),{id:t.id,name:t.name,efficiencyScore:m,resourceUtilization:d,metric:o}}).sort((t,o)=>t.efficiencyScore-o.efficiencyScore),[i,u,n,s]),x=(t,o)=>{let m="bg-slate-100",d="text-slate-600";t>90?(m="bg-red-100",d="text-red-700"):t>85?(m="bg-yellow-100",d="text-yellow-700"):t>=75&&(m="bg-green-100",d="text-green-700");const g=Math.min(10,Math.max(0,o)),p=g<2?"h-24":g<5?"h-20":"h-16";return{className:`${m} ${d} ${p} transition-all duration-300 hover:brightness-95 cursor-pointer relative group`,percentage:t}};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"资源-效率关联分析矩阵"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"交叉分析资源投入与产出效率，单元格越大代表效率越低"})]}),e.jsx("div",{className:"flex gap-2",children:s.map(t=>e.jsx("button",{onClick:()=>h(t===l?"all":t),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${l===t?"bg-blue-100 text-blue-700 border border-blue-200":"bg-slate-50 text-slate-600 border border-slate-200 hover:bg-slate-100"}`,children:t},t))})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider w-64",children:"项目名称 / 效率"}),s.filter(t=>l==="all"||l===t).map(t=>e.jsxs("th",{className:"px-6 py-4 text-center text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[t,"利用率"]},t)),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-slate-500 uppercase tracking-wider w-32",children:"关联影响"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map(t=>{var m,d;const o=r===t.id;return e.jsxs(J.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>a(o?null:t.id),className:"text-slate-400 hover:text-blue-600",children:o?e.jsx(ce,{size:16}):e.jsx(oe,{size:16})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900",children:t.name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${t.efficiencyScore<2?"bg-red-100 text-red-700":t.efficiencyScore<5?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:["效率: ",t.efficiencyScore.toFixed(1)]})})]})]})}),s.filter(g=>l==="all"||l===g).map(g=>{const p=t.resourceUtilization[g],N=x(p.percentage,t.efficiencyScore);return e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:`w-full h-full rounded-lg flex flex-col items-center justify-center ${N.className}`,children:[e.jsxs("span",{className:"text-lg font-bold",children:[p.percentage.toFixed(0),"%"]}),e.jsxs("span",{className:"text-xs opacity-75",children:[p.used,"/",p.total]}),e.jsxs("div",{className:"absolute opacity-0 group-hover:opacity-100 bottom-full mb-2 bg-slate-900 text-white text-xs p-2 rounded shadow-lg pointer-events-none z-10 w-48 text-center transition-opacity",children:[p.percentage>90?"⚠️ 资源严重过载，建议立即调整":p.percentage>85?"⚠️ 资源接近饱和":"✅ 资源分配在合理区间",e.jsx("div",{className:"border-t border-slate-700 mt-1 pt-1",children:"点击查看详细分配"})]})]})},g)}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[t.metric&&t.metric.leadTime>45&&e.jsxs("div",{className:"flex flex-col items-center text-red-600",children:[e.jsx(xe,{size:20}),e.jsx("span",{className:"text-xs font-medium mt-1",children:"延期风险高"})]}),t.metric&&t.metric.leadTime<=45&&e.jsxs("div",{className:"flex flex-col items-center text-green-600",children:[e.jsx("span",{className:"text-2xl",children:"-"}),e.jsx("span",{className:"text-xs font-medium",children:"影响可控"})]})]})]}),o&&e.jsx("tr",{className:"bg-slate-50",children:e.jsx("td",{colSpan:s.length+2,className:"px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200",children:[e.jsxs("h4",{className:"font-bold text-slate-800 mb-3 flex items-center gap-2",children:[e.jsx(ee,{size:16,className:"text-blue-500"}),"资源瓶颈分析"]}),e.jsxs("p",{className:"text-sm text-slate-600",children:["当前项目主要受限于 ",e.jsx("strong",{children:"人力资源"}),"，导致前置时间延长约 15%。 建议增加 2 名高级开发人员。"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200",children:[e.jsx("h4",{className:"font-bold text-slate-800 mb-3",children:"效率预测"}),e.jsxs("div",{className:"flex justify-between items-center text-sm mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"当前前置时间:"}),e.jsxs("span",{className:"font-medium",children:[(m=t.metric)==null?void 0:m.leadTime.toFixed(0)," 天"]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"优化后预计:"}),e.jsxs("span",{className:"font-medium text-green-600",children:[(((d=t.metric)==null?void 0:d.leadTime)||0)*.85," 天 (-15%)"]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200",children:[e.jsx("h4",{className:"font-bold text-slate-800 mb-3",children:"关联项目影响"}),e.jsxs("p",{className:"text-sm text-slate-600",children:["资源调整可能影响 ",e.jsx("strong",{children:"Project Alpha"})," 的进度。"]})]})]})})})]},t.id)})})]})}),e.jsxs("div",{className:"bg-slate-50 p-4 border-t border-slate-200 flex justify-center gap-8 text-xs text-slate-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-100 border border-green-200 rounded"}),e.jsx("span",{children:"合理 (75%-85%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-100 border border-yellow-200 rounded"}),e.jsx("span",{children:"饱和 (85%-90%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-100 border border-red-200 rounded"}),e.jsx("span",{children:"过高 (>90%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-8 w-4 border border-slate-300 border-dashed rounded"}),e.jsx("span",{children:"高度越大 = 效率越低"})]})]})]})},be=({metrics:i,resourcePool:u})=>{const n=j.useMemo(()=>{const r=[];return i.forEach(s=>{s.resourceUtilization>90?r.push({id:`res-${s.projectId}`,type:"resource",level:"critical",title:`资源严重过载: ${s.projectName}`,message:`当前资源利用率 ${s.resourceUtilization.toFixed(1)}%，已超过红色警戒线 (90%)`,impact:`预计导致项目前置时间延长 ${(s.leadTime*.2).toFixed(1)} 天`,suggestion:"建议立即增加资源或暂停非关键任务",timestamp:new Date().toISOString()}):s.resourceUtilization>85&&r.push({id:`res-${s.projectId}`,type:"resource",level:"warning",title:`资源高负荷: ${s.projectName}`,message:`当前资源利用率 ${s.resourceUtilization.toFixed(1)}%，接近饱和状态`,impact:"可能导致交付延迟风险增加",suggestion:"建议密切监控，准备备用资源",timestamp:new Date().toISOString()})}),i.forEach(s=>{s.leadTime>60&&r.push({id:`eff-${s.projectId}`,type:"efficiency",level:"critical",title:`交付周期异常: ${s.projectName}`,message:`当前前置时间 ${s.leadTime.toFixed(0)} 天，远超平均水平`,impact:"严重影响整体交付吞吐量",suggestion:"建议进行流程诊断，消除阻塞环节",timestamp:new Date().toISOString()})}),u.filter(s=>(s.name.includes("Server")||s.name.includes("License"))&&s.totalQuantity<2).forEach(s=>{r.push({id:`stock-${s.id}`,type:"stock",level:"warning",title:`关键资源库存不足: ${s.name}`,message:`剩余可用数量仅为 ${s.totalQuantity}`,impact:"可能导致新项目无法启动",suggestion:"建议立即采购或释放闲置资源",timestamp:new Date().toISOString()})}),r.sort((s,c)=>s.level==="critical"?-1:1)},[i,u]),l=r=>{switch(r){case"critical":return"bg-red-50 border-red-200 text-red-900";case"warning":return"bg-orange-50 border-orange-200 text-orange-900";default:return"bg-blue-50 border-blue-200 text-blue-900"}},h=(r,a)=>{const s=a==="critical"?"text-red-600":"text-orange-600";switch(r){case"resource":return e.jsx($,{className:s,size:24});case"efficiency":return e.jsx(O,{className:s,size:24});case"stock":return e.jsx(D,{className:s,size:24});default:return e.jsx(C,{className:s,size:24})}};return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"text-slate-900"}),n.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"})]}),"实时监控预警"]}),e.jsxs("span",{className:"text-sm text-slate-500",children:["共发现 ",n.length," 个异常项"]})]}),n.length===0?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($,{className:"text-green-600",size:32})}),e.jsx("h4",{className:"text-lg font-bold text-green-900",children:"系统运行正常"}),e.jsx("p",{className:"text-green-700 mt-2",children:"各项指标均在合理区间内，未发现异常。"})]}):e.jsx("div",{className:"space-y-4",children:n.map(r=>e.jsx("div",{className:`p-6 rounded-2xl border ${l(r.level)} shadow-sm transition-transform hover:scale-[1.01]`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-white/60 rounded-xl backdrop-blur-sm",children:h(r.type,r.level)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"font-bold text-lg",children:r.title}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide ${r.level==="critical"?"bg-red-200 text-red-800":"bg-orange-200 text-orange-800"}`,children:r.level==="critical"?"红色预警":"黄色预警"})]}),e.jsx("p",{className:"mt-2 font-medium opacity-90",children:r.message}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-bold uppercase opacity-60 mb-1",children:"效率影响"}),e.jsxs("div",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(k,{size:16}),r.impact]})]}),e.jsxs("div",{className:"bg-white/50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs font-bold uppercase opacity-60 mb-1",children:"建议行动"}),e.jsxs("div",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(U,{size:16}),r.suggestion]})]})]})]})]})},r.id))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-slate-200",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"动态阈值监控"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"人力资源阈值"}),e.jsx("span",{className:"font-bold text-slate-900",children:"85% (动态调整中)"})]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 w-[85%] relative",children:e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-white"})})}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"基于 DWAFE 模型自动计算"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"物料库存阈值"}),e.jsx("span",{className:"font-bold text-slate-900",children:"20% (固定)"})]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500 w-[20%]"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"Bay间资源阈值"}),e.jsx("span",{className:"font-bold text-slate-900",children:"90% (动态调整中)"})]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 w-[90%]"})})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-6 text-white shadow-lg",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"紧急响应中心"}),e.jsx("p",{className:"text-slate-300 text-sm mb-6",children:"针对当前的红色预警，系统推荐以下一键处理方案："}),e.jsxs("button",{className:"w-full py-3 bg-red-600 hover:bg-red-700 rounded-xl font-bold transition-colors mb-3 flex items-center justify-center gap-2",children:[e.jsx($,{size:18}),"启动资源应急预案"]}),e.jsxs("button",{className:"w-full py-3 bg-white/10 hover:bg-white/20 rounded-xl font-bold transition-colors flex items-center justify-center gap-2",children:[e.jsx(C,{size:18}),"通知所有项目经理"]})]})]})]})},je=(i,u,n="month")=>i.filter(l=>l.status==="active"||l.status==="completed").map(l=>{var A,F,R;const h=l.startDate?M(l.startDate):new Date,r=l.endDate?M(l.endDate):new Date,a=Math.max(1,P(r,h)),s=Math.max(1,ue(r,h)),c=((A=l.tasks)==null?void 0:A.length)||0,x=((F=l.tasks)==null?void 0:F.filter(v=>v.progress===100).length)||0,t=s>0?x/s:0,o=((R=l.tasks)==null?void 0:R.reduce((v,f)=>v+f.progress,0))||0,m=c>0?o/c:0,d=m>0?a/(m/100):a,g=(l.resourceRequirements||[]).reduce((v,f)=>{let y=f.duration;return f.unit==="month"&&(y=f.duration*30),f.unit==="year"&&(y=f.duration*365),v+f.count*y},0),p=c>0?g/c:g,N=(l.resourceRequirements||[]).reduce((v,f)=>v+f.count,0),z=(l.resourceRequirements||[]).reduce((v,f)=>{const y=u.find(L=>L.id===f.resourceId);return v+((y==null?void 0:y.totalQuantity)||0)},0),b=z>0?N/z*100:0,w=g;let S="normal";return b>95||d>60?S="critical":b>85||d>45?S="warning":t>5&&b>=70&&b<=85&&(S="efficient"),{projectId:l.id,projectName:l.name,throughput:t,leadTime:d,granularity:p,resourceUtilization:b,projectSize:w,status:S,totalTasks:c,completedTasks:x,resourceCount:N,durationDays:a}}),fe=(i,u)=>{const n=[],l=i.reduce((s,c)=>s+c.resourceUtilization,0)/i.length;l>90?n.push({type:"resource",title:"整体资源利用率过高",description:`当前平均资源利用率为 ${l.toFixed(1)}%，建议增加资源池容量或调整项目排期`,impact:"high",estimatedImprovement:"可提升交付效率 20-30%"}):l<60&&n.push({type:"resource",title:"资源利用率偏低",description:`当前平均资源利用率仅为 ${l.toFixed(1)}%，建议增加项目并行度或优化资源分配`,impact:"medium",estimatedImprovement:"可提升资源利用率 15-25%"});const h=i.filter(s=>s.throughput<2);h.length>i.length*.3&&n.push({type:"process",title:"多个项目吞吐量偏低",description:`${h.length} 个项目的吞吐量低于 2 事务/周，建议优化开发流程和任务分解`,impact:"high",estimatedImprovement:"可缩短交付周期 25-40%"});const r=i.filter(s=>s.leadTime>45);r.length>0&&n.push({type:"process",title:"部分项目前置时间过长",description:`${r.length} 个项目的前置时间超过 45 天，建议采用敏捷方法缩短反馈周期`,impact:"high",estimatedImprovement:"可缩短前置时间 30-50%"});const a=i.filter(s=>s.status==="critical");return a.length>0&&n.push({type:"priority",title:"关键项目需要优先处理",description:`${a.length} 个项目处于临界状态，建议调整优先级并分配更多资源`,impact:"high",estimatedImprovement:"可避免项目延期风险"}),n.sort((s,c)=>{const x={high:3,medium:2,low:1};return(x[c.impact]||0)-(x[s.impact]||0)})},Ne=({projects:i,resourcePool:u,metrics:n})=>{const[l,h]=j.useState("suggestions"),[r,a]=j.useState(new Set),s=j.useMemo(()=>fe(n),[n,u]),c=x=>{const t=new Set(r);t.has(x)?t.delete(x):t.add(x),a(t)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>h("suggestions"),className:`px-6 py-2 rounded-full font-medium transition-all ${l==="suggestions"?"bg-blue-600 text-white shadow-md":"bg-white text-slate-600 hover:bg-slate-50"}`,children:["优化建议 (",s.length,")"]}),e.jsx("button",{onClick:()=>h("simulation"),className:`px-6 py-2 rounded-full font-medium transition-all ${l==="simulation"?"bg-purple-600 text-white shadow-md":"bg-white text-slate-600 hover:bg-slate-50"}`,children:"方案模拟"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[e.jsx(T,{size:16,className:"text-yellow-500"}),e.jsx("span",{children:"AI 算法已就绪 (Genetic Algorithm + PSO)"})]})]}),l==="suggestions"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.map((x,t)=>{const o=r.has(t);return e.jsx("div",{className:`bg-white rounded-2xl p-6 shadow-sm border transition-all ${o?"border-green-500 ring-1 ring-green-500 bg-green-50/30":"border-slate-200 hover:border-blue-300"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${x.type==="resource"?"bg-blue-100 text-blue-600":x.type==="process"?"bg-purple-100 text-purple-600":"bg-orange-100 text-orange-600"}`,children:x.type==="resource"?e.jsx(se,{size:24}):x.type==="process"?e.jsx(T,{size:24}):e.jsx(B,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"text-lg font-bold text-slate-900",children:x.title}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${x.impact==="high"?"bg-red-100 text-red-700":x.impact==="medium"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:x.impact==="high"?"高影响力":x.impact==="medium"?"中等影响":"低影响"})]}),e.jsx("p",{className:"text-slate-600 mt-2",children:x.description}),e.jsx("div",{className:"mt-4 flex items-center gap-4 bg-slate-50 p-3 rounded-lg border border-slate-100",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-green-700",children:[e.jsx(k,{size:16}),"预期效果: ",x.estimatedImprovement]})}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsxs("button",{onClick:()=>c(t),className:`px-4 py-2 rounded-lg text-sm font-bold transition-colors flex items-center gap-2 ${o?"bg-green-600 text-white hover:bg-green-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[o?e.jsx(E,{size:16}):e.jsx(T,{size:16}),o?"已采纳":"一键优化"]}),e.jsx("button",{className:"px-4 py-2 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-100 border border-slate-200",children:"查看详情"})]})]})]})},t)}),s.length===0&&e.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl border border-slate-200",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(E,{className:"text-green-600",size:32})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"暂无优化建议"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"当前资源配置和项目效率处于最佳状态"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(te,{size:20,className:"text-blue-600"}),"优化效果预览"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"资源利用率"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-400 line-through",children:"92%"}),e.jsx("span",{className:"font-bold text-green-600",children:"85%"})]})]}),e.jsxs("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden flex",children:[e.jsx("div",{className:"h-full bg-green-500 w-[85%]"}),e.jsx("div",{className:"h-full bg-red-300 w-[7%] opacity-50"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"平均前置时间"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-400 line-through",children:"45天"}),e.jsx("span",{className:"font-bold text-green-600",children:"38天"})]})]}),e.jsxs("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden flex",children:[e.jsx("div",{className:"h-full bg-blue-500 w-[70%]"}),e.jsx("div",{className:"h-full bg-slate-300 w-[15%] opacity-50"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"吞吐量"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-slate-400 line-through",children:"2.5/周"}),e.jsx("span",{className:"font-bold text-green-600",children:"3.2/周"})]})]}),e.jsxs("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden flex",children:[e.jsx("div",{className:"h-full bg-purple-500 w-[60%]"}),e.jsx("div",{className:"h-full bg-purple-300 w-[20%] opacity-50 border-l border-white"})]})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-4",children:[e.jsx(U,{size:16}),e.jsxs("span",{children:["已选择 ",r.size," 项优化建议"]})]}),e.jsx("button",{disabled:r.size===0,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold hover:bg-slate-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"应用所有更改"})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-2xl p-6 border border-blue-100",children:[e.jsx("h4",{className:"font-bold text-blue-900 mb-2",children:"风险评估"}),e.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 w-1.5 h-1.5 bg-blue-500 rounded-full"}),"资源调配可能导致 Project X 短期效率波动"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 w-1.5 h-1.5 bg-blue-500 rounded-full"}),"需要额外 2 周的新成员培训时间"]})]})]})]})]}),l==="simulation"&&e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-slate-200",children:[e.jsx("div",{className:"w-24 h-24 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(T,{className:"text-purple-600",size:48})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"多目标优化模拟器"}),e.jsx("p",{className:"text-slate-600 max-w-lg mx-auto mb-8",children:"系统正在运行遗传算法(Genetic Algorithm)和粒子群算法(PSO)，为您寻找资源利用率与交付效率的最佳平衡点..."}),e.jsx("div",{className:"w-full max-w-md mx-auto h-2 bg-slate-100 rounded-full overflow-hidden mb-4",children:e.jsx("div",{className:"h-full bg-purple-600 w-2/3 animate-pulse"})}),e.jsx("p",{className:"text-sm text-slate-400",children:"计算进度: 67%"})]})]})},ve=()=>{const i=le(),u=ae(),[n,l]=j.useState("overview"),[h,r]=j.useState("month"),a=j.useMemo(()=>je(i,u,h),[i,u,h]),s=j.useMemo(()=>{const c=i.filter(d=>d.status==="active"),x=a.reduce((d,g)=>d+g.throughput,0),t=a.length>0?a.reduce((d,g)=>d+g.leadTime,0)/a.length:0,o=a.length>0?a.reduce((d,g)=>d+g.resourceUtilization,0)/a.length:0,m=a.filter(d=>d.resourceUtilization>90||d.leadTime>30).length;return{totalProjects:c.length,totalThroughput:x,avgLeadTime:t,avgUtilization:o,criticalProjects:m}},[i,a]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"资源交付效率看板"}),e.jsx("p",{className:"text-slate-600 mt-2",children:"实时监控项目交付效率与资源利用率，驱动数据决策优化"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:h,onChange:c=>r(c.target.value),className:"px-4 py-2 border border-slate-200 rounded-lg bg-white hover:border-blue-400 transition-colors",children:[e.jsx("option",{value:"week",children:"本周"}),e.jsx("option",{value:"month",children:"本月"}),e.jsx("option",{value:"quarter",children:"本季度"})]}),e.jsxs("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(ie,{size:18}),"导出报告"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 text-white shadow-lg hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(me,{size:24})}),e.jsx("span",{className:"text-xs font-medium bg-white/20 px-2 py-1 rounded-full",children:"活跃项目"})]}),e.jsx("div",{className:"text-4xl font-bold mb-1",children:s.totalProjects}),e.jsx("div",{className:"text-sm text-blue-100",children:"正在进行中"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl p-6 text-white shadow-lg hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(re,{size:24})}),e.jsx("span",{className:"text-xs font-medium bg-white/20 px-2 py-1 rounded-full",children:"吞吐量"})]}),e.jsx("div",{className:"text-4xl font-bold mb-1",children:s.totalThroughput.toFixed(1)}),e.jsx("div",{className:"text-sm text-green-100",children:"事务/周"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-6 text-white shadow-lg hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(O,{size:24})}),e.jsx("span",{className:"text-xs font-medium bg-white/20 px-2 py-1 rounded-full",children:"前置时间"})]}),e.jsx("div",{className:"text-4xl font-bold mb-1",children:s.avgLeadTime.toFixed(0)}),e.jsx("div",{className:"text-sm text-purple-100",children:"天 (P85)"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl p-6 text-white shadow-lg hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(k,{size:24})}),e.jsx("span",{className:"text-xs font-medium bg-white/20 px-2 py-1 rounded-full",children:"资源利用率"})]}),e.jsxs("div",{className:"text-4xl font-bold mb-1",children:[s.avgUtilization.toFixed(0),"%"]}),e.jsx("div",{className:"text-sm text-orange-100",children:"平均水平"})]}),e.jsxs("div",{className:`bg-gradient-to-br ${s.criticalProjects>0?"from-red-500 to-red-600":"from-slate-500 to-slate-600"} rounded-2xl p-6 text-white shadow-lg hover:shadow-xl transition-shadow`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(D,{size:24})}),e.jsx("span",{className:"text-xs font-medium bg-white/20 px-2 py-1 rounded-full",children:"预警项目"})]}),e.jsx("div",{className:"text-4xl font-bold mb-1",children:s.criticalProjects}),e.jsx("div",{className:"text-sm text-red-100",children:"需要关注"})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>l("overview"),className:`flex-1 px-4 py-3 rounded-lg font-medium transition-all ${n==="overview"?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-slate-100"}`,children:[e.jsx(ne,{className:"inline mr-2",size:18}),"全局效率视图"]}),e.jsxs("button",{onClick:()=>l("matrix"),className:`flex-1 px-4 py-3 rounded-lg font-medium transition-all ${n==="matrix"?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-slate-100"}`,children:[e.jsx(de,{className:"inline mr-2",size:18}),"关联分析矩阵"]}),e.jsxs("button",{onClick:()=>l("alerts"),className:`flex-1 px-4 py-3 rounded-lg font-medium transition-all ${n==="alerts"?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-slate-100"}`,children:[e.jsx(D,{className:"inline mr-2",size:18}),"实时预警"]}),e.jsxs("button",{onClick:()=>l("optimization"),className:`flex-1 px-4 py-3 rounded-lg font-medium transition-all ${n==="optimization"?"bg-blue-600 text-white shadow-md":"text-slate-600 hover:bg-slate-100"}`,children:[e.jsx(B,{className:"inline mr-2",size:18}),"智能优化"]})]})}),e.jsxs("div",{className:"min-h-[600px]",children:[n==="overview"&&e.jsx(ge,{metrics:a,timeRange:h}),n==="matrix"&&e.jsx(pe,{projects:i,resourcePool:u,metrics:a}),n==="alerts"&&e.jsx(be,{metrics:a,resourcePool:u}),n==="optimization"&&e.jsx(Ne,{projects:i,resourcePool:u,metrics:a})]})]})},$e=()=>e.jsx("div",{className:"animate-in fade-in duration-500",children:e.jsx(ve,{})});export{$e as default};
