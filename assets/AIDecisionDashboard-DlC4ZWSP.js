import{u as N,a as j,r as p,j as e,B as v,c as u,T as P}from"./index-amdNHPYN.js";import{L as w}from"./lightbulb-COpmNQiG.js";import{T as $}from"./target-BUj7fglx.js";import{Z as I}from"./zap-C1bNxCoU.js";const f=(d,c)=>{const o=[];return d.forEach(t=>{const l=[];let i=t.priority||"P2",n=70;const a=t.score||0;if(a>=8.5?(i="P0",l.push(`高评分项目 (${a.toFixed(1)})，建议最高优先级`),n=90):a>=7?(i="P1",l.push(`良好评分 (${a.toFixed(1)})，建议高优先级`),n=85):a>=5?(i="P2",l.push(`中等评分 (${a.toFixed(1)})，建议中等优先级`),n=75):(i="P3",l.push(`较低评分 (${a.toFixed(1)})，建议低优先级`),n=80),(t.resourceRequirements||[]).reduce((r,m)=>r+m.count,0)>10&&(l.push("需要大量资源投入，需要优先保障"),(i==="P2"||i==="P3")&&(i="P1")),t.startDate&&t.endDate){const r=new Date(t.startDate);(new Date(t.endDate).getTime()-r.getTime())/(1e3*60*60*24)<30&&(l.push("项目周期短，需要快速推进"),n+=5);const h=new Date,g=(r.getTime()-h.getTime())/(1e3*60*60*24);g<7&&g>0&&(l.push("即将开始，需要优先准备"),i==="P3"&&(i="P2"))}t.status==="active"&&(l.push("项目已启动，需要持续关注"),n+=5),i!==t.priority&&o.push({projectId:t.id,projectName:t.name,currentPriority:t.priority||"P2",recommendedPriority:i,confidence:Math.min(n,95),reasons:l,impact:i==="P0"?"high":i==="P1"?"medium":"low"})}),o.sort((t,l)=>l.confidence-t.confidence)},b=(d,c)=>{const o=[],t=new Map;c.forEach(i=>{let n=0;d.forEach(a=>{(a.resourceRequirements||[]).forEach(s=>{s.resourceId===i.id&&(n+=s.count)})}),t.set(i.id,n/i.totalQuantity)}),t.forEach((i,n)=>{const a=c.find(s=>s.id===n);if(a)if(i>1.2){const s=d.filter(r=>(r.resourceRequirements||[]).some(m=>m.resourceId===n)).map(r=>r.name);o.push({type:"hiring",priority:"urgent",description:`${a.name} 严重超载 (${(i*100).toFixed(0)}%)`,affectedProjects:s,estimatedImpact:{timeReduction:30,qualityImprovement:25},actionItems:[`立即招聘 ${Math.ceil((i-1)*a.totalQuantity)} 名 ${a.name}`,"考虑外包部分工作以缓解压力","重新评估项目优先级，延后低优先级项目"]})}else i<.5&&o.push({type:"reallocation",priority:"medium",description:`${a.name} 利用率较低 (${(i*100).toFixed(0)}%)`,affectedProjects:[],estimatedImpact:{costSaving:a.costPerUnit?a.costPerUnit*a.totalQuantity*.3:0},actionItems:["考虑将闲置资源分配到其他项目","评估是否可以减少该资源的容量","寻找新的项目机会以提高利用率"]})});const l=new Map;return d.forEach(i=>{(i.resourceRequirements||[]).forEach(n=>{n.requiredSkills&&n.requiredSkills.forEach(a=>{l.set(a,(l.get(a)||0)+1)})})}),l.forEach((i,n)=>{i>=3&&o.push({type:"training",priority:"high",description:`${n} 技能需求量大 (${i} 个项目需要)`,affectedProjects:[],estimatedImpact:{qualityImprovement:20,timeReduction:15},actionItems:[`组织 ${n} 技能培训`,"招聘具备该技能的专业人员","建立技能认证体系"]})}),o.sort((i,n)=>{const a={urgent:0,high:1,medium:2,low:3};return a[i.priority]-a[n.priority]})},y=(d,c)=>{const o=[];return d.forEach(t=>{const l=(t.resourceRequirements||[]).reduce((i,n)=>i+n.count,0);if(l>15&&o.push({projectId:t.id,projectName:t.name,riskType:"resource",severity:"high",probability:75,description:`项目需要 ${l} 个资源，可能面临资源短缺`,mitigation:["提前锁定关键资源","建立资源储备池","制定应急资源方案"]}),t.startDate&&t.endDate){const i=new Date(t.startDate),a=(new Date(t.endDate).getTime()-i.getTime())/(1e3*60*60*24);a<30&&l>5&&o.push({projectId:t.id,projectName:t.name,riskType:"timeline",severity:"critical",probability:85,description:`项目周期仅 ${Math.round(a)} 天，但需要 ${l} 个资源`,mitigation:["增加资源投入以加快进度","简化项目范围","采用敏捷开发方法","设置关键里程碑检查点"],predictedDate:t.endDate})}t.estimatedCost&&t.estimatedCost>1e6&&o.push({projectId:t.id,projectName:t.name,riskType:"budget",severity:"high",probability:60,description:`项目预算较高 (¥${(t.estimatedCost/1e4).toFixed(0)}万)，需要严格成本控制`,mitigation:["建立详细的成本跟踪机制","设置预算预警阈值","定期进行成本审查","优化资源配置以降低成本"]}),(t.score||0)<6&&t.status==="active"&&o.push({projectId:t.id,projectName:t.name,riskType:"quality",severity:"medium",probability:70,description:`项目评分较低 (${(t.score||0).toFixed(1)})，可能影响交付质量`,mitigation:["加强质量管理流程","增加测试和审查环节","引入质量保证专家","提高团队技能水平"]})}),o.sort((t,l)=>{const i={critical:0,high:1,medium:2,low:3};return i[t.severity]-i[l.severity]})},R=(d,c)=>{const o=f(d),t=b(d,c),l=y(d),i=d.filter(r=>r.priority==="P0"||r.priority==="P1").length;let n=0;c.forEach(r=>{let m=0;d.forEach(x=>{(x.resourceRequirements||[]).forEach(h=>{h.resourceId===r.id&&(m+=h.count)})}),n+=m/r.totalQuantity});const a=c.length>0?n/c.length:0,s=[];return o.length>0&&s.push(`${o.length} 个项目需要调整优先级`),t.filter(r=>r.priority==="urgent").length>0&&s.push(`${t.filter(r=>r.priority==="urgent").length} 个紧急优化建议`),l.filter(r=>r.severity==="critical").length>0&&s.push(`${l.filter(r=>r.severity==="critical").length} 个关键风险需要关注`),{totalProjects:d.length,highPriorityCount:i,resourceUtilization:a*100,topRecommendations:s,criticalRisks:l.filter(r=>r.severity==="critical"||r.severity==="high").length,optimizationOpportunities:t.length}},q=()=>{const{projects:d,resourcePool:c,factorDefinitions:o}=N(),{t}=j(),l=p.useMemo(()=>f(d),[d,o]),i=p.useMemo(()=>b(d,c),[d,c]),n=p.useMemo(()=>y(d),[d,c]),a=p.useMemo(()=>R(d,c),[d,c]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(v,{size:32}),e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:t("ai.intelligentInsights")}),e.jsx("h3",{className:"text-2xl font-bold",children:a.topRecommendations.length})]})]}),e.jsx("p",{className:"text-sm text-purple-100",children:t("ai.aiPoweredAnalysis")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(u,{size:32}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm",children:t("ai.criticalRisks")}),e.jsx("h3",{className:"text-2xl font-bold",children:a.criticalRisks})]})]}),e.jsx("p",{className:"text-sm text-orange-100",children:t("ai.needsAttention")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-2xl shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(w,{size:32}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:t("ai.optimizations")}),e.jsx("h3",{className:"text-2xl font-bold",children:a.optimizationOpportunities})]})]}),e.jsx("p",{className:"text-sm text-green-100",children:t("ai.improvementOpportunities")})]})]}),l.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx($,{className:"text-purple-600",size:24}),e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:t("ai.priorityRecommendations")})]}),e.jsx("div",{className:"space-y-4",children:l.slice(0,5).map((s,r)=>e.jsxs("div",{className:"border border-slate-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:s.projectName}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:"text-slate-500",children:[t("ai.current"),":"]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${s.currentPriority==="P0"?"bg-red-100 text-red-700":s.currentPriority==="P1"?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:s.currentPriority}),e.jsx("span",{className:"text-slate-400",children:"→"}),e.jsxs("span",{className:"text-slate-500",children:[t("ai.recommended"),":"]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${s.recommendedPriority==="P0"?"bg-red-100 text-red-700":s.recommendedPriority==="P1"?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:s.recommendedPriority})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-500",children:t("ai.confidence")}),e.jsxs("p",{className:"text-lg font-bold text-purple-600",children:[s.confidence,"%"]})]})})]}),e.jsx("div",{className:"space-y-1",children:s.reasons.map((m,x)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm text-slate-600",children:[e.jsx(I,{size:14,className:"text-purple-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:m})]},x))})]},r))})]}),i.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(P,{className:"text-green-600",size:24}),e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:t("ai.resourceOptimizations")})]}),e.jsx("div",{className:"space-y-4",children:i.slice(0,5).map((s,r)=>e.jsxs("div",{className:`border-l-4 rounded-r-xl p-4 ${s.priority==="urgent"?"border-red-500 bg-red-50":s.priority==="high"?"border-orange-500 bg-orange-50":"border-blue-500 bg-blue-50"}`,children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${s.priority==="urgent"?"bg-red-100 text-red-700":s.priority==="high"?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:s.priority}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${s.type==="hiring"?"bg-purple-100 text-purple-700":s.type==="training"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:t(`ai.${s.type}`)})]}),e.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:s.description})]})}),s.estimatedImpact&&e.jsxs("div",{className:"flex gap-4 mb-3 text-sm",children:[s.estimatedImpact.costSaving&&e.jsxs("div",{className:"flex items-center gap-1 text-green-700",children:[e.jsxs("span",{className:"font-medium",children:[t("ai.costSaving"),":"]}),e.jsxs("span",{className:"font-bold",children:["¥",(s.estimatedImpact.costSaving/1e4).toFixed(1),"万"]})]}),s.estimatedImpact.timeReduction&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-700",children:[e.jsxs("span",{className:"font-medium",children:[t("ai.timeReduction"),":"]}),e.jsxs("span",{className:"font-bold",children:[s.estimatedImpact.timeReduction,"%"]})]}),s.estimatedImpact.qualityImprovement&&e.jsxs("div",{className:"flex items-center gap-1 text-purple-700",children:[e.jsxs("span",{className:"font-medium",children:[t("ai.qualityImprovement"),":"]}),e.jsxs("span",{className:"font-bold",children:[s.estimatedImpact.qualityImprovement,"%"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs font-bold text-slate-600 mb-2",children:[t("ai.actionItems"),":"]}),s.actionItems.map((m,x)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm text-slate-700",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"•"}),e.jsx("span",{children:m})]},x))]})]},r))})]}),n.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(u,{className:"text-orange-600",size:24}),e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:t("ai.riskPredictions")})]}),e.jsx("div",{className:"space-y-4",children:n.slice(0,5).map((s,r)=>e.jsxs("div",{className:`border-l-4 rounded-r-xl p-4 ${s.severity==="critical"?"border-red-500 bg-red-50":s.severity==="high"?"border-orange-500 bg-orange-50":"border-yellow-500 bg-yellow-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${s.severity==="critical"?"bg-red-100 text-red-700":s.severity==="high"?"bg-orange-100 text-orange-700":"bg-yellow-100 text-yellow-700"}`,children:s.severity}),e.jsx("span",{className:"px-2 py-1 rounded text-xs font-bold bg-slate-100 text-slate-700",children:t(`ai.${s.riskType}`)})]}),e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:s.projectName}),e.jsx("p",{className:"text-sm text-slate-700 mb-2",children:s.description})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("p",{className:"text-xs text-slate-500",children:t("ai.probability")}),e.jsxs("p",{className:"text-lg font-bold text-orange-600",children:[s.probability,"%"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs font-bold text-slate-600 mb-2",children:[t("ai.mitigation"),":"]}),s.mitigation.map((m,x)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm text-slate-700",children:[e.jsx("span",{className:"text-orange-600 font-bold",children:"✓"}),e.jsx("span",{children:m})]},x))]})]},r))})]})]})};export{q as default};
