import{u as E,a as L,r as o,j as e,z as k,O as F,T as O,F as U}from"./index-BqZSi2fU.js";import{D as B}from"./download-BQChd_26.js";import{F as $}from"./filter-CV5wrPJv.js";import{C}from"./calendar-B2piyF0m.js";import{R as n,a as Q,T as c,C as u,X as h,Y as p,B as b,L as G}from"./generateCategoricalChart-BpsPtrl5.js";import{P as X,a as Y,b as H,c as I}from"./PieChart-DEQ9wEch.js";import{B as v}from"./BarChart-CZtiow6l.js";import{R as W,P as _,a as q}from"./RadarChart-DJPA5JSS.js";import{L as J}from"./LineChart-DFk-1FDp.js";import{L as V}from"./Line-BnpibuuN.js";const ce=()=>{const{projects:a,resourcePool:j}=E(),{t:s}=L(),[R,D]=o.useState("overview"),[x,N]=o.useState({start:"",end:""}),[z,P]=o.useState("bar"),y=o.useMemo(()=>{const t={planning:0,active:0,"on-hold":0,completed:0};return a.forEach(r=>{t[r.status]++}),Object.entries(t).map(([r,l])=>({name:r,value:l}))},[a]),S=o.useMemo(()=>{const t={P0:0,P1:0,P2:0,P3:0};return a.forEach(r=>{const l=r.priority||"P2";t[l]++}),Object.entries(t).map(([r,l])=>({name:r,value:l}))},[a]),m=o.useMemo(()=>j.map(t=>{let r=0;return a.forEach(l=>{(l.resourceRequirements||[]).forEach(i=>{i.resourceId===t.id&&(r+=i.count)})}),{name:t.name,allocated:r,total:t.totalQuantity,utilization:r/t.totalQuantity*100}}),[a,j]),K=o.useMemo(()=>{const t=[{name:"0-3",min:0,max:3,count:0},{name:"3-5",min:3,max:5,count:0},{name:"5-7",min:5,max:7,count:0},{name:"7-9",min:7,max:9,count:0},{name:"9-10",min:9,max:10,count:0}];return a.forEach(r=>{const l=r.score||0,i=t.find(f=>l>=f.min&&l<f.max);i&&i.count++}),t},[a]),M=o.useMemo(()=>a.map(t=>({name:t.name.length>15?t.name.substring(0,15)+"...":t.name,cost:t.estimatedCost||0,priority:t.priority||"P2"})).sort((t,r)=>r.cost-t.cost).slice(0,10),[a]),A=o.useMemo(()=>{const t=a.reduce((d,g)=>d+(g.score||0),0)/a.length||0,r=a.filter(d=>d.status==="active").length/a.length*100||0,l=m.reduce((d,g)=>d+g.utilization,0)/m.length||0;return[{subject:s("reports.projectScore"),value:t/10*100,fullMark:100},{subject:s("reports.activeRate"),value:r,fullMark:100},{subject:s("reports.resourceUtilization"),value:l,fullMark:100},{subject:s("reports.onTimeDelivery"),value:80,fullMark:100},{subject:s("reports.budgetCompliance"),value:75,fullMark:100}]},[a,m,s]),w=["#3b82f6","#8b5cf6","#ec4899","#f59e0b","#10b981"],T=()=>{alert(s("reports.exportingReport"))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:s("reports.advancedReports")}),e.jsx("p",{className:"text-slate-500 mt-1",children:s("reports.comprehensiveAnalytics")})]}),e.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx(B,{size:18}),s("reports.exportReport")]})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[e.jsx($,{size:16,className:"inline mr-1"}),s("reports.reportType")]}),e.jsxs("select",{value:R,onChange:t=>D(t.target.value),className:"w-full p-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"overview",children:s("reports.overview")}),e.jsx("option",{value:"resource",children:s("reports.resourceAnalysis")}),e.jsx("option",{value:"cost",children:s("reports.costAnalysis")}),e.jsx("option",{value:"timeline",children:s("reports.timelineAnalysis")}),e.jsx("option",{value:"performance",children:s("reports.performanceMetrics")})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[e.jsx(C,{size:16,className:"inline mr-1"}),s("reports.startDate")]}),e.jsx("input",{type:"date",value:x.start,onChange:t=>N({...x,start:t.target.value}),className:"w-full p-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[e.jsx(C,{size:16,className:"inline mr-1"}),s("reports.endDate")]}),e.jsx("input",{type:"date",value:x.end,onChange:t=>N({...x,end:t.target.value}),className:"w-full p-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[e.jsx(k,{size:16,className:"inline mr-1"}),s("reports.chartType")]}),e.jsxs("select",{value:z,onChange:t=>P(t.target.value),className:"w-full p-2 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"bar",children:s("reports.barChart")}),e.jsx("option",{value:"line",children:s("reports.lineChart")}),e.jsx("option",{value:"pie",children:s("reports.pieChart")}),e.jsx("option",{value:"radar",children:s("reports.radarChart")})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(F,{size:20,className:"text-blue-600"}),s("reports.projectStatusDistribution")]}),e.jsx(n,{width:"100%",height:300,children:e.jsxs(X,{children:[e.jsx(Y,{data:y,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:r})=>`${t} ${((r||0)*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:y.map((t,r)=>e.jsx(Q,{fill:w[r%w.length]},`cell-${r}`))}),e.jsx(c,{})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(k,{size:20,className:"text-purple-600"}),s("reports.priorityDistribution")]}),e.jsx(n,{width:"100%",height:300,children:e.jsxs(v,{data:S,children:[e.jsx(u,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(h,{dataKey:"name",tick:{fill:"#64748b"}}),e.jsx(p,{tick:{fill:"#64748b"}}),e.jsx(c,{}),e.jsx(b,{dataKey:"value",fill:"#8b5cf6",radius:[8,8,0,0]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(O,{size:20,className:"text-green-600"}),s("reports.resourceUtilization")]}),e.jsx(n,{width:"100%",height:300,children:e.jsxs(v,{data:m,children:[e.jsx(u,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(h,{dataKey:"name",tick:{fill:"#64748b",fontSize:12}}),e.jsx(p,{tick:{fill:"#64748b"}}),e.jsx(c,{}),e.jsx(G,{}),e.jsx(b,{dataKey:"allocated",fill:"#3b82f6",name:s("reports.allocated"),radius:[8,8,0,0]}),e.jsx(b,{dataKey:"total",fill:"#e2e8f0",name:s("reports.total"),radius:[8,8,0,0]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(U,{size:20,className:"text-orange-600"}),s("reports.projectHealth")]}),e.jsx(n,{width:"100%",height:300,children:e.jsxs(W,{data:A,children:[e.jsx(_,{stroke:"#e2e8f0"}),e.jsx(H,{dataKey:"subject",tick:{fill:"#64748b",fontSize:11}}),e.jsx(I,{angle:90,domain:[0,100],tick:{fill:"#64748b"}}),e.jsx(q,{name:s("reports.healthScore"),dataKey:"value",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6}),e.jsx(c,{})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:s("reports.scoreDistribution")}),e.jsx(n,{width:"100%",height:300,children:e.jsxs(J,{data:K,children:[e.jsx(u,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(h,{dataKey:"name",tick:{fill:"#64748b"}}),e.jsx(p,{tick:{fill:"#64748b"}}),e.jsx(c,{}),e.jsx(V,{type:"monotone",dataKey:"count",stroke:"#ec4899",strokeWidth:2,dot:{fill:"#ec4899",r:5}})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:s("reports.topCostProjects")}),e.jsx(n,{width:"100%",height:300,children:e.jsxs(v,{data:M,layout:"vertical",children:[e.jsx(u,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(h,{type:"number",tick:{fill:"#64748b"}}),e.jsx(p,{dataKey:"name",type:"category",tick:{fill:"#64748b",fontSize:11},width:100}),e.jsx(c,{formatter:t=>`¥${(t/1e4).toFixed(1)}万`}),e.jsx(b,{dataKey:"cost",fill:"#f59e0b",radius:[0,8,8,0]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:s("reports.summaryStatistics")}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-blue-600 mb-1",children:s("reports.totalProjects")}),e.jsx("p",{className:"text-3xl font-bold text-blue-700",children:a.length})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-green-600 mb-1",children:s("reports.activeProjects")}),e.jsx("p",{className:"text-3xl font-bold text-green-700",children:a.filter(t=>t.status==="active").length})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-purple-600 mb-1",children:s("reports.avgScore")}),e.jsx("p",{className:"text-3xl font-bold text-purple-700",children:(a.reduce((t,r)=>t+(r.score||0),0)/a.length||0).toFixed(1)})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-orange-600 mb-1",children:s("reports.totalResources")}),e.jsx("p",{className:"text-3xl font-bold text-orange-700",children:j.reduce((t,r)=>t+r.totalQuantity,0)})]})]})]})]})};export{ce as default};
