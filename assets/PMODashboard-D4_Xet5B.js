import{e as W,r as C,j as e,C as y,c as N,T as w,d as q,g as E,z as J,V as $,U as L,u as X,L as Y,F as Z}from"./index-dIhSveSg.js";import{u as ee}from"./usePMOStore-BfgBSg0p.js";import{C as b,a as P,B as H}from"./Badge-CISJB1oO.js";import{C as S}from"./clock-oes4XoDk.js";import{T as G}from"./trending-down-By19-XgN.js";import{T as M}from"./target-CnQovXZ5.js";import{C as te}from"./calendar-DMjAWnfr.js";import{D as O}from"./dollar-sign-DDFoO7hq.js";import{A as se}from"./activity-BrpyVOoW.js";import{R as T,a as I,T as A,L as B}from"./generateCategoricalChart-PO57mRpp.js";import{P as F,a as U}from"./PieChart-BhEEang2.js";import{m as ae}from"./proxy-Dsy0yqdO.js";import{R as le}from"./ResourceRiskPredictor-DcVKr1ur.js";import{G as re}from"./git-branch-9ppVBlm9.js";import{N as ne}from"./network-Bk4agA3Q.js";import"./resourcePrediction-XxP2WNcD.js";import"./addMonths-COhnv4kN.js";import"./format-DEGo7ImM.js";import"./zap-DIxv3q3E.js";import"./AreaChart-CVJk3bUS.js";import"./Line-Cd1XaBT5.js";import"./filter-CUPOnGGX.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=W("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),de=({projects:t})=>{const s=C.useMemo(()=>t.filter(a=>a.status==="active").map(a=>{const i=[];let x=100;const u=new Date(a.endDate),j=new Date,f=Math.ceil((u.getTime()-j.getTime())/(1e3*60*60*24));f<0?(i.push({type:"schedule",severity:"high",message:`已延期 ${Math.abs(f)} 天`}),x-=30):f<7&&(i.push({type:"schedule",severity:"medium",message:`即将到期（${f} 天）`}),x-=15);const v=a.actualCost&&a.budget?a.actualCost/a.budget*100:0;v>100?(i.push({type:"budget",severity:"high",message:`预算超支 ${(v-100).toFixed(1)}%`}),x-=25):v>90&&(i.push({type:"budget",severity:"medium",message:`预算使用率 ${v.toFixed(1)}%`}),x-=10);const p=a.tasks||[],k=p.filter(D=>D.status==="completed").length,d=p.length>0?k/p.length*100:0;d<30&&f<30&&(i.push({type:"quality",severity:"high",message:`任务完成率仅 ${d.toFixed(0)}%`}),x-=20),(p.length>20?Math.floor(p.length/4):0)>5&&(i.push({type:"scope",severity:"medium",message:`任务数量较多（${p.length} 个）`}),x-=10);let h="healthy";return x<50?h="critical":x<75&&(h="warning"),{projectId:a.id,projectName:a.name,healthScore:Math.max(0,x),status:h,issues:i}}).sort((a,i)=>a.healthScore-i.healthScore),[t]),c=s.filter(a=>a.status==="critical"),r=s.filter(a=>a.status==="warning"),n=s.filter(a=>a.status==="healthy"),l=a=>{switch(a){case"healthy":return e.jsx(y,{className:"w-5 h-5 text-green-600 dark:text-green-400"});case"warning":return e.jsx(N,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"});case"critical":return e.jsx(N,{className:"w-5 h-5 text-red-600 dark:text-red-400"});default:return e.jsx(S,{className:"w-5 h-5 text-slate-400"})}},o=a=>{switch(a){case"healthy":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800";case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";case"critical":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";default:return"bg-slate-50 dark:bg-slate-800 border-slate-200 dark:border-slate-700"}},m=a=>{switch(a){case"schedule":return e.jsx(S,{className:"w-4 h-4"});case"budget":return e.jsx(G,{className:"w-4 h-4"});case"scope":return e.jsx(w,{className:"w-4 h-4"});default:return e.jsx(N,{className:"w-4 h-4"})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(b,{className:"p-4 bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(y,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-900 dark:text-green-100",children:"健康项目"})]}),e.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:n.length})]}),e.jsxs(b,{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(N,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"}),e.jsx("span",{className:"text-sm font-medium text-yellow-900 dark:text-yellow-100",children:"需关注"})]}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600 dark:text-yellow-400",children:r.length})]}),e.jsxs(b,{className:"p-4 bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(N,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),e.jsx("span",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:"严重问题"})]}),e.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:c.length})]})]}),e.jsxs("div",{className:"space-y-3",children:[s.slice(0,10).map(a=>e.jsxs(b,{className:`p-4 ${o(a.status)}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[l(a.status),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-slate-100",children:a.projectName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"flex-1 bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${a.status==="healthy"?"bg-green-600":a.status==="warning"?"bg-yellow-600":"bg-red-600"}`,style:{width:`${a.healthScore}%`}})}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:a.healthScore.toFixed(0)})]})]})]}),e.jsx(P,{variant:a.status==="healthy"?"success":a.status==="warning"?"warning":"danger",children:a.status==="healthy"?"健康":a.status==="warning"?"警告":"严重"})]}),a.issues.length>0&&e.jsx("div",{className:"space-y-1",children:a.issues.map((i,x)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700 dark:text-slate-300",children:[m(i.type),e.jsx("span",{children:i.message}),e.jsx(P,{variant:i.severity==="high"?"danger":i.severity==="medium"?"warning":"neutral",size:"sm",children:i.severity})]},x))})]},a.projectId)),s.length===0&&e.jsxs(b,{className:"p-8 text-center",children:[e.jsx(y,{className:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"暂无活跃项目"})]})]})]})};function _(t){if(!t.endDate)return"amber";const s=new Date,c=new Date(t.endDate),r=new Date(t.startDate),n=q(c,r),l=q(s,r),o=t.progress||0,m=n>0?l/n*100:0,a=o-m;return a>=-5?"green":a>=-15?"amber":"red"}function ce(t){const s=t.budget||t.totalBudget||0,c=t.actualCost||t.budgetUsed||0,r=t.progress||0;if(s===0)return"amber";const n=r/100*s,l=(c-n)/s*100;return l<=5?"green":l<=15?"amber":"red"}function oe(t){const c=(t.risks||[]).filter(l=>l.status!=="resolved"&&l.status!=="accepted");if(c.length===0)return"green";const r=c.filter(l=>l.priority==="critical").length,n=c.filter(l=>l.priority==="high").length;return r>0?"red":n>2||c.length>5?"amber":"green"}function K(t){const s=t.tasks||[];if(s.length===0)return"amber";const r=s.filter(o=>o.progress===100).length/s.length*100,n=t.progress||0,l=Math.abs(r-n);return l<=10?"green":l<=25?"amber":"red"}function xe(t){const s=_(t),c=K(t);return s==="green"&&c==="green"?"green":s==="red"||c==="red"?"red":"amber"}function me(t){const s=[t.scheduleHealth,t.budgetHealth,t.scopeHealth,t.qualityHealth,t.riskHealth],c=s.filter(n=>n==="red").length,r=s.filter(n=>n==="amber").length;return c>0?"red":r>2||r>0?"amber":"green"}function V(t){const s=_(t),c=ce(t),r=K(t),n=xe(t),l=oe(t),o=me({projectId:t.id,projectName:t.name,scheduleHealth:s,budgetHealth:c,scopeHealth:r,qualityHealth:n,riskHealth:l});return{projectId:t.id,projectName:t.name,scheduleHealth:s,budgetHealth:c,scopeHealth:r,qualityHealth:n,riskHealth:l,overallHealth:o,trend:"stable"}}function he(t){const s=t.filter(d=>d.status==="active"),c=t.filter(d=>d.status==="completed"),r=t.filter(d=>d.status==="on-hold"),n=t.reduce((d,g)=>d+(g.budget||g.totalBudget||0),0),l=t.reduce((d,g)=>d+(g.actualCost||g.budgetUsed||0),0),o=t.reduce((d,g)=>d+(g.score||0)*1e5,0),m=s.map(V),a=m.filter(d=>d.overallHealth==="green").length,i=m.filter(d=>d.overallHealth==="amber").length,x=m.filter(d=>d.overallHealth==="red").length,j=t.flatMap(d=>d.risks||[]).filter(d=>d.status!=="resolved"&&d.status!=="accepted"),f=j.reduce((d,g)=>d+(g.estimatedCostImpact||0),0),v=j.filter(d=>d.priority==="critical").length,p=t.reduce((d,g)=>{const h=g.resourceRequirements||[];return d+h.reduce((D,Q)=>D+Q.count,0)},0),k=p>0?75:0;return{totalProjects:t.length,activeProjects:s.length,completedProjects:c.length,onHoldProjects:r.length,totalBudget:n,totalSpent:l,totalValue:o,healthDistribution:{green:a,amber:i,red:x},totalRiskExposure:f,criticalRisks:v,totalResourcesAllocated:p,resourceUtilizationRate:k}}function z(t,s="bg"){return{green:{bg:"bg-green-100 dark:bg-green-900/20",text:"text-green-700 dark:text-green-400",border:"border-green-500"},amber:{bg:"bg-orange-100 dark:bg-orange-900/20",text:"text-orange-700 dark:text-orange-400",border:"border-orange-500"},red:{bg:"bg-red-100 dark:bg-red-900/20",text:"text-red-700 dark:text-red-400",border:"border-red-500"}}[t][s]}const R=({status:t,label:s})=>{const c=z(t,"bg"),r=z(t,"text");return e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${c} ${r} text-center`,title:s,children:t==="green"?"●":t==="amber"?"▲":"■"})},ue=({trend:t})=>t==="improving"?e.jsx(w,{size:14,className:"text-green-600 dark:text-green-400"}):t==="declining"?e.jsx(G,{size:14,className:"text-red-600 dark:text-red-400"}):e.jsx(ie,{size:14,className:"text-slate-400"}),ge=({projects:t})=>{const s=E(),c=C.useMemo(()=>t.filter(r=>r.status==="active"||r.status==="planning").map(r=>({project:r,health:V(r)})).sort((r,n)=>{const l={red:0,amber:1,green:2};return l[r.health.overallHealth]-l[n.health.overallHealth]}),[t]);return c.length===0?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-8 text-center",children:[e.jsx(M,{size:48,className:"mx-auto mb-3 text-slate-300 dark:text-slate-600"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"暂无活跃项目"})]}):e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:"项目健康状态矩阵"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:["RAG 状态：",e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"● 良好"})," ·",e.jsx("span",{className:"text-orange-600 dark:text-orange-400 ml-2",children:"▲ 警告"})," ·",e.jsx("span",{className:"text-red-600 dark:text-red-400 ml-2",children:"■ 风险"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"项目名称"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(te,{size:12}),"进度"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(O,{size:12}),"预算"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(M,{size:12}),"范围"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(y,{size:12}),"质量"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(N,{size:12}),"风险"]})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"综合"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:"趋势"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:c.map(({project:r,health:n})=>{const l=z(n.overallHealth,"bg");return e.jsxs("tr",{onClick:()=>s(`/projects/${r.id}`),className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:r.name}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:r.manager||"未分配"})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(R,{status:n.scheduleHealth,label:"进度健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(R,{status:n.budgetHealth,label:"预算健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(R,{status:n.scopeHealth,label:"范围健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(R,{status:n.qualityHealth,label:"质量健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(R,{status:n.riskHealth,label:"风险健康度"})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full ${l}`,children:e.jsx("span",{className:`text-sm font-bold ${z(n.overallHealth,"text")}`,children:n.overallHealth==="green"?"健康":n.overallHealth==="amber"?"警告":"风险"})})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(ue,{trend:n.trend})})})]},r.id)})})]})}),e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 border-t border-slate-200 dark:border-slate-700 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("span",{className:"font-medium",children:"提示："})," 点击项目行查看详情 · RAG 指标基于进度、预算、范围、质量和风险的综合评估"]})]})},be=()=>{const t=J(),s=C.useMemo(()=>he(t),[t]),c=[{name:"健康",value:s.healthDistribution.green,color:"#10b981"},{name:"警告",value:s.healthDistribution.amber,color:"#f59e0b"},{name:"风险",value:s.healthDistribution.red,color:"#ef4444"}].filter(l=>l.value>0),r=[{name:"活跃",value:s.activeProjects,color:"#3b82f6"},{name:"已完成",value:s.completedProjects,color:"#10b981"},{name:"暂停",value:s.onHoldProjects,color:"#6b7280"}].filter(l=>l.value>0),n=({icon:l,title:o,value:m,subtitle:a,trend:i,colorClass:x="text-blue-600 dark:text-blue-400"})=>e.jsx(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`${x}`,children:l}),e.jsx("h3",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:o})]}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:m}),a&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:a})]}),i&&e.jsxs("div",{className:`text-sm font-medium ${i==="up"?"text-green-600":i==="down"?"text-red-600":"text-slate-400"}`,children:[i==="up"&&e.jsx(w,{size:20}),i==="down"&&e.jsx(w,{size:20,className:"rotate-180"})]})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-3",children:[e.jsx($,{className:"text-blue-600 dark:text-blue-400",size:32}),"项目组合仪表盘"]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"PMO 总览 - 实时监控所有项目的健康状态"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(n,{icon:e.jsx(M,{size:24}),title:"项目总数",value:s.totalProjects,subtitle:`${s.activeProjects} 个活跃项目`,colorClass:"text-blue-600 dark:text-blue-400"}),e.jsx(n,{icon:e.jsx(O,{size:24}),title:"总预算",value:`¥${(s.totalBudget/1e4).toFixed(1)}万`,subtitle:`已使用 ¥${(s.totalSpent/1e4).toFixed(1)}万`,colorClass:"text-green-600 dark:text-green-400"}),e.jsx(n,{icon:e.jsx(N,{size:24}),title:"风险暴露",value:s.criticalRisks,subtitle:`${s.criticalRisks} 个关键风险`,colorClass:"text-red-600 dark:text-red-400"}),e.jsx(n,{icon:e.jsx(L,{size:24}),title:"资源利用率",value:`${s.resourceUtilizationRate}%`,subtitle:`${s.totalResourcesAllocated} 人已分配`,colorClass:"text-purple-600 dark:text-purple-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 flex items-center gap-2",children:[e.jsx(se,{size:20,className:"text-blue-600 dark:text-blue-400"}),"健康状态分布"]}),c.length>0?e.jsx(T,{width:"100%",height:250,children:e.jsxs(F,{children:[e.jsx(U,{data:c,cx:"50%",cy:"50%",labelLine:!1,label:({name:l,percent:o})=>`${l} ${((o||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:c.map((l,o)=>e.jsx(I,{fill:l.color},`cell-${o}`))}),e.jsx(A,{}),e.jsx(B,{})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-slate-400",children:"暂无数据"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 mb-4 flex items-center gap-2",children:[e.jsx(y,{size:20,className:"text-green-600 dark:text-green-400"}),"项目状态分布"]}),r.length>0?e.jsx(T,{width:"100%",height:250,children:e.jsxs(F,{children:[e.jsx(U,{data:r,cx:"50%",cy:"50%",labelLine:!1,label:({name:l,percent:o})=>`${l} ${((o||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:r.map((l,o)=>e.jsx(I,{fill:l.color},`cell-${o}`))}),e.jsx(A,{}),e.jsx(B,{})]})}):e.jsx("div",{className:"h-64 flex items-center justify-center text-slate-400",children:"暂无数据"})]})]}),e.jsx(ge,{projects:t})]})},Fe=()=>{const t=E(),{projects:s,resourcePool:c}=X(),{changeRequests:r,environmentResources:n,requirements:l,simulations:o}=ee(),[m,a]=C.useState("overview"),i=C.useMemo(()=>{const u=s.filter(h=>h.status==="active"),j=s.length,f=s.filter(h=>h.status==="completed").length,v=r.filter(h=>h.status==="pending").length,p=r.length,k=l.length,d=l.filter(h=>h.status==="completed").length,g=n.filter(h=>h.status==="available").length;return{activeProjects:u.length,totalProjects:j,completedProjects:f,completionRate:j>0?f/j*100:0,pendingChangeRequests:v,totalChangeRequests:p,totalRequirements:k,completedRequirements:d,requirementCompletionRate:k>0?d/k*100:0,availableEnvironments:g,totalEnvironments:n.length,totalSimulations:o.length}},[s,r,l,n,o]),x=C.useMemo(()=>[...r].sort((u,j)=>new Date(j.requestDate).getTime()-new Date(u.requestDate).getTime()).slice(0,5),[r]);return e.jsxs("div",{className:"animate-fadeIn",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"PMO 战略管控中心"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"项目组合管理、范围防御、资源冲突管控一站式平台"})]})}),e.jsxs("div",{className:"flex gap-2 border-b border-slate-200 dark:border-slate-700 mb-6 overflow-x-auto no-scrollbar scrollbar-hide whitespace-nowrap",children:[e.jsxs("button",{onClick:()=>a("overview"),className:`flex items-center gap-2 px-4 py-3 font-medium transition-all ${m==="overview"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"}`,children:[e.jsx(Y,{size:18}),"管控概览"]}),e.jsxs("button",{onClick:()=>a("portfolio"),className:`flex items-center gap-2 px-4 py-3 font-medium transition-all ${m==="portfolio"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"}`,children:[e.jsx($,{size:18}),"项目组合"]}),e.jsxs("button",{onClick:()=>a("risks"),className:`flex items-center gap-2 px-4 py-3 font-medium transition-all ${m==="risks"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100"}`,children:[e.jsx(N,{size:18}),"风险预测"]})]}),e.jsxs("div",{className:"space-y-6",children:[m==="overview"&&e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{onClick:()=>t("/projects"),className:"cursor-pointer",children:e.jsx(b,{className:"p-4 hover:shadow-lg transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-xl",children:e.jsx(re,{size:24})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 truncate",children:"活跃项目"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("h3",{className:"text-2xl font-bold",children:i.activeProjects}),e.jsxs("span",{className:"text-xs text-slate-400",children:["/ ",i.totalProjects]})]})]})]})})}),e.jsx(b,{className:"p-4 hover:shadow-lg transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-xl",children:e.jsx(w,{size:24})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 truncate",children:"待审批变更"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("h3",{className:"text-2xl font-bold",children:i.pendingChangeRequests}),e.jsx("span",{className:"text-xs text-slate-400",children:"急需处理"})]})]})]})}),e.jsx(b,{className:"p-4 hover:shadow-lg transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-xl",children:e.jsx(y,{size:24})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 truncate",children:"需求完成率"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("h3",{className:"text-2xl font-bold text-emerald-600",children:[i.requirementCompletionRate.toFixed(0),"%"]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[i.completedRequirements,"/",i.totalRequirements]})]})]})]})}),e.jsx("div",{onClick:()=>t("/environments"),className:"cursor-pointer",children:e.jsx(b,{className:"p-4 hover:shadow-lg transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-xl",children:e.jsx(ne,{size:24})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 truncate",children:"可用环境"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("h3",{className:"text-2xl font-bold",children:i.availableEnvironments}),e.jsxs("span",{className:"text-xs text-slate-400",children:["/ ",i.totalEnvironments]})]})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Z,{size:20,className:"text-blue-500"}),"最近变更请求"]}),e.jsx(H,{variant:"ghost",size:"sm",onClick:()=>t("/pmo"),children:"查看明细"})]}),e.jsx("div",{className:"space-y-4",children:x.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-500 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("th",{className:"pb-2 font-medium",children:"项目名称"}),e.jsx("th",{className:"pb-2 font-medium",children:"变更类型"}),e.jsx("th",{className:"pb-2 font-medium",children:"状态"}),e.jsx("th",{className:"pb-2 font-medium text-right",children:"日期"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:x.map(u=>e.jsxs("tr",{className:"group hover:bg-slate-50/50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsx("td",{className:"py-3 font-medium truncate max-w-[200px]",children:u.projectName}),e.jsx("td",{className:"py-3",children:e.jsx(P,{variant:"neutral",className:"text-[10px]",children:u.category})}),e.jsx("td",{className:"py-3",children:e.jsx(P,{variant:u.status==="approved"?"success":u.status==="rejected"?"danger":"warning",children:u.status})}),e.jsx("td",{className:"py-3 text-right text-slate-400",children:new Date(u.requestDate).toLocaleDateString()})]},u.id))})]})}):e.jsx("div",{className:"py-12 text-center text-slate-500",children:"暂无最近变更记录"})})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-6 flex items-center gap-2",children:[e.jsx(w,{size:20,className:"text-emerald-500"}),"项目健康度监控"]}),e.jsx(de,{projects:s})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"快速管控操作"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(H,{onClick:()=>t("/simulation"),variant:"primary",className:"w-full justify-start h-12",children:[e.jsx(w,{className:"mr-2 h-4 w-4"})," 沙盘推演 (What-If)"]}),e.jsxs(H,{onClick:()=>t("/environments"),variant:"secondary",className:"w-full justify-start h-12",children:[e.jsx(L,{className:"mr-2 h-4 w-4"})," 环境管理"]}),e.jsxs(H,{onClick:()=>a("portfolio"),variant:"secondary",className:"w-full justify-start h-12",children:[e.jsx($,{className:"mr-2 h-4 w-4"})," 项目组合视图"]})]})]}),e.jsxs(b,{className:"p-6 bg-slate-900 dark:bg-slate-800 text-white border-none shadow-2xl",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(N,{className:"text-yellow-400",size:20}),"系统防御状态报告"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"整体交付完成率"}),e.jsxs("span",{className:"font-mono text-emerald-400 font-bold",children:[i.completionRate.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-emerald-500 h-2 rounded-full shadow-[0_0_10px_rgba(16,185,129,0.5)]",style:{width:`${i.completionRate}%`}})}),e.jsxs("p",{className:"text-xs text-slate-400 leading-relaxed",children:["当前项目组合运行稳定。已通过 AI 决策引擎优化资源分配，建议针对 ",i.pendingChangeRequests," 项待审批变更进行沙盘模拟。"]}),e.jsx("div",{className:"pt-2",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-emerald-500/10 text-emerald-400 rounded-full text-[10px] font-bold",children:[e.jsx(y,{size:12})," SECURE STATUS"]})})]})]})]})]})]}),m==="portfolio"&&e.jsx("div",{className:"animate-fadeIn",children:e.jsx(be,{})}),m==="risks"&&e.jsx("div",{className:"animate-fadeIn",children:e.jsx(le,{projects:s,resourcePool:c})})]})]})};export{Fe as default};
