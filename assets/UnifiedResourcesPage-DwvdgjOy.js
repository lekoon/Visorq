import{e as I,t as G,r as N,j as e,u as T,l as xe,X as re,h as me,d as J,p as E,C as L,A as De,E as Me,c as K,G as ne,y as ie,U as H,T as V,z as Re,a as ge,b as W,L as Pe,I as he,H as Ae,B as Ee,J as $e}from"./index-4ZFyaw-q.js";import{R as Fe}from"./ResourceRiskPredictor-Cuyuxpbb.js";import{R as U,a as Ne,T as F,L as B,C as Y,X as Z,Y as ee,B as se}from"./generateCategoricalChart-C7rW_j2P.js";import{P as ve,a as ye,b as Ie,c as Oe}from"./PieChart-_lqOlyOq.js";import{L as Te}from"./LineChart-hGF5xpd5.js";import{L as Le}from"./Line-Dt5pm7hh.js";import{B as we}from"./BarChart-Clo4DDGk.js";import{c as Ue,S as Be,g as ke,a as Se,e as qe,E as Qe}from"./EnhancedResourceTimeline-CItqCmzS.js";import{S as X}from"./save-BvLqrAT_.js";import{P as te}from"./plus-DkYnjXUx.js";import{C as _}from"./calendar-Dm_sE_dB.js";import{f as $}from"./format-C4fTSpOc.js";import{a as O}from"./eachDayOfInterval-BX955VXt.js";import{C as Ke}from"./chart-no-axes-column-BIuFr5Rz.js";import{Z as ue}from"./zap-KkX5R2wB.js";import{A as We}from"./activity-CQvEB8wL.js";import{s as He}from"./startOfMonth-DhQyw6R5.js";import{a as pe}from"./addMonths-DgbEpBEx.js";import{C as Ve}from"./CostAnalysis-CcjA1RHu.js";import{T as Ce}from"./target-DGm61NpW.js";import _e from"./AIDecisionDashboard-BkeCnZY9.js";import{C as P,a as ae,B as q}from"./Badge-BBIsmHYB.js";import{A as Ge}from"./arrow-down-right-DRPEYBdy.js";import{R as Je,P as Xe,a as be}from"./RadarChart-CD6OE2dj.js";import{P as Ye,a as Ze}from"./PageHeader-CLeY5ZTN.js";import{F as es}from"./filter-DL_lu8L6.js";import{D as ss}from"./download-Bcjj-koe.js";import{D as ts}from"./dollar-sign-B0UF5VNm.js";import"./resourcePrediction-DI65rjyG.js";import"./AreaChart-BDUKhlYP.js";import"./addWeeks-d7NRPV4I.js";import"./endOfDay-CWoK5JQc.js";import"./endOfWeek-DkSBJe83.js";import"./chevron-left-DzDZdlGV.js";import"./chevron-right-DAwOG0oR.js";import"./lightbulb-BGACzUxy.js";import"./trending-down-emeSoT4O.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=I("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=I("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=I("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=I("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=I("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=I("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);function je(d,o){const l=+G(d),[b,c]=[+G(o.start),+G(o.end)].sort((r,m)=>r-m);return l>=b&&l<=c}const Q=N.memo(({active:d,payload:o,label:l})=>!d||!o||!o.length?null:e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-slate-200",children:[l&&e.jsx("p",{className:"font-semibold text-slate-900 mb-1",children:l}),o.map((b,c)=>e.jsxs("p",{className:"text-sm",style:{color:b.color},children:[b.name,": ",e.jsx("span",{className:"font-semibold",children:b.value})]},c))]}));Q.displayName="CustomTooltip";const le=N.memo(({type:d,data:o,dataKey:l="value",xKey:b="name",colors:c=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],height:r=300,showGrid:m=!0,showLegend:n=!0,showTooltip:a=!0,animate:u=!0})=>{const x=N.useMemo(()=>{if(!o||o.length===0)return[];if(o.length>100){const t=Math.ceil(o.length/100);return o.filter((i,g)=>g%t===0)}return o},[o]),j=N.useMemo(()=>({margin:{top:5,right:30,left:20,bottom:5},animationDuration:u?300:0}),[u]);if(!x||x.length===0)return e.jsx("div",{className:"flex items-center justify-center bg-slate-50 rounded-lg border border-slate-200",style:{height:r},children:e.jsx("p",{className:"text-slate-400",children:"No data available"})});const s=()=>{switch(d){case"bar":return e.jsxs(we,{data:x,...j,children:[m&&e.jsx(Y,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(Z,{dataKey:b,stroke:"#64748b",tick:{fill:"#64748b",fontSize:12}}),e.jsx(ee,{stroke:"#64748b",tick:{fill:"#64748b",fontSize:12}}),a&&e.jsx(F,{content:e.jsx(Q,{})}),n&&e.jsx(B,{wrapperStyle:{fontSize:12}}),e.jsx(se,{dataKey:l,fill:c[0],radius:[4,4,0,0],animationDuration:j.animationDuration})]});case"line":return e.jsxs(Te,{data:x,...j,children:[m&&e.jsx(Y,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(Z,{dataKey:b,stroke:"#64748b",tick:{fill:"#64748b",fontSize:12}}),e.jsx(ee,{stroke:"#64748b",tick:{fill:"#64748b",fontSize:12}}),a&&e.jsx(F,{content:e.jsx(Q,{})}),n&&e.jsx(B,{wrapperStyle:{fontSize:12}}),e.jsx(Le,{type:"monotone",dataKey:l,stroke:c[0],strokeWidth:2,dot:{fill:c[0],r:4},activeDot:{r:6},animationDuration:j.animationDuration})]});case"pie":return e.jsxs(ve,{children:[e.jsx(ye,{data:x,dataKey:l,nameKey:b,cx:"50%",cy:"50%",outerRadius:100,label:!0,animationDuration:j.animationDuration,children:x.map((t,i)=>e.jsx(Ne,{fill:c[i%c.length]},`cell-${i}`))}),a&&e.jsx(F,{content:e.jsx(Q,{})}),n&&e.jsx(B,{wrapperStyle:{fontSize:12}})]});default:return null}};return e.jsx(U,{width:"100%",height:r,children:s()})},(d,o)=>d.type===o.type&&d.data===o.data&&d.dataKey===o.dataKey&&d.xKey===o.xKey&&d.height===o.height&&d.animate===o.animate);le.displayName="OptimizedChart";const os=({isOpen:d,onClose:o,resourceId:l})=>{const{resourcePool:b,updateResource:c}=T(),r=b.find(h=>h.id===l),[m,n]=N.useState("basic"),[a,u]=N.useState({}),[x,j]=N.useState([]),[s,t]=N.useState([]),[i,g]=N.useState(null);N.useEffect(()=>{r&&(u({name:r.name,totalQuantity:r.totalQuantity,costPerUnit:r.costPerUnit}),j(r.members||[]),t(r.skills||[]))},[r]);const v=()=>{var h;r&&(c(r.id,{...a,totalQuantity:parseInt(((h=a.totalQuantity)==null?void 0:h.toString())||"0")}),alert("åŸºæœ¬ä¿¡æ¯å·²ä¿å­˜"))},k=()=>{r&&(c(r.id,{members:x}),alert("æˆå‘˜åˆ—è¡¨å·²ä¿å­˜"))},p=()=>{r&&(c(r.id,{skills:s}),alert("æŠ€èƒ½åˆ—è¡¨å·²ä¿å­˜"))},f=()=>{const h={id:`member-${Date.now()}`,name:"æ–°æˆå‘˜",role:(r==null?void 0:r.name)||"Engineer",skills:[],availability:100,assignments:[],joinDate:new Date().toISOString().split("T")[0]};j([...x,h]),g(h)},w=h=>{confirm("ç¡®å®šè¦åˆ é™¤è¿™ä½æˆå‘˜å—ï¼Ÿ")&&(j(x.filter(C=>C.id!==h)),(i==null?void 0:i.id)===h&&g(null))},y=(h,C)=>{j(x.map(z=>z.id===h?{...z,...C}:z)),(i==null?void 0:i.id)===h&&g({...i,...C})};return!d||!r?null:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl h-[80vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(xe,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:r.name}),e.jsx("p",{className:"text-sm text-slate-500",children:"èµ„æºè¯¦æƒ…ç®¡ç†"})]})]}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(re,{size:20,className:"text-slate-500"})})]}),e.jsxs("div",{className:"flex border-b border-slate-200 px-6",children:[e.jsx("button",{onClick:()=>n("basic"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m==="basic"?"border-blue-600 text-blue-600":"border-transparent text-slate-600 hover:text-slate-900"}`,children:"åŸºæœ¬ä¿¡æ¯"}),e.jsxs("button",{onClick:()=>n("members"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m==="members"?"border-blue-600 text-blue-600":"border-transparent text-slate-600 hover:text-slate-900"}`,children:["æˆå‘˜ç®¡ç† (",x.length,")"]}),e.jsxs("button",{onClick:()=>n("skills"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m==="skills"?"border-blue-600 text-blue-600":"border-transparent text-slate-600 hover:text-slate-900"}`,children:["æŠ€èƒ½å®šä¹‰ (",s.length,")"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50",children:[m==="basic"&&e.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"åŸºæœ¬é…ç½®"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"èµ„æºåç§°"}),e.jsx("input",{type:"text",value:a.name||"",onChange:h=>u({...a,name:h.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"æ€»å®¹é‡ (äººæ•°)"}),e.jsx("input",{type:"number",value:a.totalQuantity||0,onChange:h=>u({...a,totalQuantity:parseInt(h.target.value)}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"æ³¨æ„ï¼šä¿®æ”¹æ€»å®¹é‡ä¸ä¼šè‡ªåŠ¨æ·»åŠ æˆ–åˆ é™¤æˆå‘˜è®°å½•ã€‚"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"å•ä½æˆæœ¬ (æ¯äººæœˆ)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-slate-500",children:"$"}),e.jsx("input",{type:"number",value:a.costPerUnit||0,onChange:h=>u({...a,costPerUnit:parseFloat(h.target.value)}),className:"w-full pl-8 pr-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"pt-4 border-t border-slate-100 flex justify-end",children:e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(X,{size:18}),e.jsx("span",{children:"ä¿å­˜æ›´æ”¹"})]})})]})]}),m==="members"&&e.jsxs("div",{className:"flex h-full gap-6",children:[e.jsxs("div",{className:"w-1/3 bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"æˆå‘˜åˆ—è¡¨"}),e.jsx("button",{onClick:f,className:"p-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:e.jsx(te,{size:18})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:[x.map(h=>e.jsxs("div",{onClick:()=>g(h),className:`p-3 rounded-lg cursor-pointer transition-colors flex items-center justify-between group ${(i==null?void 0:i.id)===h.id?"bg-blue-50 border border-blue-200":"hover:bg-slate-50 border border-transparent"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-slate-600 text-xs font-bold",children:h.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-slate-900",children:h.name}),e.jsx("div",{className:"text-xs text-slate-500",children:h.role})]})]}),e.jsx("button",{onClick:C=>{C.stopPropagation(),w(h.id)},className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-500 hover:bg-red-50 rounded transition-all",children:e.jsx(me,{size:14})})]},h.id)),x.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-500 text-sm",children:"æš‚æ— æˆå‘˜ï¼Œç‚¹å‡»å³ä¸Šè§’æ·»åŠ "})]})]}),e.jsx("div",{className:"flex-1 bg-white rounded-xl shadow-sm border border-slate-200 p-6 overflow-y-auto",children:i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"ç¼–è¾‘æˆå‘˜ä¿¡æ¯"}),e.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(X,{size:16}),e.jsx("span",{children:"ä¿å­˜åˆ—è¡¨"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"å§“å"}),e.jsx("input",{type:"text",value:i.name,onChange:h=>y(i.id,{name:h.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"èŒä½/è§’è‰²"}),e.jsx("input",{type:"text",value:i.role,onChange:h=>y(i.id,{role:h.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"é‚®ç®±"}),e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),e.jsx("input",{type:"email",value:i.email||"",onChange:h=>y(i.id,{email:h.target.value}),className:"w-full pl-9 pr-3 py-2 border border-slate-300 rounded-lg",placeholder:"email@example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"ç”µè¯"}),e.jsxs("div",{className:"relative",children:[e.jsx(is,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),e.jsx("input",{type:"text",value:i.phone||"",onChange:h=>y(i.id,{phone:h.target.value}),className:"w-full pl-9 pr-3 py-2 border border-slate-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"å…¥èŒæ—¥æœŸ"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),e.jsx("input",{type:"date",value:i.joinDate||"",onChange:h=>y(i.id,{joinDate:h.target.value}),className:"w-full pl-9 pr-3 py-2 border border-slate-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"å¯ç”¨æ€§ (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:i.availability,onChange:h=>y(i.id,{availability:parseInt(h.target.value)}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"æŠ€èƒ½ (é€—å·åˆ†éš”)"}),e.jsx("textarea",{value:i.skills.join(", "),onChange:h=>y(i.id,{skills:h.target.value.split(",").map(C=>C.trim()).filter(Boolean)}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg h-24",placeholder:"React, TypeScript, Node.js..."})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400",children:[e.jsx(xe,{size:48,className:"mb-4 opacity-20"}),e.jsx("p",{children:"é€‰æ‹©å·¦ä¾§æˆå‘˜è¿›è¡Œç¼–è¾‘"})]})})]}),m==="skills"&&e.jsxs("div",{className:"max-w-3xl mx-auto bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"æŠ€èƒ½å®šä¹‰"}),e.jsxs("button",{onClick:()=>{const h={id:`skill-${Date.now()}`,name:"New Skill",level:"intermediate"};t([...s,h])},className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx(te,{size:16}),e.jsx("span",{children:"æ·»åŠ æŠ€èƒ½"})]})]}),e.jsxs("div",{className:"space-y-3",children:[s.map((h,C)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:h.name,onChange:z=>{const S=[...s];S[C].name=z.target.value,t(S)},className:"w-full px-2 py-1 bg-transparent border-b border-transparent focus:border-blue-500 focus:outline-none font-medium"})}),e.jsxs("select",{value:h.level,onChange:z=>{const S=[...s];S[C].level=z.target.value,t(S)},className:"px-2 py-1 bg-white border border-slate-200 rounded text-sm",children:[e.jsx("option",{value:"beginner",children:"åˆçº§"}),e.jsx("option",{value:"intermediate",children:"ä¸­çº§"}),e.jsx("option",{value:"advanced",children:"é«˜çº§"}),e.jsx("option",{value:"expert",children:"ä¸“å®¶"})]}),e.jsx("button",{onClick:()=>t(s.filter(z=>z.id!==h.id)),className:"text-red-500 hover:bg-red-50 p-1.5 rounded",children:e.jsx(me,{size:16})})]},h.id)),s.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-500",children:"æš‚æ— æŠ€èƒ½å®šä¹‰"})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-slate-100 flex justify-end",children:e.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(X,{size:18}),e.jsx("span",{children:"ä¿å­˜æŠ€èƒ½"})]})})]})]})]})})},ds=(d,o,l,b="smoothing")=>{let c=JSON.parse(JSON.stringify(o));const r=new Map(o.map(f=>[f.id,f])),m=[],n=Ue(c),a=new Date(Math.min(...c.map(f=>new Date(f.startDate).getTime()))),u=new Date(Math.max(...c.map(f=>new Date(f.endDate).getTime()))),x=J(u,a);let j=0,s=0;c.sort((f,w)=>new Date(f.startDate).getTime()-new Date(w.startDate).getTime());const t=new Set;let i=u,g=new Date(a);const v=x*2+365;let k=0;for(;k<v&&!(g>i&&b==="smoothing"||t.size===c.length&&g>i);){const f=$(g,"yyyy-MM-dd");l.forEach(w=>{const y=w.totalQuantity,h=c.filter(C=>C.assignee===w.id&&C.startDate<=f&&C.endDate>=f);if(h.length>y){const C=h.length-y;s=Math.max(s,C),h.sort((S,D)=>{const R=n.criticalPath.includes(S.id),M=n.criticalPath.includes(D.id);if(R!==M)return R?1:-1;const ce={P0:3,P1:2,P2:1,P3:0},oe=S.priority&&ce[S.priority]||0,de=D.priority&&ce[D.priority]||0;return oe!==de?oe-de:0});let z=0;for(const S of h){if(z>=C)break;const D=n.slack[S.id]||0;if(b==="smoothing"){if(D>0){const R=O(E(S.startDate),1),M=O(E(S.endDate),1);S.startDate=$(R,"yyyy-MM-dd"),S.endDate=$(M,"yyyy-MM-dd"),z++,j++}}else if(b==="leveling"){const R=O(E(S.startDate),1),M=O(E(S.endDate),1);S.startDate=$(R,"yyyy-MM-dd"),S.endDate=$(M,"yyyy-MM-dd"),M>i&&(i=M),z++,j++}}}}),g=O(g,1),k++}c.forEach(f=>{const w=r.get(f.id);if(w&&w.startDate!==f.startDate){const y=J(E(f.startDate),E(w.startDate));m.push({taskId:f.id,taskName:f.name,originalStart:w.startDate,newStart:f.startDate,delay:y,reason:b==="smoothing"?"èµ„æºå¹³æ»‘ï¼ˆåˆ©ç”¨æµ®åŠ¨æ—¶é—´ï¼‰":"èµ„æºå¹³è¡¡ï¼ˆè§£å†³å†²çªï¼‰"})}});const p=J(i,a);return{optimizedTasks:c,changes:m,metrics:{originalDuration:x,newDuration:p,conflictsResolved:j,resourcePeakReduced:s}}},xs=({project:d,tasks:o,resourcePool:l,onApplyChanges:b})=>{const[c,r]=N.useState("smoothing"),[m,n]=N.useState(!1),[a,u]=N.useState(null),x=()=>{n(!0),setTimeout(()=>{const s=ds(d,o,l,c);u(s),n(!1)},500)},j=()=>{a&&(b(a.optimizedTasks),u(null))};return e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Be,{size:20,className:"text-blue-600"}),e.jsx("h3",{className:"font-semibold text-slate-900",children:"æ™ºèƒ½è¿›åº¦è°ƒåº¦"})]}),e.jsx("p",{className:"text-sm text-slate-500",children:"è‡ªåŠ¨è°ƒæ•´ä»»åŠ¡æ—¶é—´ä»¥è§£å†³èµ„æºå†²çªå¹¶ä¼˜åŒ–å·¥æœŸ"})]}),e.jsxs("div",{className:"p-6 border-b border-slate-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>r("smoothing"),className:`p-4 rounded-lg border-2 text-left transition-all ${c==="smoothing"?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"èµ„æºå¹³æ»‘ (Smoothing)"}),c==="smoothing"&&e.jsx(L,{size:18,className:"text-blue-600"})]}),e.jsxs("p",{className:"text-sm text-slate-600",children:["åˆ©ç”¨ä»»åŠ¡æµ®åŠ¨æ—¶é—´è°ƒæ•´è¿›åº¦ï¼Œ",e.jsx("span",{className:"font-medium text-blue-700",children:"ä¸å»¶é•¿é¡¹ç›®å·¥æœŸ"}),"ã€‚é€‚ç”¨äºŽèµ„æºæœ‰é™ä½†å·¥æœŸå›ºå®šçš„åœºæ™¯ã€‚"]})]}),e.jsxs("button",{onClick:()=>r("leveling"),className:`p-4 rounded-lg border-2 text-left transition-all ${c==="leveling"?"border-purple-500 bg-purple-50":"border-slate-200 hover:border-purple-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"èµ„æºå¹³è¡¡ (Leveling)"}),c==="leveling"&&e.jsx(L,{size:18,className:"text-purple-600"})]}),e.jsxs("p",{className:"text-sm text-slate-600",children:["å½»åº•è§£å†³èµ„æºå†²çªï¼Œå¯èƒ½",e.jsx("span",{className:"font-medium text-purple-700",children:"å»¶é•¿é¡¹ç›®å·¥æœŸ"}),"ã€‚é€‚ç”¨äºŽèµ„æºåˆšæ€§çº¦æŸçš„åœºæ™¯ã€‚"]})]})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("button",{onClick:x,disabled:m,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-2 font-medium",children:m?e.jsxs(e.Fragment,{children:[e.jsx(De,{size:18,className:"animate-spin"}),"æ­£åœ¨è®¡ç®—æœ€ä¼˜è§£..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ke,{size:18}),"å¼€å§‹ä¼˜åŒ–è®¡ç®—"]})})})]}),a&&e.jsxs("div",{className:"p-6 bg-slate-50 animate-in fade-in slide-in-from-top-4 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:"ä¼˜åŒ–æ–¹æ¡ˆé¢„è§ˆ"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u(null),className:"px-3 py-1.5 text-slate-600 hover:text-slate-900 text-sm font-medium",children:"æ”¾å¼ƒ"}),e.jsxs("button",{onClick:j,className:"px-4 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium flex items-center gap-2",children:[e.jsx(L,{size:16}),"åº”ç”¨æ–¹æ¡ˆ"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"é¡¹ç›®å·¥æœŸ"}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("span",{className:"text-xl font-bold text-slate-900",children:[a.metrics.newDuration," å¤©"]}),e.jsxs("span",{className:`text-xs mb-1 ${a.metrics.newDuration>a.metrics.originalDuration?"text-red-600":"text-green-600"}`,children:["(",a.metrics.newDuration-a.metrics.originalDuration>0?"+":"",a.metrics.newDuration-a.metrics.originalDuration," å¤©)"]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"è§£å†³å†²çª"}),e.jsxs("div",{className:"text-xl font-bold text-green-600",children:[a.metrics.conflictsResolved," ä¸ª"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"èµ„æºå³°å€¼å‰Šå‡"}),e.jsxs("div",{className:"text-xl font-bold text-blue-600",children:[a.metrics.resourcePeakReduced," å•ä½"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-200 bg-slate-50 font-medium text-sm text-slate-700",children:["å˜æ›´è¯¦æƒ… (",a.changes.length,")"]}),e.jsx("div",{className:"max-h-64 overflow-y-auto divide-y divide-slate-100",children:a.changes.length===0?e.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"æ²¡æœ‰éœ€è¦è°ƒæ•´çš„ä»»åŠ¡ï¼Œå½“å‰è®¡åˆ’å·²æ˜¯æœ€ä¼˜ã€‚"}):a.changes.map((s,t)=>e.jsxs("div",{className:"p-4 hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-slate-900 text-sm",children:s.taskName}),e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-orange-100 text-orange-700 rounded",children:["æŽ¨è¿Ÿ ",s.delay," å¤©"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(_,{size:12}),e.jsx("span",{children:s.originalStart}),e.jsx(Me,{size:12}),e.jsx("span",{className:"text-slate-900 font-medium",children:s.newStart})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-400",children:["åŽŸå› : ",s.reason]})]},t))})]}),c==="leveling"&&a.metrics.newDuration>a.metrics.originalDuration&&e.jsxs("div",{className:"mt-4 flex items-start gap-2 p-3 bg-yellow-50 text-yellow-800 rounded-lg text-sm",children:[e.jsx(K,{size:16,className:"mt-0.5 flex-shrink-0"}),e.jsxs("p",{children:["æ³¨æ„ï¼šä¸ºäº†è§£å†³èµ„æºå†²çªï¼Œé¡¹ç›®æ€»å·¥æœŸå»¶é•¿äº† ",a.metrics.newDuration-a.metrics.originalDuration," å¤©ã€‚ è¯·ç¡®è®¤è¿™æ˜¯å¦ç¬¦åˆé¡¹ç›®äº¤ä»˜è¦æ±‚ã€‚"]})]})]})]})},ms=()=>{var k;const d=ne(),o=ie(),{updateProject:l,addNotification:b}=T(),[c,r]=N.useState("month"),[m,n]=N.useState(null),[a,u]=N.useState(!1),[x,j]=N.useState(null),s=N.useMemo(()=>ke(d,12,c),[d,c]),t=N.useMemo(()=>Se(d,o,s,c),[d,o,s,c]),i=N.useMemo(()=>{var z;const p=o.reduce((S,D)=>S+(D.totalQuantity||0),0),f=(z=s[0])==null?void 0:z.label;let w=0,y=0,h=0;t.forEach(S=>{const D=S.allocations[f],R=D?D.total:0;w+=R;const M=S.capacity>0?R/S.capacity*100:0;M>100&&y++,M<50&&h++});const C=p>0?w/p*100:0;return{totalResources:p,totalUsed:w,avgUtilization:C,overallocated:y,underutilized:h,available:p-w}},[o,t,s]),g=N.useMemo(()=>t.map(p=>{var C;const f=(C=s[0])==null?void 0:C.label,w=p.allocations[f],y=w?w.total:0,h=p.capacity>0?y/p.capacity*100:0;return{id:p.resourceId,name:p.resourceName,utilization:Math.round(h),capacity:p.capacity,used:y}}),[t,s]),v=N.useMemo(()=>s.slice(0,6).map(p=>{let f=0,w=0;return t.forEach(y=>{const h=y.allocations[p.label];f+=h?h.total:0,w+=y.capacity}),{name:p.label,utilization:w>0?Math.round(f/w*100):0,used:f,capacity:w}}),[t,s]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"èµ„æºæ€»è§ˆ"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"å®žæ—¶ç›‘æŽ§èµ„æºåˆ†é…å’Œåˆ©ç”¨æƒ…å†µ"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("select",{value:c,onChange:p=>r(p.target.value),className:"px-4 py-2 border border-slate-200 rounded-lg bg-white",children:[e.jsx("option",{value:"week",children:"æœ¬å‘¨"}),e.jsx("option",{value:"month",children:"æœ¬æœˆ"}),e.jsx("option",{value:"quarter",children:"æœ¬å­£åº¦"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(H,{className:"text-blue-600",size:24})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"æ€»èµ„æº"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:i.totalResources}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["ä½¿ç”¨ä¸­: ",i.totalUsed," (",Math.round(i.avgUtilization),"%)"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(V,{className:"text-green-600",size:24})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"å¹³å‡åˆ©ç”¨çŽ‡"})]}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900",children:[Math.round(i.avgUtilization),"%"]}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx("div",{className:"flex-1 h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${i.avgUtilization>90?"bg-red-500":i.avgUtilization>70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(i.avgUtilization,100)}%`}})})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(K,{className:"text-red-600",size:24})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"è¶…é¢åˆ†é…"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:i.overallocated}),e.jsx("div",{className:"text-sm text-slate-600 mt-1",children:i.overallocated>0?"éœ€è¦è°ƒæ•´":"çŠ¶æ€è‰¯å¥½"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(ue,{className:"text-purple-600",size:24})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"å¯ç”¨èµ„æº"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:i.available}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:[Math.round(i.available/i.totalResources*100),"% å¯ç”¨"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"èµ„æºåˆ©ç”¨çŽ‡"}),e.jsx(Re,{className:"text-slate-400",size:20})]}),e.jsx(le,{type:"bar",data:g,dataKey:"utilization",xKey:"name",height:300,colors:["#3B82F6","#10B981","#F59E0B","#EF4444"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"åˆ©ç”¨çŽ‡è¶‹åŠ¿"}),e.jsx(We,{className:"text-slate-400",size:20})]}),e.jsx(le,{type:"line",data:v,dataKey:"utilization",xKey:"name",height:300,colors:["#8B5CF6"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"èµ„æºè¯¦æƒ…"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"èµ„æºåç§°"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"æ€»å®¹é‡"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"å·²ä½¿ç”¨"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"å¯ç”¨"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"åˆ©ç”¨çŽ‡"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"çŠ¶æ€"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:g.map((p,f)=>{const w=p.capacity-p.used,y=p.utilization>100?"overallocated":p.utilization>80?"high":p.utilization>50?"normal":"low";return e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors cursor-pointer",onClick:()=>{n(p.id),u(!0)},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:p.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:p.capacity})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:p.used})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:w})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 max-w-[100px] h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${y==="overallocated"?"bg-red-500":y==="high"?"bg-yellow-500":y==="normal"?"bg-green-500":"bg-blue-500"}`,style:{width:`${Math.min(p.utilization,100)}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-slate-900",children:[p.utilization,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${y==="overallocated"?"bg-red-100 text-red-800":y==="high"?"bg-yellow-100 text-yellow-800":y==="normal"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:y==="overallocated"?"è¶…é¢":y==="high"?"é«˜è´Ÿè½½":y==="normal"?"æ­£å¸¸":"ä½Žè´Ÿè½½"})})]},f)})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"æ™ºèƒ½è¿›åº¦è°ƒåº¦"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"è‡ªåŠ¨ä¼˜åŒ–èµ„æºåˆ†é…ï¼Œè§£å†³å†²çª"})]}),e.jsxs("select",{value:x||"",onChange:p=>j(p.target.value||null),className:"px-4 py-2 border border-slate-200 rounded-lg bg-white",children:[e.jsx("option",{value:"",children:"é€‰æ‹©é¡¹ç›®..."}),d.filter(p=>p.status==="active").map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))]})]}),x?e.jsx(xs,{project:d.find(p=>p.id===x),tasks:((k=d.find(p=>p.id===x))==null?void 0:k.tasks)||[],resourcePool:o,onApplyChanges:p=>{const f=d.find(w=>w.id===x);f&&(l(x,{...f,tasks:p}),b({message:`é¡¹ç›®"${f.name}"çš„ä»»åŠ¡å·²æ ¹æ®ä¼˜åŒ–æ–¹æ¡ˆé‡æ–°è°ƒåº¦`,type:"success",duration:5e3}))}}):e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(ue,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"è¯·é€‰æ‹©ä¸€ä¸ªé¡¹ç›®ä»¥å¼€å§‹è°ƒåº¦ä¼˜åŒ–"})]})]}),m&&e.jsx(os,{isOpen:a,onClose:()=>u(!1),resourceId:m})]})},hs=({resourceLoads:d,buckets:o})=>{const l=N.useMemo(()=>d.map(r=>{const m=o.map(n=>{const a=r.allocations[n.label],u=a?a.total:0,x=r.capacity>0?u/r.capacity*100:0;return{month:n.label,used:u,capacity:r.capacity,utilization:x,projects:a?a.projects:[]}});return{resourceName:r.resourceName,cells:m}}),[d,o]),b=r=>r===0?"bg-slate-50":r<25?"bg-blue-100":r<50?"bg-green-100":r<75?"bg-yellow-100":r<100?"bg-orange-100":"bg-red-200",c=r=>r===0?"text-slate-400":r<25?"text-blue-700":r<50?"text-green-700":r<75?"text-yellow-700":r<100?"text-orange-700":"text-red-700";return e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"èµ„æºåˆ†é…çƒ­åŠ›å›¾"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"æŸ¥çœ‹èµ„æºåœ¨ä¸åŒæ—¶é—´æ®µçš„åˆ†é…æƒ…å†µ"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 bg-white z-10 px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-r border-slate-200",children:"èµ„æº"}),o.map((r,m)=>e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 min-w-[100px]",children:r.label},m))]})}),e.jsx("tbody",{children:l.map((r,m)=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"sticky left-0 bg-white z-10 px-4 py-3 font-medium text-sm text-slate-900 border-r border-slate-200",children:r.resourceName}),r.cells.map((n,a)=>e.jsxs("td",{className:`px-4 py-3 text-center border-r border-b border-slate-100 ${b(n.utilization)} transition-colors group relative`,children:[e.jsxs("div",{className:`text-sm font-semibold ${c(n.utilization)}`,children:[Math.round(n.utilization),"%"]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-0.5",children:[n.used,"/",n.capacity]}),n.projects.length>0&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block z-20",children:e.jsxs("div",{className:"bg-slate-900 text-white text-xs rounded-lg p-3 shadow-xl min-w-[200px]",children:[e.jsx("div",{className:"font-semibold mb-2",children:"åˆ†é…åˆ°çš„é¡¹ç›®:"}),n.projects.map((u,x)=>e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsx("span",{className:"truncate",children:u.name}),e.jsx("span",{className:"ml-2 font-mono",children:u.amount})]},x))]})})]},a))]},m))})]})}),e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-6",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"åˆ©ç”¨çŽ‡:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-slate-50 border border-slate-200 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"0%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"1-25%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"26-50%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"51-75%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"76-99%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-200 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"â‰¥100%"})]})]})]})},us=(d,o)=>{const l=[],c=He(new Date),r=pe(c,12),m=qe({start:c,end:r});return o.forEach(n=>{m.forEach(a=>{const u=$(a,"yyyy-MM"),x=[];let j=0;d.forEach(s=>{if(!s.startDate||!s.endDate||s.status==="completed")return;const t=E(s.startDate),i=E(s.endDate);if(!je(a,{start:t,end:i}))return;const v=(s.resourceRequirements||[]).find(w=>w.resourceId===n.id);if(!v)return;const k=v.count;let p=v.duration;v.unit==="day"&&(p=v.duration/30),v.unit==="year"&&(p=v.duration*12);const f=pe(t,p);je(a,{start:t,end:f})&&(x.push({projectId:s.id,projectName:s.name,allocation:k}),j+=k)}),j>n.totalQuantity&&l.push({resourceId:n.id,resourceName:n.name,period:u,capacity:n.totalQuantity,allocated:j,overallocation:j-n.totalQuantity,conflictingProjects:x})})}),l},ps=()=>{const{projects:d,resourcePool:o}=T(),{t:l}=ge(),b=N.useMemo(()=>us(d,o),[d,o]),c=N.useMemo(()=>{const a=new Map;return b.forEach(u=>{const x=a.get(u.resourceId)||[];a.set(u.resourceId,[...x,u])}),a},[b]),r=b.length,m=c.size,n=b.filter(a=>a.overallocation>a.capacity*.5).length;return r===0?e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-2xl border-2 border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(L,{className:"text-green-600",size:28}),e.jsx("h3",{className:"text-lg font-bold text-green-900",children:l("conflicts.noConflicts")})]}),e.jsx("p",{className:"text-green-700",children:l("conflicts.allResourcesOptimal")})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-red-50 p-6 rounded-2xl border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(K,{className:"text-red-600",size:24}),e.jsx("h4",{className:"font-bold text-red-900",children:l("conflicts.totalConflicts")})]}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:r}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:l("conflicts.periodsAffected")})]}),e.jsxs("div",{className:"bg-orange-50 p-6 rounded-2xl border border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(H,{className:"text-orange-600",size:24}),e.jsx("h4",{className:"font-bold text-orange-900",children:l("conflicts.affectedResources")})]}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:m}),e.jsx("p",{className:"text-sm text-orange-700 mt-1",children:l("conflicts.resourceTypes")})]}),e.jsxs("div",{className:"bg-yellow-50 p-6 rounded-2xl border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(K,{className:"text-yellow-600",size:24}),e.jsx("h4",{className:"font-bold text-yellow-900",children:l("conflicts.critical")})]}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:n}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:l("conflicts.over50Percent")})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 bg-gradient-to-r from-red-50 to-orange-50",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:l("conflicts.detailedView")}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:l("conflicts.reviewAndResolve")})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:Array.from(c.entries()).map(([a,u])=>{const x=o.find(j=>j.id===a);return x?e.jsxs("div",{className:"p-6 hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 text-lg",children:x.name}),e.jsxs("p",{className:"text-sm text-slate-500",children:[l("conflicts.capacity"),": ",x.totalQuantity," ",l("conflicts.units")]})]}),e.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-bold",children:[u.length," ",l("conflicts.conflicts")]})]}),e.jsx("div",{className:"space-y-3",children:u.map((j,s)=>e.jsxs("div",{className:"bg-red-50 p-4 rounded-xl border border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"text-red-600",size:18}),e.jsx("span",{className:"font-bold text-red-900",children:j.period})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-red-700",children:[l("conflicts.overallocated"),":",e.jsxs("span",{className:"font-bold ml-1",children:["+",j.overallocation," (",(j.overallocation/j.capacity*100).toFixed(0),"%)"]})]}),e.jsxs("div",{className:"text-xs text-red-600",children:[j.allocated," / ",j.capacity," ",l("conflicts.allocated")]})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"h-3 bg-red-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-red-600 transition-all",style:{width:`${Math.min(j.allocated/j.capacity*100,100)}%`}})})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-bold text-red-800 mb-2",children:[l("conflicts.conflictingProjects"),":"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:j.conflictingProjects.map(t=>e.jsxs("div",{className:"px-3 py-1 bg-white border border-red-300 rounded-lg text-xs",children:[e.jsx("span",{className:"font-medium text-slate-900",children:t.projectName}),e.jsxs("span",{className:"text-red-600 ml-2",children:["(",t.allocation," ",l("conflicts.units"),")"]})]},t.projectId))})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-red-300",children:e.jsxs("p",{className:"text-xs text-red-800",children:[e.jsxs("span",{className:"font-bold",children:["ðŸ’¡ ",l("conflicts.recommendation"),":"]}),j.overallocation>j.capacity*.5?l("conflicts.criticalRecommendation"):l("conflicts.moderateRecommendation")]})})]},`${j.period}-${s}`))})]},a):null})})]})]})},fe={beginner:1,intermediate:2,advanced:3,expert:4},ze=(d,o,l="intermediate")=>{if(!o||o.length===0)return{matchScore:100,matchedSkills:[],missingSkills:[],qualifiedSkills:[]};if(!d||d.length===0)return{matchScore:0,matchedSkills:[],missingSkills:o,qualifiedSkills:[]};const b=fe[l],c=[],r=[],m=[];o.forEach(x=>{const j=d.find(s=>s.id===x);j?(c.push(x),fe[j.level]>=b&&r.push(x)):m.push(x)});const n=c.length/o.length*100,a=r.length/o.length*20;return{matchScore:Math.min(n+a,100),matchedSkills:c,missingSkills:m,qualifiedSkills:r}},bs=(d,o,l=60)=>o.map(c=>{const r=ze(c.skills||[],d.requiredSkills||[]);return{resourceId:c.id,resourceName:c.name,matchScore:r.matchScore,matchDetails:r}}).filter(c=>c.matchScore>=l).sort((c,r)=>r.matchScore-c.matchScore),js=(d,o)=>{const l=new Map;let b=0,c=0,r=0,m=0;d.forEach(u=>{(u.resourceRequirements||[]).forEach(x=>{if(!x.requiredSkills||x.requiredSkills.length===0)return;b++;const j=o.find(t=>t.id===x.resourceId);if(!j){m++,x.requiredSkills.forEach(t=>{const i=l.get(t)||{occurrences:0,projects:[]};l.set(t,{occurrences:i.occurrences+1,projects:[...i.projects,u.name]})});return}const s=ze(j.skills||[],x.requiredSkills);s.matchScore===100?c++:s.matchScore>0?(r++,s.missingSkills.forEach(t=>{const i=l.get(t)||{occurrences:0,projects:[]};l.set(t,{occurrences:i.occurrences+1,projects:[...i.projects,u.name]})})):(m++,x.requiredSkills.forEach(t=>{const i=l.get(t)||{occurrences:0,projects:[]};l.set(t,{occurrences:i.occurrences+1,projects:[...i.projects,u.name]})}))})});const n=Array.from(l.entries()).map(([u,x])=>({skillId:u,occurrences:x.occurrences,projects:x.projects})).sort((u,x)=>x.occurrences-u.occurrences),a=[];if(n.length>0){const u=n[0];a.push(`Consider hiring or training resources with "${u.skillId}" skill (needed in ${u.occurrences} projects)`)}return m>b*.3&&a.push(`High skill mismatch rate (${(m/b*100).toFixed(0)}%). Review resource allocation strategy.`),r>c&&a.push("Many partial matches detected. Consider upskilling existing resources."),{totalRequirements:b,fullyMatched:c,partiallyMatched:r,unmatched:m,missingSkills:n,recommendations:a}},fs=()=>{const{projects:d,resourcePool:o}=T(),{t:l}=ge(),[b,c]=N.useState(""),[r,m]=N.useState(60),n=N.useMemo(()=>js(d,o),[d,o]),a=d.find(t=>t.id===b),u=N.useMemo(()=>{var i;if(!a||!((i=a.resourceRequirements)!=null&&i.length))return[];const t=[];return(a.resourceRequirements||[]).forEach(g=>{if(g.requiredSkills&&g.requiredSkills.length>0){const v=bs(g,o,r);t.push({requirement:g,recommendations:v})}}),t},[a,o,r]),x=n.totalRequirements>0?(n.fullyMatched+n.partiallyMatched)/n.totalRequirements*100:100,j=t=>{switch(t){case"beginner":return"bg-blue-100 text-blue-700";case"intermediate":return"bg-green-100 text-green-700";case"advanced":return"bg-orange-100 text-orange-700";case"expert":return"bg-purple-100 text-purple-700";default:return"bg-slate-100 text-slate-700"}},s=t=>({beginner:l("skills.beginner"),intermediate:l("skills.intermediate"),advanced:l("skills.advanced"),expert:l("skills.expert")})[t]||t;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 p-6 rounded-2xl border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ce,{className:"text-blue-600",size:24}),e.jsx("h4",{className:"font-bold text-blue-900",children:l("skills.totalRequirements")})]}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:n.totalRequirements}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:l("skills.acrossProjects")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-2xl border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ls,{className:"text-green-600",size:24}),e.jsx("h4",{className:"font-bold text-green-900",children:l("skills.fullyMatched")})]}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:n.fullyMatched}),e.jsxs("p",{className:"text-sm text-green-700 mt-1",children:[n.totalRequirements>0?`${(n.fullyMatched/n.totalRequirements*100).toFixed(0)}%`:"0%"," ",l("skills.perfect")]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 p-6 rounded-2xl border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(V,{className:"text-yellow-600",size:24}),e.jsx("h4",{className:"font-bold text-yellow-900",children:l("skills.partialMatches")})]}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:n.partiallyMatched}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:l("skills.needsImprovement")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 p-6 rounded-2xl border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(W,{className:"text-red-600",size:24}),e.jsx("h4",{className:"font-bold text-red-900",children:l("skills.unmatched")})]}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:n.unmatched}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:l("skills.criticalGaps")})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-100",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:l("skills.overallMatchRate")}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"h-8 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-500 transition-all duration-500 flex items-center justify-end pr-4",style:{width:`${x}%`},children:e.jsxs("span",{className:"text-white font-bold text-sm",children:[x.toFixed(1),"%"]})})})})]}),n.missingSkills.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(rs,{className:"text-orange-600",size:24}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:l("skills.topMissingSkills")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.missingSkills.slice(0,9).map((t,i)=>e.jsxs("div",{className:"p-4 bg-orange-50 rounded-xl border border-orange-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:t.skillId}),e.jsxs("span",{className:"px-2 py-1 bg-orange-200 text-orange-800 rounded-full text-xs font-bold",children:["#",i+1]})]}),e.jsxs("p",{className:"text-sm text-slate-600 mb-2",children:[l("skills.neededIn")," ",e.jsx("span",{className:"font-bold text-orange-600",children:t.occurrences})," ",l("skills.projects")]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.projects.slice(0,3).map((g,v)=>e.jsx("span",{className:"text-xs bg-white px-2 py-1 rounded border border-orange-300",children:g.length>15?g.substring(0,15)+"...":g},v)),t.projects.length>3&&e.jsxs("span",{className:"text-xs text-orange-600 px-2 py-1",children:["+",t.projects.length-3," ",l("skills.more")]})]})]},t.skillId))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(H,{className:"text-blue-600",size:24}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:l("skills.resourceRecommendations")})]}),e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:l("skills.selectProject")}),e.jsxs("select",{value:b,onChange:t=>c(t.target.value),className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:l("skills.chooseProject")}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"w-full md:w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:l("skills.minMatchScore")}),e.jsx("input",{type:"number",min:"0",max:"100",value:r,onChange:t=>m(parseInt(t.target.value)||0),className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),a&&u.length>0?e.jsx("div",{className:"space-y-6",children:u.map((t,i)=>{const g=o.find(v=>v.id===t.requirement.resourceId);return e.jsxs("div",{className:"border border-slate-200 rounded-xl p-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("h4",{className:"font-bold text-slate-900",children:[l("skills.requirement")," #",i+1,": ",(g==null?void 0:g.name)||l("skills.unknownResource")]}),t.requirement.requiredSkills&&t.requirement.requiredSkills.length>0&&e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:[l("skills.requiredSkills"),": ",t.requirement.requiredSkills.join(", ")]})]}),t.recommendations.length>0?e.jsx("div",{className:"space-y-2",children:t.recommendations.map((v,k)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-bold text-slate-900",children:v.resourceName}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:v.matchDetails.matchedSkills.map(p=>{var y;const f=o.find(h=>h.id===v.resourceId),w=(y=f==null?void 0:f.skills)==null?void 0:y.find(h=>h.id===p);return w?e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${j(w.level)}`,children:[w.name," (",s(w.level),")"]},p):null})}),v.matchDetails.missingSkills.length>0&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:[l("skills.missing"),": ",v.matchDetails.missingSkills.join(", ")]})]}),e.jsxs("div",{className:"ml-4 text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[v.matchScore.toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-slate-500",children:l("skills.match")})]})]},k))}):e.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:l("skills.noRecommendations")})]},i)})}):a?e.jsx("p",{className:"text-slate-500 text-center py-8",children:l("skills.noRequirements")}):e.jsx("p",{className:"text-slate-500 text-center py-8",children:l("skills.selectProjectPrompt")})]}),n.recommendations.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-2xl border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(W,{className:"text-purple-600",size:24}),e.jsx("h3",{className:"text-lg font-bold text-purple-900",children:l("skills.actionableRecommendations")})]}),e.jsx("div",{className:"space-y-3",children:n.recommendations.map((t,i)=>e.jsxs("div",{className:"flex gap-3 p-4 bg-white rounded-xl border border-purple-300",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ’¡"}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:t})]},i))})]})]})},gs=(d,o)=>{const l=["èµ„æºåç§°","æ€»å®¹é‡",...o.map(a=>a.label),"å¹³å‡åˆ©ç”¨çŽ‡"],b=d.map(a=>{const u=o.map(j=>{const s=a.allocations[j.label],t=s?s.total:0,i=a.capacity>0?t/a.capacity*100:0;return`${Math.round(i)}%`}),x=o.reduce((j,s)=>{const t=a.allocations[s.label],i=t?t.total:0,g=a.capacity>0?i/a.capacity*100:0;return j+g},0)/o.length;return[a.resourceName,a.capacity.toString(),...u,`${Math.round(x)}%`]}),c=[l.join(","),...b.map(a=>a.join(","))].join(`
`),r=new Blob(["\uFEFF"+c],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a"),n=URL.createObjectURL(r);m.setAttribute("href",n),m.setAttribute("download",`èµ„æºåˆ©ç”¨çŽ‡_${new Date().toISOString().split("T")[0]}.csv`),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m)},Ns=d=>{const o=["èµ„æºåç§°","æ€»æ•°é‡","å·²åˆ†é…","å¯ç”¨","æŠ€èƒ½"],l=d.map(n=>{var j;const a=((j=n.skills)==null?void 0:j.map(s=>s.name).join("; "))||"",u=0,x=n.totalQuantity-u;return[n.name,n.totalQuantity.toString(),u.toString(),x.toString(),a]}),b=[o.join(","),...l.map(n=>n.map(a=>`"${a}"`).join(","))].join(`
`),c=new Blob(["\uFEFF"+b],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),m=URL.createObjectURL(c);r.setAttribute("href",m),r.setAttribute("download",`èµ„æºæ± _${new Date().toISOString().split("T")[0]}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)},vs=(d,o)=>{const l=JSON.stringify(d,null,2),b=new Blob([l],{type:"application/json"}),c=document.createElement("a"),r=URL.createObjectURL(b);c.setAttribute("href",r),c.setAttribute("download",`${o}_${new Date().toISOString().split("T")[0]}.json`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)},ys=({isOpen:d,onClose:o})=>{const{addResource:l}=T(),[b,c]=N.useState({name:"",totalQuantity:1}),r=n=>{if(n.preventDefault(),!b.name.trim()){alert("è¯·è¾“å…¥èµ„æºåç§°");return}if(b.totalQuantity<=0){alert("èµ„æºæ•°é‡å¿…é¡»å¤§äºŽ0");return}const a={id:`resource-${Date.now()}`,name:b.name.trim(),totalQuantity:b.totalQuantity,skills:[],members:[]};l(a),c({name:"",totalQuantity:1}),o()},m=()=>{c({name:"",totalQuantity:1}),o()};return d?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:m}),e.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"æ·»åŠ èµ„æº"}),e.jsx("button",{onClick:m,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(re,{size:20,className:"text-slate-500"})})]}),e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["èµ„æºåç§° ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:b.name,onChange:n=>c({...b,name:n.target.value}),placeholder:"ä¾‹å¦‚ï¼šå¼€å‘å·¥ç¨‹å¸ˆã€è®¾è®¡å¸ˆ",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["æ€»æ•°é‡ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"1",value:b.totalQuantity,onChange:n=>c({...b,totalQuantity:parseInt(n.target.value)||1}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:m,className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"å–æ¶ˆ"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:"æ·»åŠ "})]})]})]})]}):null},ws=(d,o,l)=>{const b=d.resourceRequirements||[],c=d.actualResourceUsage||[],r={};return b.forEach(m=>{const n=l.find(u=>u.id===m.resourceId),a=(o==="department"?n==null?void 0:n.department:n==null?void 0:n.category)||"Other";r[a]||(r[a]={planned:0,actual:0}),r[a].planned+=m.count}),c.forEach(m=>{const n=(o==="department"?m.department:m.category)||"Other";r[n]||(r[n]={planned:0,actual:0}),r[n].actual+=m.count}),Object.entries(r).map(([m,n])=>({name:m,planned:Number(n.planned.toFixed(1)),actual:Number(n.actual.toFixed(1)),variance:Number((n.actual-n.planned).toFixed(1)),variancePercent:n.planned>0?Number(((n.actual-n.planned)/n.planned*100).toFixed(1)):0}))},A=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4"],ks=()=>{var x,j;const d=ne(),o=ie(),[l,b]=N.useState(((x=d[0])==null?void 0:x.id)||"all"),[c,r]=N.useState("category"),m=N.useMemo(()=>d.find(s=>s.id===l),[d,l]),n=N.useMemo(()=>m?ws(m,c,o):[],[m,c,o]),a=N.useMemo(()=>{const s={};return d.forEach(t=>{(t.actualResourceUsage||[]).forEach(g=>{const v=(c==="department"?g.department:g.category)||"Other";s[v]||(s[v]={total:0,projects:[]}),s[v].total+=g.count,s[v].projects.push({name:t.name,value:g.count})})}),Object.entries(s).map(([t,i])=>({name:t,value:Number(i.total.toFixed(1)),projects:i.projects})).sort((t,i)=>i.value-t.value)},[d,c]),u=N.useMemo(()=>a.map(s=>{const t=d.reduce((i,g)=>{var k;const v=((k=g.resourceRequirements)==null?void 0:k.filter(p=>{const f=o.find(w=>w.id===p.resourceId);return(c==="department"?f==null?void 0:f.department:f==null?void 0:f.category)===s.name}))||[];return i+v.reduce((p,f)=>p+f.count,0)},0);return{name:s.name,actual:s.value,planned:Number(t.toFixed(1)),efficiency:t>0?Number((s.value/t*100).toFixed(1)):100}}),[a,d,o,c]);return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-700",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(P,{className:"p-5 bg-gradient-to-br from-blue-500/10 to-indigo-500/5 border-blue-100 dark:border-blue-900/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 text-blue-600 dark:text-blue-400",children:[e.jsx(H,{size:20}),e.jsx("span",{className:"text-sm font-semibold uppercase tracking-wider",children:"æ€»äººåŠ›æŠ•å…¥ (Actual)"})]}),e.jsxs("div",{className:"text-3xl font-extrabold text-slate-900 dark:text-slate-100",children:[u.reduce((s,t)=>s+t.actual,0).toFixed(1),e.jsx("span",{className:"text-sm font-normal text-slate-500 ml-1",children:"äººå¤©/æœˆ"})]})]}),e.jsxs(P,{className:"p-5 bg-gradient-to-br from-emerald-500/10 to-teal-500/5 border-emerald-100 dark:border-emerald-900/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 text-emerald-600 dark:text-emerald-400",children:[e.jsx(V,{size:20}),e.jsx("span",{className:"text-sm font-semibold uppercase tracking-wider",children:"èµ„æºåå·®çŽ‡"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("div",{className:"text-3xl font-extrabold text-slate-900 dark:text-slate-100",children:[(()=>{const s=u.reduce((i,g)=>i+g.planned,0),t=u.reduce((i,g)=>i+g.actual,0);return s>0?((t-s)/s*100).toFixed(1):"0"})(),"%"]}),e.jsx(ae,{variant:"warning",size:"sm",children:"Attention"})]})]}),e.jsxs(P,{className:"p-5 bg-gradient-to-br from-purple-500/10 to-pink-500/5 border-purple-100 dark:border-purple-900/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 text-purple-600 dark:text-purple-400",children:[e.jsx(Pe,{size:20}),e.jsx("span",{className:"text-sm font-semibold uppercase tracking-wider",children:"æ ¸å¿ƒéƒ¨é—¨ (Top)"})]}),e.jsx("div",{className:"text-3xl font-extrabold text-slate-900 dark:text-slate-100",children:((j=a[0])==null?void 0:j.name)||"N/A"})]}),e.jsxs(P,{className:"p-5 bg-gradient-to-br from-amber-500/10 to-orange-500/5 border-amber-100 dark:border-amber-900/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 text-amber-600 dark:text-amber-400",children:[e.jsx(W,{size:20}),e.jsx("span",{className:"text-sm font-semibold uppercase tracking-wider",children:"è´Ÿè½½é¢„è­¦"})]}),e.jsxs("div",{className:"text-3xl font-extrabold text-slate-900 dark:text-slate-100",children:[u.filter(s=>s.efficiency>110).length,e.jsx("span",{className:"text-sm font-normal text-red-500 ml-1",children:"è¶…æ”¯åˆ†ç±»"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-900 rounded-xl p-1 p-1",children:[e.jsx("button",{onClick:()=>r("category"),className:`px-4 py-2 text-sm font-bold rounded-lg transition-all ${c==="category"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"æŒ‰æŠ€æœ¯æ ˆ"}),e.jsx("button",{onClick:()=>r("department"),className:`px-4 py-2 text-sm font-bold rounded-lg transition-all ${c==="department"?"bg-white dark:bg-slate-700 text-blue-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"æŒ‰éƒ¨é—¨"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-500",children:"ä¸»è§†å›¾é¡¹ç›®:"}),e.jsx("select",{value:l,onChange:s=>b(s.target.value),className:"bg-slate-50 dark:bg-slate-900 border-none text-sm font-bold rounded-lg focus:ring-2 ring-blue-500 py-2 pl-3 pr-8",children:d.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(he,{size:16}),e.jsx("span",{className:"text-xs italic",children:"æ•°æ®æ¯ 15 åˆ†é’ŸåŒæ­¥ä¸€æ¬¡ï¼Œæ”¯æŒè·¨é¡¹ç›®åå·®åˆ†æž"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(P,{className:"p-6 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"é¢„æœŸ vs å®žé™…æŠ•å…¥ (é¡¹ç›®çº§)"}),e.jsx("p",{className:"text-sm text-slate-500",children:"å¯¹æ¯”å½“å‰æ‰€é€‰é¡¹ç›®çš„èµ„æºåˆ†é…æ•ˆèƒ½"})]}),m&&e.jsx(ae,{variant:m.status==="active"?"success":"neutral",children:m.status})]}),e.jsx("div",{className:"h-[400px]",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(we,{data:n,layout:"vertical",margin:{left:20},children:[e.jsx(Y,{strokeDasharray:"3 3",horizontal:!0,vertical:!1,stroke:"#e2e8f0"}),e.jsx(Z,{type:"number",hide:!0}),e.jsx(ee,{dataKey:"name",type:"category",width:100,tick:{fontSize:12,fontWeight:600,fill:"#64748b"},axisLine:!1,tickLine:!1}),e.jsx(F,{cursor:{fill:"#f8fafc"},contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"}}),e.jsx(B,{wrapperStyle:{paddingTop:"20px"}}),e.jsx(se,{dataKey:"planned",name:"é¢„è®¡æŠ•å…¥",fill:"#94a3b8",radius:[0,4,4,0],barSize:20}),e.jsx(se,{dataKey:"actual",name:"å®žé™…æŠ•å…¥",fill:"#3b82f6",radius:[0,4,4,0],barSize:20})]})})}),e.jsx("div",{className:"mt-8 grid grid-cols-2 gap-4",children:n.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-900/50 rounded-xl border border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:A[t%A.length]}}),e.jsx("span",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:s.name})]}),e.jsxs("div",{className:`flex items-center gap-1 text-xs font-bold ${s.variance>0?"text-red-500":"text-emerald-500"}`,children:[s.variance>0?e.jsx(as,{size:14}):e.jsx(Ge,{size:14}),Math.abs(s.variancePercent),"%"]})]},t))})]}),e.jsxs(P,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"è·¨é¡¹ç›®èµ„æºåˆ†å¸ƒ (ç»„åˆçº§)"}),e.jsx("p",{className:"text-sm text-slate-500",children:"æ˜¾ç¤ºè¯¥æŠ€æœ¯æ ˆ/éƒ¨é—¨åœ¨æ‰€æœ‰é¡¹ç›®ä¸­çš„åˆ†å¸ƒæƒ…å†µ"})]})}),e.jsx("div",{className:"h-[400px]",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(ve,{children:[e.jsx(ye,{data:a,cx:"50%",cy:"50%",innerRadius:80,outerRadius:140,paddingAngle:5,dataKey:"value",stroke:"none",children:a.map((s,t)=>e.jsx(Ne,{fill:A[t%A.length]},`cell-${t}`))}),e.jsx(F,{content:({active:s,payload:t})=>{if(s&&t&&t.length){const i=t[0].payload;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl shadow-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("p",{className:"font-bold text-slate-900 mb-2",children:i.name}),e.jsx("div",{className:"space-y-1",children:i.projects.map((g,v)=>e.jsxs("div",{className:"flex justify-between gap-4 text-xs",children:[e.jsx("span",{className:"text-slate-500",children:g.name}),e.jsxs("span",{className:"font-bold text-blue-600",children:[g.value,"äººå¤©"]})]},v))})]})}return null}})]})})}),e.jsx("div",{className:"mt-4 flex flex-wrap justify-center gap-4",children:a.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:A[t%A.length]}}),e.jsx("span",{className:"text-sm font-medium text-slate-600",children:s.name}),e.jsxs("span",{className:"text-sm font-bold text-slate-900",children:[(s.value/a.reduce((i,g)=>i+g.value,0)*100).toFixed(0),"%"]})]},t))})]})]}),e.jsxs(P,{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-extrabold text-slate-900 dark:text-slate-100",children:"èµ„æºæ•ˆèƒ½é›·è¾¾å›¾ (Department/Skill Matrix)"}),e.jsx("p",{className:"text-slate-500",children:"åˆ†æžå„æŠ€æœ¯æ ˆ/éƒ¨é—¨çš„è§„æ¨¡æŠ•å…¥åå·®ä¸Žæ•ˆèƒ½å¹³è¡¡"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500/20 border-2 border-blue-500"}),e.jsx("span",{className:"text-sm font-semibold",children:"å®žé™…æ¶ˆè€—"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-slate-300"}),e.jsx("span",{className:"text-sm font-semibold",children:"åˆå§‹è®¡åˆ’"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12 items-center",children:[e.jsx("div",{className:"lg:col-span-2 h-[500px]",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(Je,{cx:"50%",cy:"50%",outerRadius:"80%",data:u,children:[e.jsx(Xe,{stroke:"#e2e8f0"}),e.jsx(Ie,{dataKey:"name",tick:{fontSize:13,fontWeight:700,fill:"#475569"}}),e.jsx(Oe,{angle:30,domain:[0,"auto"],axisLine:!1,tick:!1}),e.jsx(be,{name:"Planned Assets",dataKey:"planned",stroke:"#94a3b8",fill:"#94a3b8",fillOpacity:.1,strokeWidth:2}),e.jsx(be,{name:"Actual Investment",dataKey:"actual",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.3,strokeWidth:3}),e.jsx(F,{contentStyle:{borderRadius:"16px",border:"none",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1)"}})]})})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-slate-100 border-b pb-4 border-slate-100 dark:border-slate-800",children:"å…³é”®åå·®æŒ‡æ ‡è¯„çº§"}),e.jsx("div",{className:"space-y-4",children:u.map((s,t)=>e.jsxs("div",{className:"group cursor-default",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:s.name}),e.jsxs("span",{className:`text-sm font-black ${s.efficiency>110?"text-red-600":s.efficiency<90?"text-amber-600":"text-emerald-600"}`,children:[s.efficiency,"%"]})]}),e.jsx("div",{className:"h-2 bg-slate-100 dark:bg-slate-900 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${s.efficiency>110?"bg-red-500":s.efficiency<90?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${Math.min(s.efficiency,100)}%`}})}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-2 opacity-0 group-hover:opacity-100 transition-opacity",children:s.efficiency>110?"âš ï¸ è¶…é‡æŠ•å…¥ï¼Œéœ€å®¡è§†æ˜¯å¦å­˜åœ¨é•€é‡‘æˆ–ä½Žæ•ˆ":s.efficiency<90?"â„¹ï¸ æŠ•å…¥ä¸è¶³ï¼Œå¯èƒ½å¯¼è‡´è¿›åº¦é£Žé™©":"âœ… æŠ•å…¥æ¨¡åž‹å®Œå…¨ç¬¦åˆåŸºå‡†è®¡åˆ’"})]},t))}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-2xl mt-8",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(he,{className:"text-blue-600 shrink-0",size:18}),e.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-300 leading-relaxed font-medium",children:[e.jsx("strong",{children:"å»ºè®®è¡ŒåŠ¨:"})," ç³»ç»Ÿè¯†åˆ«åˆ° ",e.jsx("strong",{children:u.filter(s=>s.efficiency>110).length})," å¤„æ˜¾è‘—è¶…æ”¯ç‚¹ã€‚å»ºè®®è°ƒå–é¡¹ç›®å‘¨æŠ¥ï¼Œæ ¸å®žè¯¥æŠ€æœ¯æ ˆåœ¨å¯¹åº”é¡¹ç›®çš„å·¥æ—¶å¡«æŠ¥çœŸå®žæ€§ã€‚"]})]})})]})]})]}),e.jsxs(P,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:"å…¨é‡é¡¹ç›®èµ„æºçŸ©é˜µ (Resource Heat Matrix)"}),e.jsx("p",{className:"text-sm text-slate-500",children:"æ¨ªå‘å¯¹æ¯”å„é¡¹ç›®åœ¨å„èµ„æºç±»åˆ«ä¸Šçš„å®žé™…æŠ•å…¥è§„æ¨¡"})]}),e.jsx(q,{variant:"secondary",size:"sm",children:"å¯¼å‡ºçŸ©é˜µ"})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-slate-100 dark:border-slate-800",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase",children:"èµ„æºèŠ‚ç‚¹ / é¡¹ç›®"}),d.map(s=>e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase text-center min-w-[120px]",children:s.name.length>10?s.name.substring(0,10)+"...":s.name},s.id)),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-blue-600 uppercase text-center",children:"åˆè®¡æŠ•å…¥"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:a.map((s,t)=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-8 rounded-full",style:{backgroundColor:A[t%A.length]}}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:s.name})]})}),d.map(i=>{var k;const g=(k=i.actualResourceUsage)==null?void 0:k.find(p=>(c==="department"?p.department:p.category)===s.name),v=(g==null?void 0:g.count)||0;return e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:`inline-flex items-center justify-center w-12 h-12 rounded-2xl text-sm font-bold ${v>5?"bg-blue-600 text-white shadow-lg":v>2?"bg-blue-100 text-blue-700 dark:bg-blue-900/40":v>0?"bg-slate-100 text-slate-600 dark:bg-slate-800":"text-slate-300"}`,children:v||"-"})},i.id)}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:"text-lg font-black text-slate-900 dark:text-slate-100",children:s.value})})]},t))})]})})]})]})},ct=()=>{const[d,o]=N.useState("dashboard"),[l,b]=N.useState(!1),[c,r]=N.useState(!1),[m,n]=N.useState(!1),[a,u]=N.useState("all"),x=ne(),j=ie(),s=N.useMemo(()=>ke(x,12),[x]),t=N.useMemo(()=>Se(x,j,s),[x,j,s]),i=N.useMemo(()=>a==="all"?t:t.filter(k=>{var h;const p=(h=s[0])==null?void 0:h.label,f=k.allocations[p],w=f?f.total:0,y=k.capacity>0?w/k.capacity*100:0;switch(a){case"low":return y<50;case"normal":return y>=50&&y<=80;case"high":return y>80&&y<=100;case"over":return y>100;default:return!0}}),[t,a,s]),g=[{id:"dashboard",label:"æ€»è§ˆ",icon:Ae,color:"blue"},{id:"heatmap",label:"çƒ­åŠ›å›¾",icon:cs,color:"purple"},{id:"gantt",label:"æ—¶é—´çº¿",icon:_,color:"green"},{id:"conflicts",label:"å†²çªæ£€æµ‹",icon:W,color:"red"},{id:"costs",label:"æˆæœ¬åˆ†æž",icon:ts,color:"yellow"},{id:"skills",label:"æŠ€èƒ½åŒ¹é…",icon:Ce,color:"indigo"},{id:"decision",label:"å†³ç­–æ”¯æŒ",icon:Ee,color:"rose"},{id:"prediction",label:"è´Ÿè·é¢„æµ‹",icon:V,color:"blue"},{id:"efficiency",label:"æ•ˆèƒ½ä¸‹é’»",icon:$e,color:"emerald"}],v=k=>{k==="csv"?d==="heatmap"||d==="dashboard"?gs(i,s):Ns(j):vs({resourceLoads:i,resourcePool:j,exportDate:new Date().toISOString()},"èµ„æºæ•°æ®"),b(!1)};return e.jsxs(Ye,{children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-30 -mx-6 -mt-6 px-6 pt-6",children:[e.jsx(Ze,{title:"èµ„æºç®¡ç†",description:"å…¨æ–¹ä½èµ„æºç›‘æŽ§ä¸Žåˆ†æž",actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(q,{onClick:k=>{k.stopPropagation(),r(!c)},variant:c||a!=="all"?"primary":"secondary",icon:es,children:["ç­›é€‰",a!=="all"&&e.jsx(ae,{variant:"danger",size:"sm",rounded:"full",className:"ml-2",children:"1"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{onClick:()=>b(!l),variant:"secondary",icon:ss,children:"å¯¼å‡º"}),l&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-slate-800 rounded-lg shadow-xl border border-slate-200 dark:border-slate-700 py-2 z-50",children:[e.jsx("button",{onClick:()=>v("csv"),className:"w-full px-4 py-2 text-left text-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"å¯¼å‡ºä¸º CSV"}),e.jsx("button",{onClick:()=>v("json"),className:"w-full px-4 py-2 text-left text-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"å¯¼å‡ºä¸º JSON"}),e.jsx("button",{onClick:()=>{window.print(),b(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"æ‰“å°æŠ¥è¡¨"})]})]}),e.jsx(q,{onClick:()=>n(!0),variant:"primary",icon:te,children:"æ·»åŠ èµ„æº"})]})}),c&&e.jsxs("div",{className:"mb-4 p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-medium text-slate-900",children:"ç­›é€‰æ¡ä»¶"}),e.jsx("button",{onClick:()=>{u("all"),r(!1)},className:"text-sm text-slate-600 hover:text-slate-900",children:e.jsx(re,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"åˆ©ç”¨çŽ‡èŒƒå›´"}),e.jsx("div",{className:"flex gap-2",children:[{value:"all",label:"å…¨éƒ¨"},{value:"low",label:"ä½Žè´Ÿè½½ (<50%)"},{value:"normal",label:"æ­£å¸¸ (50-80%)"},{value:"high",label:"é«˜è´Ÿè½½ (80-100%)"},{value:"over",label:"è¶…é¢ (>100%)"}].map(k=>e.jsx("button",{onClick:p=>{p.stopPropagation(),u(k.value)},className:`px-3 py-1.5 text-sm rounded-lg transition-colors ${a===k.value?"bg-blue-600 text-white":"bg-white text-slate-700 hover:bg-slate-100 border border-slate-200"}`,children:k.label},k.value))})]})]}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:g.map(k=>{const p=k.icon,f=d===k.id;return e.jsxs("button",{onClick:()=>o(k.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium transition-all whitespace-nowrap ${f?"bg-blue-100 text-blue-700 shadow-sm":"text-slate-600 hover:bg-slate-100"}`,children:[e.jsx(p,{size:18}),e.jsx("span",{children:k.label})]},k.id)})})]}),e.jsxs("div",{className:"mt-6",children:[d==="dashboard"&&e.jsx(ms,{}),d==="heatmap"&&e.jsx(hs,{resourceLoads:i,buckets:s}),d==="gantt"&&e.jsx(Qe,{projects:x,resources:j}),d==="conflicts"&&e.jsx(ps,{}),d==="costs"&&e.jsx(Ve,{}),d==="skills"&&e.jsx(fs,{}),d==="decision"&&e.jsx(_e,{}),d==="prediction"&&e.jsx(Fe,{projects:x,resourcePool:j}),d==="efficiency"&&e.jsx(ks,{})]}),(l||c)&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>{b(!1)}}),e.jsx(ys,{isOpen:m,onClose:()=>n(!1)})]})};export{ct as default};
