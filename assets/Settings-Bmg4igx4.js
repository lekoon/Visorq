import{e as f,u as T,a as q,r as c,j as e,C as U,x as $,S as B,y as F,c as H,i as P}from"./index-Cm5v5aLu.js";import{D as J}from"./download-rmzF1Ptb.js";import{P as K}from"./plus-DUHv1EW8.js";import{f as V}from"./format-C8r1rC4U.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=f("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=f("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=f("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),G=[{id:"fs-proj-001",fields:{name:"[来自飞书] 企业数字化转型一期",status:"In Progress",priority:"P0",start_date:"2025-01-01",end_date:"2025-06-30",manager:"张三"}},{id:"fs-proj-002",fields:{name:"[来自飞书] 移动端体验升级",status:"Planning",priority:"P1",start_date:"2025-03-01",end_date:"2025-05-30",manager:"李四"}}],X=[{id:"fs-res-001",fields:{name:"王五",role:"Senior Engineer",department:"研发部",email:"wangwu@example.com"}},{id:"fs-res-002",fields:{name:"赵六",role:"Product Manager",department:"产品部",email:"zhaoliu@example.com"}}],Y=async n=>{if(console.log(`Starting sync with App ID: ${n.appId}`),await new Promise(a=>setTimeout(a,2e3)),!n.appId.startsWith("cli_"))return{success:!1,projectsSynced:0,tasksSynced:0,resourcesSynced:0,errors:["无效的 App ID 格式，请以 cli_ 开头"]};const x=G.map(a=>({id:a.id,name:a.fields.name,description:`Synced from Feishu (Manager: ${a.fields.manager})`,status:a.fields.status==="In Progress"?"active":"planning",startDate:a.fields.start_date,endDate:a.fields.end_date,budget:5e5,spent:0,priority:a.fields.priority,managerId:"admin",tags:["Feishu","Imported"],progress:0,health:{overall:100,schedule:100,budget:100,scope:100,resources:100,risk:100,teamMood:100},info:{tasks:[],risks:[],milestones:[]},resourceRequirements:[],score:85})),g=X.map(a=>({id:a.id,name:a.fields.name,role:a.fields.role,department:a.fields.department,email:a.fields.email,skills:[{name:"Feishu User",level:3}],availability:100,efficiency:1,costRate:1e3,totalQuantity:1,assignedProjects:[]}));return{success:!0,projectsSynced:x.length,tasksSynced:0,resourcesSynced:g.length,errors:[],data:{projects:x,resources:g}}},re=()=>{const{factorDefinitions:n,addFactor:x,updateFactor:g,deleteFactor:a,recalculateScores:z,projects:k,resourcePool:j,addProject:R,addResource:E}=T(),{t:s}=q(),[m,N]=c.useState(""),[b,y]=c.useState(!1),[l,v]=c.useState({appId:"",appSecret:""}),[p,w]=c.useState(!1),[S,M]=c.useState(null),C=n.reduce((t,r)=>t+r.weight,0),I=()=>{m.trim()&&(x(m.trim()),N(""))},_=async()=>{if(!l.appId){alert("Please enter App ID");return}w(!0);try{const t=await Y(l);t.success?(t.data&&(t.data.projects.forEach(r=>{k.find(d=>d.id===r.id)||R(r)}),t.data.resources.forEach(r=>{j.find(d=>d.id===r.id)||E(r)})),M(new Date().toLocaleString()),alert(`Sync Complete!
Projects: ${t.projectsSynced}
Resources: ${t.resourcesSynced}`)):alert(`Sync Failed:
${t.errors.join(`
`)}`)}catch(t){console.error(t),alert("An unexpected error occurred during sync.")}finally{w(!1)}},A=()=>{const t=localStorage.getItem("visorq-storage");if(!t){alert("No data to backup");return}const r={version:"1.0",timestamp:new Date().toISOString(),data:JSON.parse(t)},d=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),o=window.URL.createObjectURL(d),i=document.createElement("a");i.href=o,i.download=`visorq-backup-${V(new Date,"yyyy-MM-dd-HHmmss")}.json`,i.click(),window.URL.revokeObjectURL(o)},L=t=>{var o;const r=(o=t.target.files)==null?void 0:o[0];if(!r)return;const d=new FileReader;d.onload=i=>{var D;try{const h=JSON.parse((D=i.target)==null?void 0:D.result);h.data&&h.version?(localStorage.setItem("visorq-storage",JSON.stringify(h.data)),alert("Data restored successfully! Please refresh the page."),window.location.reload()):alert("Invalid backup file format")}catch{alert("Error reading backup file")}},d.readAsText(r)},O=()=>{b?(localStorage.removeItem("visorq-storage"),alert("All data cleared! The page will reload."),window.location.reload()):(y(!0),setTimeout(()=>y(!1),5e3))},u={projects:k.length,resources:j.length,factors:n.length,storageSize:new Blob([localStorage.getItem("visorq-storage")||""]).size};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 animate-in fade-in duration-500 pb-12",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-100",children:s("settings.title")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:s("settings.subtitle")})]}),e.jsx("button",{onClick:z,className:"px-4 py-2 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-xl font-bold hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors",children:s("settings.recalculate")})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(W,{className:"text-purple-600",size:24}),e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Third-party Integrations"})]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Connect Visorq with external platforms to sync data."})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/30 p-6 rounded-xl border border-slate-200 dark:border-slate-600",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white dark:bg-slate-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx(Z,{className:"text-blue-500",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-slate-100 text-lg",children:"Feishu / Lark Integration"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Sync projects and resource availability from Feishu Base."})]})]}),S&&e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400 font-medium bg-green-50 dark:bg-green-900/20 px-3 py-1 rounded-full border border-green-100 dark:border-green-900/30 flex items-center gap-1",children:[e.jsx(U,{size:12})," Last synced: ",S]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1",children:"App ID"}),e.jsx("input",{type:"text",placeholder:"cli_a1b2c3d4e5f6",value:l.appId,onChange:t=>v({...l,appId:t.target.value}),className:"w-full p-2.5 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-purple-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1",children:"App Secret"}),e.jsx("input",{type:"password",placeholder:"••••••••••••••••",value:l.appSecret,onChange:t=>v({...l,appSecret:t.target.value}),className:"w-full p-2.5 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-purple-500 focus:outline-none"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:_,disabled:p||!l.appId,className:`
                                flex items-center gap-2 px-5 py-2.5 rounded-lg font-semibold text-white transition-all
                                ${p?"bg-purple-400 cursor-wait":l.appId?"bg-purple-600 hover:bg-purple-700 shadow-md hover:shadow-lg":"bg-slate-300 dark:bg-slate-700 cursor-not-allowed"}
                            `,children:[e.jsx($,{size:18,className:p?"animate-spin":""}),p?"Syncing...":"Sync Data Now"]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Q,{className:"text-blue-600",size:24}),e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:s("settings.dataManagement")})]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:s("settings.dataDesc")})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800",children:[e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:s("settings.projects")}),e.jsx("p",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:u.projects})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-xl border border-green-100 dark:border-green-800",children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:s("settings.resources")}),e.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:u.resources})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-xl border border-purple-100 dark:border-purple-800",children:[e.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400 font-medium",children:s("settings.factors")}),e.jsx("p",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:u.factors})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-xl border border-orange-100 dark:border-orange-800",children:[e.jsx("p",{className:"text-sm text-orange-600 dark:text-orange-400 font-medium",children:s("settings.storage")}),e.jsxs("p",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:[(u.storageSize/1024).toFixed(1)," KB"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl border border-blue-200 dark:border-blue-800",children:[e.jsx(B,{className:"text-blue-600 dark:text-blue-400",size:24}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-blue-900 dark:text-blue-100",children:s("settings.backup")}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:s("settings.backupDesc")})]}),e.jsxs("button",{onClick:A,className:"px-6 py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 shadow-lg",children:[e.jsx(J,{size:18}),s("settings.backupNow")]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl border border-green-200 dark:border-green-800",children:[e.jsx(F,{className:"text-green-600 dark:text-green-400",size:24}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-green-900 dark:text-green-100",children:s("settings.restore")}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:s("settings.restoreDesc")})]}),e.jsxs("label",{className:"px-6 py-3 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition-colors cursor-pointer flex items-center gap-2 shadow-lg",children:[e.jsx(F,{size:18}),s("settings.restore"),e.jsx("input",{type:"file",accept:".json",onChange:L,className:"hidden"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 rounded-xl border border-red-200 dark:border-red-800",children:[e.jsx(H,{className:"text-red-600 dark:text-red-400",size:24}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-red-900 dark:text-red-100",children:s("settings.clearData")}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:s(b?"settings.confirmClear":"settings.clearDesc")})]}),e.jsxs("button",{onClick:O,className:`px-6 py-3 font-bold rounded-xl transition-colors flex items-center gap-2 shadow-lg ${b?"bg-red-600 text-white hover:bg-red-700 animate-pulse":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/50"}`,children:[e.jsx(P,{size:18}),s(b?"settings.confirmDelete":"settings.clearData")]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:s("settings.scoringFactors")}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:s("settings.scoringDesc")})]}),e.jsxs("div",{className:`px-4 py-2 rounded-xl font-bold ${C===100?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300"}`,children:[s("settings.totalWeight"),": ",C,"%"]})]}),e.jsx("div",{className:"space-y-4",children:n.map(t=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-slate-50 dark:bg-slate-700/30 rounded-xl border border-slate-100 dark:border-slate-600",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1",children:t.name}),e.jsx("input",{type:"range",min:"0",max:"100",step:"5",className:"w-full h-2 bg-slate-200 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-blue-600",value:t.weight,onChange:r=>g(t.id,{weight:parseInt(r.target.value)})})]}),e.jsx("div",{className:"w-20 text-center",children:e.jsxs("span",{className:"font-bold text-slate-900 dark:text-slate-100",children:[t.weight,"%"]})}),e.jsx("button",{onClick:()=>a(t.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Remove Factor",children:e.jsx(P,{size:18})})]},t.id))}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-100 dark:border-slate-700 flex gap-4",children:[e.jsx("input",{type:"text",placeholder:s("settings.newFactorPlaceholder"),className:"flex-1 p-3 rounded-xl border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500",value:m,onChange:t=>N(t.target.value),onKeyPress:t=>t.key==="Enter"&&I()}),e.jsxs("button",{onClick:I,disabled:!m,className:"px-6 py-3 bg-slate-900 dark:bg-slate-600 text-white font-bold rounded-xl hover:bg-slate-800 dark:hover:bg-slate-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-colors",children:[e.jsx(K,{size:20}),s("settings.addFactor")]})]})]})]})};export{re as default};
