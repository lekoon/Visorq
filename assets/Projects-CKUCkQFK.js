import{e as fe,t as P,r as S,j as e,X as ee,F as T,f as be,u as te,a as je,U as ve,g as Ne,h as E,i as Ye,k as he,S as Ve,K as Xe,p as z,d as U}from"./index-Oiqu5f7k.js";import{S as Je}from"./sparkles-B1zgWC04.js";import{G as Qe}from"./grip-vertical-CyTcwmFO.js";import{P as ke}from"./pen-D0haEgkf.js";import{P as Ze,a as et}from"./PageHeader-DHFUACUc.js";import{B as G,C as pe,a as ge}from"./Badge-8Nr5Yv0X.js";import{u as tt}from"./usePMOStore-WFphohlh.js";import{P as ye}from"./plus-D_2kw548.js";import{C as st}from"./calendar-8wF6h7X3.js";import{e as we,s as at}from"./startOfMonth-D0AoMLzU.js";import{e as lt}from"./endOfDay-C1laghqW.js";import{a as Q}from"./addMonths-OxXHz6hR.js";import{f as O}from"./format-l4_sjOwQ.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=fe("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=fe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);function Z(g,v){const x=P(g),n=P(v),i=x.getTime()-n.getTime();return i<0?-1:i>0?1:i}function ot(g,v){const x=P(g),n=P(v),i=x.getFullYear()-n.getFullYear(),u=x.getMonth()-n.getMonth();return i*12+u}function dt(g){const v=P(g);return+lt(v)==+we(v)}function it(g,v){const x=P(g),n=P(v),i=Z(x,n),u=Math.abs(ot(x,n));let f;if(u<1)f=0;else{x.getMonth()===1&&x.getDate()>27&&x.setDate(30),x.setMonth(x.getMonth()-i*u);let j=Z(x,n)===-i;dt(P(g))&&u===1&&Z(g,n)===1&&(j=!1),f=i*(u-Number(j))}return f===0?0:f}const ct=({templates:g,onSelect:v,onClose:x})=>{const[n,i]=S.useState(null),[u,f]=S.useState("all"),j=[{id:"all",label:"全部",icon:Je},{id:"web",label:"Web应用",icon:T},{id:"mobile",label:"移动应用",icon:T},{id:"data",label:"数据分析",icon:T},{id:"infrastructure",label:"基础设施",icon:T},{id:"custom",label:"自定义",icon:T}],k=u==="all"?g:g.filter(r=>r.category===u),R=()=>{v(n),x()},D=r=>({web:"from-blue-500 to-cyan-500",mobile:"from-purple-500 to-pink-500",data:"from-green-500 to-emerald-500",infrastructure:"from-orange-500 to-red-500",custom:"from-slate-500 to-gray-500"})[r]||"from-blue-500 to-purple-500";return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"选择项目模板"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"使用模板快速创建项目，或从空白项目开始"})]}),e.jsx("button",{onClick:x,className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(ee,{size:24,className:"text-slate-500"})})]}),e.jsx("div",{className:"flex gap-2 mt-4 overflow-x-auto pb-2",children:j.map(r=>{const M=r.icon;return e.jsxs("button",{onClick:()=>f(r.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap ${u===r.id?"bg-blue-600 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:[e.jsx(M,{size:16}),r.label]},r.id)})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"从头开始"}),e.jsx("div",{onClick:()=>i(null),className:`p-6 rounded-xl border-2 cursor-pointer transition-all ${n===null?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{size:20,className:"text-slate-400"}),e.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100",children:"空白项目"})]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"创建一个全新的项目，自定义所有设置"})]}),n===null&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(be,{size:16,className:"text-white"})})]})})]}),k.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:["可用模板 (",k.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(r=>e.jsxs("div",{onClick:()=>i(r),className:`p-5 rounded-xl border-2 cursor-pointer transition-all ${(n==null?void 0:n.id)===r.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-lg":"border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700 hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${D(r.category)} flex items-center justify-center text-white shadow-lg`,children:e.jsx(T,{size:24})}),(n==null?void 0:n.id)===r.id&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(be,{size:16,className:"text-white"})})]}),e.jsx("h4",{className:"font-bold text-slate-900 dark:text-slate-100 mb-2",children:r.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-3 line-clamp-2",children:r.description}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsxs("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded",children:[r.defaultDuration," 个月"]}),r.isBuiltIn&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded",children:"内置"})]})]},r.id))})]}),k.length===0&&u!=="all"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(T,{size:48,className:"mx-auto text-slate-300 dark:text-slate-600 mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"该分类暂无模板"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-200 dark:border-slate-700 flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:n?e.jsxs("span",{children:["已选择: ",e.jsx("strong",{className:"text-slate-700 dark:text-slate-300",children:n.name})]}):e.jsx("span",{children:"将创建空白项目"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:x,className:"px-6 py-2 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg font-medium transition-colors",children:"取消"}),e.jsx("button",{onClick:R,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors shadow-lg shadow-blue-600/20",children:"确认选择"})]})]})]})})},xt=({onEditProject:g})=>{const{projects:v,updateProject:x}=te(),{t:n}=je(),[i,u]=S.useState(null),[f,j]=S.useState(null),k=[{id:"planning",label:n("projects.planning"),color:"bg-blue-100 text-blue-700",borderColor:"border-blue-400"},{id:"active",label:n("projects.active"),color:"bg-green-100 text-green-700",borderColor:"border-green-400"},{id:"on-hold",label:n("projects.onHold"),color:"bg-orange-100 text-orange-700",borderColor:"border-orange-400"},{id:"completed",label:n("projects.completed"),color:"bg-purple-100 text-purple-700",borderColor:"border-purple-400"}],R=(b,N)=>{u(N),b.dataTransfer.effectAllowed="move",b.target.style.opacity="0.5"},D=b=>{b.target.style.opacity="1",u(null),j(null)},r=(b,N)=>{b.preventDefault(),b.dataTransfer.dropEffect="move",j(N)},M=()=>{j(null)},I=(b,N)=>{if(b.preventDefault(),j(null),i&&i.status!==N){x(i.id,{status:N});const C=document.createElement("div");C.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in",C.textContent=`${i.name} moved to ${N}`,document.body.appendChild(C),setTimeout(()=>{C.remove()},2e3)}u(null)};return e.jsx("div",{className:"flex gap-6 overflow-x-auto pb-6",children:k.map(b=>{const N=v.filter(h=>h.status===b.id),C=f===b.id;return e.jsxs("div",{className:`min-w-[320px] rounded-2xl p-4 transition-all duration-200 ${C?`bg-blue-50 border-2 ${b.borderColor} shadow-lg scale-105`:"bg-slate-100/50 border-2 border-transparent"}`,onDragOver:h=>r(h,b.id),onDragLeave:M,onDrop:h=>I(h,b.id),children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("div",{className:`px-3 py-2 rounded-lg font-bold text-sm ${b.color}`,children:b.label}),e.jsx("span",{className:"text-sm text-slate-500 font-medium",children:N.length})]}),e.jsxs("div",{className:"space-y-3 min-h-[400px]",children:[N.map(h=>e.jsx("div",{draggable:!0,onDragStart:_=>R(_,h),onDragEnd:D,className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-all cursor-move group",children:e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx(Qe,{size:16,className:"text-slate-400 mt-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm leading-tight",children:h.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${h.priority==="P0"?"bg-red-100 text-red-700":h.priority==="P1"?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:h.priority||"P2"}),e.jsx("span",{className:"text-xs font-bold bg-blue-50 text-blue-600 px-2 py-0.5 rounded",children:(h.score||0).toFixed(1)})]})]}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2 mb-3",children:h.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-slate-400",children:[e.jsx(ve,{size:12}),e.jsx("span",{children:(h.resourceRequirements||[]).reduce((_,A)=>_+A.count,0)})]}),e.jsxs("span",{className:"text-slate-400",children:["Rank #",h.rank]}),e.jsx("button",{onClick:_=>{_.stopPropagation(),g(h)},className:"p-1 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",children:e.jsx(ke,{size:14})})]})]})]})},h.id)),N.length===0&&e.jsx("div",{className:`text-center py-12 rounded-xl border-2 border-dashed transition-colors ${C?"border-blue-400 bg-blue-50":"border-slate-200 bg-slate-50"}`,children:e.jsx("p",{className:"text-sm text-slate-400",children:n(C?"projects.dropHere":"projects.noProjects")})})]})]},b.id)})})},mt=({isOpen:g,onClose:v})=>{const x=Ne(),{addKeyTaskDefinition:n,updateKeyTaskDefinition:i,deleteKeyTaskDefinition:u}=te(),[f,j]=S.useState(""),[k,R]=S.useState("#3b82f6");if(!g)return null;const D=()=>{f.trim()&&(n(f.trim(),k),j(""))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl w-full max-w-md shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-800/50",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(nt,{className:"text-blue-500",size:24}),"关键任务设置"]}),e.jsx("button",{onClick:v,className:"p-2 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors",children:e.jsx(ee,{size:24,className:"text-slate-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"任务名称 (如: SIT)",className:"w-full p-2.5 rounded-xl border border-slate-200 dark:border-slate-700 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",value:f,onChange:r=>j(r.target.value),onKeyDown:r=>r.key==="Enter"&&D()})}),e.jsx("input",{type:"color",className:"w-12 h-10 p-1 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer",value:k,onChange:r=>R(r.target.value)}),e.jsx(G,{onClick:D,size:"sm",icon:ye,children:"添加"})]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:x.map(r=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl group transition-all hover:shadow-sm",children:[e.jsx("input",{type:"color",className:"w-8 h-8 rounded p-0 border-none cursor-pointer shrink-0",value:r.color,onChange:M=>i(r.id,{color:M.target.value})}),e.jsx("input",{type:"text",className:"flex-1 bg-transparent border-none focus:ring-0 text-sm font-medium text-slate-700 dark:text-slate-300",value:r.name,onChange:M=>i(r.id,{name:M.target.value})}),e.jsx("button",{onClick:()=>u(r.id),className:"p-1.5 text-slate-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(E,{size:16})})]},r.id))})]}),e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-100 dark:border-slate-800 flex justify-end",children:e.jsx(G,{onClick:v,variant:"ghost",children:"完成"})})]})})},Mt=()=>{var ae,le,re,ne,oe,de,ie;const{projects:g,addProject:v,deleteProject:x,updateProject:n,factorDefinitions:i,resourcePool:u,user:f}=te(),{t:j}=je(),{environmentResources:k}=tt(),R=Ye(),[D,r]=S.useState("list"),[M,I]=S.useState(!1),[b,N]=S.useState(!1),[C,h]=S.useState(null),[_,A]=S.useState(!1),F=Ne(),De=[{id:"web-app",name:"Web Application",description:"Standard web application development project with frontend and backend.",category:"web",defaultDuration:3,defaultFactors:{market:8,value:7,risk:6,roi:8,strategy:7,innovation:6,cost:5},defaultResources:[{resourceId:"",count:2,duration:3,unit:"month",requiredSkills:["react","node"]},{resourceId:"",count:1,duration:3,unit:"month",requiredSkills:["design"]}],isBuiltIn:!0,createdAt:new Date().toISOString()},{id:"mobile-app",name:"Mobile App",description:"iOS and Android mobile application development.",category:"mobile",defaultDuration:4,defaultFactors:{market:9,value:8,risk:5,roi:7,strategy:8,innovation:7,cost:6},defaultResources:[{resourceId:"",count:2,duration:4,unit:"month",requiredSkills:["flutter"]},{resourceId:"",count:1,duration:2,unit:"month",requiredSkills:["qa"]}],isBuiltIn:!0,createdAt:new Date().toISOString()},{id:"data-analytics",name:"Data Analytics Platform",description:"Big data processing and analytics dashboard.",category:"data",defaultDuration:6,defaultFactors:{market:7,value:9,risk:4,roi:9,strategy:9,innovation:8,cost:4},defaultResources:[{resourceId:"",count:3,duration:6,unit:"month",requiredSkills:["python","sql"]},{resourceId:"",count:1,duration:6,unit:"month",requiredSkills:["data-science"]}],isBuiltIn:!0,createdAt:new Date().toISOString()}],[o,m]=S.useState({name:"",description:"",status:"planning",priority:"P2",startDate:"",endDate:"",category:"custom",department:"",budget:0,factors:{},resourceRequirements:[],milestones:[],environmentRequirements:[]}),Ce=()=>{const t={};return i.forEach(a=>t[a.id]=5),t},K=t=>{if(t){h(t.id);const a={...t.factors};i.forEach(s=>{a[s.id]===void 0&&(a[s.id]=5)}),m({...t,factors:a}),I(!0)}else N(!0)},Se=t=>{if(h(null),t){const a=new Date,s=Q(a,t.defaultDuration),c=t.defaultResources.map(p=>{var y;return{...p,resourceId:((y=u[0])==null?void 0:y.id)||""}}),d={id:Math.random().toString(36).substr(2,9),name:`${t.name} - ${O(a,"yyyyMMdd")}`,description:t.description,status:"planning",priority:"P2",startDate:O(a,"yyyy-MM-dd"),endDate:O(s,"yyyy-MM-dd"),factors:{...t.defaultFactors},resourceRequirements:c,category:t.category,department:t.department,budget:t.defaultBudget||0,score:0,milestones:[],costHistory:[],actualCost:0};d.score=he(d.factors,i),v(d),N(!1),R(`/projects/${d.id}`)}else m({name:"",description:"",status:"planning",priority:"P2",startDate:"",endDate:"",category:"custom",department:"",budget:0,factors:Ce(),resourceRequirements:[],milestones:[],environmentRequirements:[]}),N(!1),I(!0)},Me=t=>{t.preventDefault(),C?n(C,o):v({...o,id:Math.random().toString(36).substr(2,9),score:0,priority:o.priority||"P2"}),I(!1)},Re=()=>{m(t=>{var a;return{...t,resourceRequirements:[...t.resourceRequirements||[],{resourceId:((a=u[0])==null?void 0:a.id)||"",count:1,duration:1,unit:"month"}]}})},Te=t=>{m(a=>{var s;return{...a,resourceRequirements:(s=a.resourceRequirements)==null?void 0:s.filter((c,d)=>d!==t)}})},L=(t,a,s)=>{m(c=>{var d;return{...c,resourceRequirements:(d=c.resourceRequirements)==null?void 0:d.map((p,y)=>y===t?{...p,[a]:s}:p)}})},ze=()=>{m(t=>({...t,milestones:[...t.milestones||[],{id:Math.random().toString(36).substr(2,9),name:"",date:"",completed:!1}]}))},Pe=t=>{m(a=>{var s;return{...a,milestones:(s=a.milestones)==null?void 0:s.filter((c,d)=>d!==t)}})},se=(t,a,s)=>{m(c=>{var d;return{...c,milestones:(d=c.milestones)==null?void 0:d.map((p,y)=>y===t?{...p,[a]:s}:p)}})},Ie=()=>{m(t=>{var a,s;return{...t,environmentRequirements:[...t.environmentRequirements||[],{environmentId:((a=k[0])==null?void 0:a.id)||"",environmentName:((s=k[0])==null?void 0:s.name)||"",startDate:"",endDate:"",purpose:""}]}})},_e=t=>{m(a=>{var s;return{...a,environmentRequirements:(s=a.environmentRequirements)==null?void 0:s.filter((c,d)=>d!==t)}})},B=(t,a,s)=>{m(c=>{var d;return{...c,environmentRequirements:(d=c.environmentRequirements)==null?void 0:d.map((p,y)=>{if(y===t){if(a==="environmentId"){const W=k.find(H=>H.id===s);return{...p,environmentId:s,environmentName:(W==null?void 0:W.name)||""}}return{...p,[a]:s}}return p})}})},qe=()=>{m(t=>{var a;return{...t,keyTasks:[...t.keyTasks||[],{definitionId:((a=F[0])==null?void 0:a.id)||"",startDate:t.startDate||new Date().toISOString().split("T")[0],endDate:t.endDate||new Date().toISOString().split("T")[0]}]}})},Y=(t,a,s)=>{m(c=>{var d;return{...c,keyTasks:(d=c.keyTasks)==null?void 0:d.map((p,y)=>y===t?{...p,[a]:s}:p)}})},$e=t=>{m(a=>{var s;return{...a,keyTasks:(s=a.keyTasks)==null?void 0:s.filter((c,d)=>d!==t)}})},Oe=o.factors?he(o.factors,i):0;return e.jsxs(Ze,{children:[e.jsx(et,{title:"Projects",description:"Manage and track all your projects",actions:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(G,{variant:"outline",icon:Ve,onClick:()=>A(!0),size:"sm",className:"border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800",children:"关键任务"})}),e.jsxs("div",{className:"flex bg-white dark:bg-slate-800 rounded-lg p-1 border border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsxs("button",{onClick:()=>r("list"),className:`px-3 py-1.5 rounded-md transition-all flex items-center gap-2 ${D==="list"?"bg-slate-100 dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:[e.jsx(rt,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"列表"})]}),e.jsxs("button",{onClick:()=>r("kanban"),className:`px-3 py-1.5 rounded-md transition-all flex items-center gap-2 ${D==="kanban"?"bg-slate-100 dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:[e.jsx(Xe,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"看板"})]}),e.jsxs("button",{onClick:()=>r("gantt"),className:`px-3 py-1.5 rounded-md transition-all flex items-center gap-2 ${D==="gantt"?"bg-slate-100 dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-slate-400 hover:text-slate-600 dark:hover:text-slate-300"}`,children:[e.jsx(st,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"甘特图"})]})]}),(f==null?void 0:f.role)!=="user"&&e.jsx(G,{onClick:()=>K(),variant:"primary",icon:ye,children:"New Project"})]})}),D==="list"?e.jsx(pe,{padding:"none",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Rank"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Project Name"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Status"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Score"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600",children:"Resources"}),e.jsx("th",{className:"p-4 font-semibold text-slate-600 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:g.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"w-8 h-8 rounded-lg bg-slate-100 text-slate-600 font-bold flex items-center justify-center",children:t.rank})}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-slate-900 cursor-pointer hover:text-blue-600",onClick:()=>R(`/projects/${t.id}`),children:t.name}),e.jsx("div",{className:"text-sm text-slate-500 truncate max-w-xs",children:t.description})]}),e.jsx("td",{className:"p-4",children:e.jsx(ge,{variant:t.status==="active"?"success":t.status==="planning"?"primary":"neutral",size:"sm",children:t.status.toUpperCase()})}),e.jsx("td",{className:"p-4 font-bold text-blue-600",children:(t.score||0).toFixed(2)}),e.jsx("td",{className:"p-4 text-sm text-slate-500",children:e.jsxs("div",{className:"flex items-center gap-1",title:"Total Headcount Required",children:[e.jsx(ve,{size:14}),(t.resourceRequirements||[]).reduce((a,s)=>a+s.count,0)," people"]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:(f==null?void 0:f.role)!=="user"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>K(t),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(ke,{size:18})}),e.jsx("button",{onClick:()=>x(t.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(E,{size:18})})]})})})]},t.id))})]})}):D==="kanban"?e.jsx("div",{className:"overflow-x-auto pb-6",children:e.jsx(xt,{onEditProject:K})}):e.jsx(pe,{padding:"none",className:"overflow-hidden",children:(()=>{const t=g.filter(l=>l.startDate&&l.endDate);if(t.length===0)return e.jsx("div",{className:"p-20 text-center text-slate-400 italic",children:"暂无排程项目"});const a=t.map(l=>z(l.startDate).getTime()),s=t.map(l=>z(l.endDate).getTime()),c=at(new Date(Math.min(...a))),d=we(new Date(Math.max(...s))),p=it(d,c)+1,y=U(d,c)+1,H=p*120,V=U(new Date,c)/y*100,q=[];for(let l=0;l<p;l++){const w=Q(c,l),$=O(w,"yyyy年");q.length>0&&q[q.length-1].year===$?q[q.length-1].monthCount++:q.push({year:$,monthCount:1})}return e.jsx("div",{className:"overflow-x-auto custom-scrollbar group/gantt",children:e.jsxs("div",{style:{width:`calc(14rem + ${H}px)`},className:"relative bg-white dark:bg-slate-900 min-h-[400px]",children:[e.jsxs("div",{className:"sticky top-0 z-30 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-56 shrink-0 sticky left-0 bg-white dark:bg-slate-900 z-40 border-r border-slate-100 dark:border-slate-800"}),e.jsx("div",{className:"flex-1 flex",children:q.map((l,w)=>e.jsx("div",{className:"border-l border-slate-100 dark:border-slate-800 text-[10px] font-black text-slate-400 dark:text-slate-500 py-1 px-3 bg-slate-50/50 dark:bg-slate-800/30 uppercase tracking-widest",style:{width:`${l.monthCount/p*100}%`},children:l.year},w))})]}),e.jsxs("div",{className:"flex h-10 items-center",children:[e.jsx("div",{className:"w-56 shrink-0 font-bold text-slate-600 dark:text-slate-300 px-6 sticky left-0 bg-white dark:bg-slate-900 z-40 border-r border-slate-100 dark:border-slate-800 flex items-center",children:"项目清单"}),e.jsx("div",{className:"flex-1 flex h-full",children:Array.from({length:p}).map((l,w)=>{const $=Q(c,w);return e.jsx("div",{className:"flex-1 border-l border-slate-50 dark:border-slate-800/50 text-[11px] font-bold text-slate-500 flex items-center pl-3 hover:bg-slate-50 dark:hover:bg-slate-800/20 transition-colors",children:O($,"MM月")},w)})})]})]}),F.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-4 px-6 py-3 bg-slate-50/30 dark:bg-slate-800/10 border-b border-slate-100 dark:border-slate-800 sticky left-0 z-10",style:{width:`calc(14rem + ${H}px)`},children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest self-center mr-2",children:"战略任务图例:"}),F.map(l=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-sm shadow-sm",style:{backgroundColor:l.color}}),e.jsx("span",{className:"text-[11px] font-bold text-slate-600 dark:text-slate-400",children:l.name})]},l.id)),e.jsxs("div",{className:"flex items-center gap-2 ml-auto border-l border-slate-200 dark:border-slate-700 pl-4",children:[e.jsx("div",{className:"w-3 h-0.5 bg-red-400 shadow-[0_0_5px_rgba(248,113,113,0.5)]"}),e.jsx("span",{className:"text-[11px] font-bold text-red-500",children:"今日位置"})]})]}),e.jsxs("div",{className:"relative pt-4 pb-8",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none z-0",children:[e.jsx("div",{className:"flex h-full ml-56",children:Array.from({length:p}).map((l,w)=>e.jsx("div",{className:"flex-1 border-l border-dashed border-slate-100 dark:border-slate-800/50"},w))}),V>=0&&V<=100&&e.jsx("div",{className:"absolute top-0 bottom-0 w-[2px] bg-red-400/40 dark:bg-red-500/20 z-20",style:{left:`calc(14rem + ${V}%)`},children:e.jsx("div",{className:"w-full h-full border-l-2 border-dotted border-red-500/50"})})]}),e.jsx("div",{className:"space-y-4 px-0",children:t.sort((l,w)=>(l.rank||99)-(w.rank||99)).map(l=>{const w=z(l.startDate),$=z(l.endDate),Ee=U(w,c),Fe=U($,w),Ae=Ee/y*100,Ke=Fe/y*100,Le=l.status==="active"?"bg-gradient-to-r from-emerald-500 to-teal-600":l.status==="planning"?"bg-gradient-to-r from-blue-500 to-indigo-600":l.status==="completed"?"bg-gradient-to-r from-purple-500 to-fuchsia-600":"bg-gradient-to-r from-orange-400 to-amber-500";return e.jsxs("div",{className:"flex items-center group relative z-10 py-1.5 hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-all rounded-r-xl",children:[e.jsxs("div",{className:"w-56 shrink-0 px-6 sticky left-0 bg-white/95 dark:bg-slate-900/95 backdrop-blur-md z-20 border-r border-slate-100 dark:border-slate-800 flex items-center gap-3 shadow-[5px_0_15px_-5px_rgba(0,0,0,0.05)]",children:[e.jsx("div",{className:`w-2 h-2 rounded-full shrink-0 ${l.status==="active"?"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]":l.status==="completed"?"bg-purple-500":"bg-slate-300"} ${l.status==="active"?"animate-pulse":""}`}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-black text-[13px] text-slate-700 dark:text-slate-200 truncate group-hover:text-blue-600 transition-colors cursor-pointer",onClick:()=>R(`/projects/${l.id}`),children:l.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ge,{variant:"neutral",className:"text-[9px] py-0 px-1 border-none bg-slate-100 dark:bg-slate-800 font-bold opacity-60",children:["PK:",l.rank]}),e.jsxs("span",{className:"text-[10px] text-slate-400 font-black tracking-tighter",children:[O(w,"MM/dd")," » ",O($,"MM/dd")]})]})]})]}),e.jsx("div",{className:"flex-1 relative h-12 flex items-center",children:e.jsx("div",{className:`absolute h-8 rounded-lg shadow-[0_4px_12px_rgba(0,0,0,0.1)] group-hover:shadow-[0_8px_20px_rgba(37,99,235,0.2)] transition-all cursor-pointer flex items-center px-3 group/bar overflow-hidden ${l.keyTasks&&l.keyTasks.length>0?"bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700":Le}`,style:{left:`${Ae}%`,width:`${Ke}%`},onClick:()=>K(l),children:l.keyTasks&&l.keyTasks.length>0?e.jsx("div",{className:"absolute inset-0 p-0.5",children:l.keyTasks.map((X,Be)=>{const J=F.find(Ge=>Ge.id===X.definitionId);if(!J)return null;const ce=z(l.startDate).getTime(),We=z(l.endDate).getTime(),xe=z(X.startDate).getTime(),He=z(X.endDate).getTime(),me=We-ce,ue=Math.max(0,(xe-ce)/me*100),Ue=Math.min(100-ue,(He-xe)/me*100);return e.jsxs("div",{className:"absolute top-0.5 bottom-0.5 rounded-md flex items-center justify-center overflow-hidden border border-white/40 shadow-sm backdrop-blur-[2px] transition-all hover:scale-[1.05] hover:z-30 z-10",style:{backgroundColor:J.color,left:`${ue}%`,width:`${Ue}%`},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white/30 to-transparent pointer-events-none"}),e.jsx("span",{className:"text-[10px] text-white font-black truncate px-1.5 leading-none drop-shadow-[0_1px_3px_rgba(0,0,0,0.5)] pointer-events-none uppercase tracking-tighter",children:J.name})]},Be)})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-0 left-0 h-full bg-white/20 pointer-events-none transition-all duration-700",style:{width:`${l.progress||0}%`}}),e.jsxs("div",{className:"relative z-10 w-full flex items-center justify-between gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-[12px] text-white font-black truncate drop-shadow-[0_1px_3px_rgba(0,0,0,0.4)]",children:l.name}),e.jsxs("span",{className:"text-[10px] text-white/90 font-black bg-black/30 px-2 py-0.5 rounded-full backdrop-blur-sm border border-white/10 shrink-0",children:[l.progress||0,"%"]})]})]})})})]},l.id)})})]})]})})})()}),e.jsx(mt,{isOpen:_,onClose:()=>A(!1)}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:C?"Edit Project":"New Project"}),e.jsx("button",{onClick:()=>I(!1),className:"p-2 hover:bg-slate-100 rounded-full",children:e.jsx(ee,{size:24})})]}),e.jsxs("form",{onSubmit:Me,className:"p-6 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Project Name"}),e.jsx("input",{required:!0,type:"text",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:o.name,onChange:t=>m({...o,name:t.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,value:o.description,onChange:t=>m({...o,description:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-6 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:j("projects.category")}),e.jsxs("select",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:o.category,onChange:t=>m({...o,category:t.target.value}),children:[e.jsx("option",{value:"web",children:"Web 应用"}),e.jsx("option",{value:"mobile",children:"移动应用"}),e.jsx("option",{value:"data",children:"数据分析"}),e.jsx("option",{value:"infrastructure",children:"基础设施"}),e.jsx("option",{value:"custom",children:"自定义"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:j("projects.department")}),e.jsx("input",{type:"text",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:o.department,onChange:t=>m({...o,department:t.target.value}),placeholder:"输入负责部门"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[j("projects.budget")," (¥)"]}),e.jsx("input",{type:"number",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:o.budget,onChange:t=>m({...o,budget:parseInt(t.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:j("projects.status")}),e.jsxs("select",{className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:o.status,onChange:t=>m({...o,status:t.target.value}),children:[e.jsx("option",{value:"planning",children:"Planning"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"on-hold",children:"On Hold"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:j("projects.startDate")}),e.jsx("input",{type:"date",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:o.startDate,onChange:t=>m({...o,startDate:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:j("projects.endDate")}),e.jsx("input",{type:"date",className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",value:o.endDate,onChange:t=>m({...o,endDate:t.target.value})})]})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Resource Requirements"}),e.jsx("button",{type:"button",onClick:Re,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Requirement"})]}),e.jsxs("div",{className:"space-y-3",children:[(ae=o.resourceRequirements)==null?void 0:ae.map((t,a)=>e.jsxs("div",{className:"flex gap-3 items-end bg-slate-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Resource"}),e.jsx("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.resourceId,onChange:s=>L(a,"resourceId",s.target.value),children:u.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Count"}),e.jsx("input",{type:"number",min:"1",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.count,onChange:s=>L(a,"count",parseInt(s.target.value))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Duration"}),e.jsx("input",{type:"number",min:"1",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.duration,onChange:s=>L(a,"duration",parseInt(s.target.value))})]}),e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Unit"}),e.jsxs("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.unit,onChange:s=>L(a,"unit",s.target.value),children:[e.jsx("option",{value:"day",children:"Days"}),e.jsx("option",{value:"month",children:"Months"}),e.jsx("option",{value:"year",children:"Years"})]})]}),e.jsx("button",{type:"button",onClick:()=>Te(a),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(E,{size:16})})]},a)),((le=o.resourceRequirements)==null?void 0:le.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No resources allocated yet."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Project Milestones"}),e.jsx("button",{type:"button",onClick:ze,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Milestone"})]}),e.jsxs("div",{className:"space-y-3",children:[(re=o.milestones)==null?void 0:re.map((t,a)=>e.jsxs("div",{className:"flex gap-3 items-end bg-slate-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Milestone Name"}),e.jsx("input",{type:"text",placeholder:"e.g. Design Review",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.name,onChange:s=>se(a,"name",s.target.value)})]}),e.jsxs("div",{className:"w-48",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.date,onChange:s=>se(a,"date",s.target.value)})]}),e.jsx("button",{type:"button",onClick:()=>Pe(a),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(E,{size:16})})]},a)),((ne=o.milestones)==null?void 0:ne.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No milestones defined."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"关键任务 (甘特图展示)"}),e.jsx("span",{className:"text-xs bg-blue-50 text-blue-600 px-2 py-0.5 rounded-full font-medium",children:"预览可用"})]}),e.jsx("button",{type:"button",onClick:qe,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ 添加关键任务"})]}),e.jsxs("div",{className:"space-y-3",children:[(oe=o.keyTasks)==null?void 0:oe.map((t,a)=>e.jsxs("div",{className:"flex gap-3 items-end bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"任务名称"}),e.jsx("select",{className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.definitionId,onChange:s=>Y(a,"definitionId",s.target.value),children:F.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsxs("div",{className:"w-1/4",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"开始日期"}),e.jsx("input",{type:"date",className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.startDate,onChange:s=>Y(a,"startDate",s.target.value)})]}),e.jsxs("div",{className:"w-1/4",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 mb-1 block",children:"结束日期"}),e.jsx("input",{type:"date",className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-900 text-sm",value:t.endDate,onChange:s=>Y(a,"endDate",s.target.value)})]}),e.jsx("button",{type:"button",onClick:()=>$e(a),className:"p-2.5 text-slate-400 hover:text-red-500 transition-colors",children:e.jsx(E,{size:18})})]},a)),(!o.keyTasks||o.keyTasks.length===0)&&e.jsx("div",{className:"text-center py-6 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-dashed border-slate-300 dark:border-slate-700",children:e.jsx("p",{className:"text-sm text-slate-400",children:"暂未添加关键任务，甘特图将显示默认进度条"})})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Environment Resources"}),e.jsx("button",{type:"button",onClick:Ie,className:"text-sm text-blue-600 font-bold hover:underline",children:"+ Add Environment"})]}),e.jsxs("div",{className:"space-y-3",children:[(de=o.environmentRequirements)==null?void 0:de.map((t,a)=>e.jsxs("div",{className:"flex flex-col gap-3 bg-slate-50 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex gap-3 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Environment"}),e.jsxs("select",{className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.environmentId,onChange:s=>B(a,"environmentId",s.target.value),children:[k.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.type,")"]},s.id)),k.length===0&&e.jsx("option",{disabled:!0,children:"No environments available"})]})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Purpose"}),e.jsx("input",{type:"text",placeholder:"e.g. UAT Testing",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.purpose,onChange:s=>B(a,"purpose",s.target.value)})]}),e.jsx("button",{type:"button",onClick:()=>_e(a),className:"p-2 text-slate-400 hover:text-red-600",children:e.jsx(E,{size:16})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Start Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.startDate,onChange:s=>B(a,"startDate",s.target.value)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"End Date"}),e.jsx("input",{type:"date",className:"w-full p-2 rounded-lg border border-slate-200 text-sm",value:t.endDate,onChange:s=>B(a,"endDate",s.target.value)})]})]})]},a)),((ie=o.environmentRequirements)==null?void 0:ie.length)===0&&e.jsx("p",{className:"text-sm text-slate-400 italic",children:"No environment resources requested."})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Scoring Factors"}),e.jsxs("div",{className:"bg-blue-50 text-blue-700 px-3 py-1 rounded-lg font-bold text-sm",children:["Predicted Score: ",Oe.toFixed(2)]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4",children:i.map(t=>{var a,s;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("label",{className:"font-medium text-slate-600",children:t.name}),e.jsx("span",{className:"font-bold text-blue-600",children:((a=o.factors)==null?void 0:a[t.id])||0})]}),e.jsx("input",{type:"range",min:"0",max:"10",step:"1",className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600",value:((s=o.factors)==null?void 0:s[t.id])||0,onChange:c=>m(d=>({...d,factors:{...d.factors,[t.id]:parseInt(c.target.value)}}))})]},t.id)})})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>I(!1),className:"px-6 py-3 rounded-xl text-slate-600 hover:bg-slate-100 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 rounded-xl bg-blue-600 text-white font-bold hover:bg-blue-700 shadow-lg shadow-blue-600/20 transition-colors",children:"Save Project"})]})]})]})}),b&&e.jsx(ct,{templates:De,onSelect:Se,onClose:()=>N(!1)})]})};export{Mt as default};
