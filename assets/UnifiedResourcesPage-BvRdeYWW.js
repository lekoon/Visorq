import{e as $,t as O,r as v,j as e,u as T,l as se,X as G,i as te,d as U,p as P,C as I,x as je,A as ge,c as L,z as de,v as me,U as J,T as X,w as fe,a as xe,b as V,L as ve,B as Ne}from"./index-DuyEgYcZ.js";import{R as ye}from"./ResourceRiskPredictor-vC_0wVm3.js";import{R as we,a as ke,T as q,L as Q,C as le,X as ae,Y as re,B as Se}from"./generateCategoricalChart-XvSQ9IgD.js";import{P as Ce,a as De}from"./PieChart-uI1q_DM-.js";import{L as ze}from"./LineChart-DxRTK3u8.js";import{L as Me}from"./Line-CncUudUR.js";import{B as Re}from"./BarChart-4nhNMG5S.js";import{c as Pe,S as Ee,g as he,a as ue,e as Ae,E as $e}from"./EnhancedResourceTimeline-Dz3aizHR.js";import{S as K}from"./save-CLvC6SK1.js";import{P as H}from"./plus-BzO0AbKW.js";import{C as B}from"./calendar-DoNR3JSJ.js";import{f as E}from"./format-DNyNk5Xh.js";import{a as A}from"./addDays-XzP6uz5A.js";import{C as Te}from"./chart-no-axes-column-WvUO7rhm.js";import{Z as ie}from"./zap-CH4kTR5A.js";import{A as Ie}from"./activity-C0OKm_yV.js";import{s as Fe}from"./startOfMonth-CEl5U8KZ.js";import{a as ne}from"./addMonths-B_JuH7u5.js";import{C as Le}from"./CostAnalysis-C-tCrZ22.js";import{T as pe}from"./target-B0VblFvh.js";import Be from"./AIDecisionDashboard-BKckGwBI.js";import{P as Oe,a as Ue}from"./PageHeader-DZegj-OE.js";import{B as _,a as qe}from"./Badge-qs8cz14s.js";import{F as Qe}from"./filter-D8H9FR1G.js";import{D as Ke}from"./download-DlZRQ4LI.js";import{D as _e}from"./dollar-sign-BBpzWOFF.js";import"./resourcePrediction-CcaH3fYl.js";import"./AreaChart-BAmfOOzz.js";import"./endOfWeek-CJkcdxZI.js";import"./endOfDay-BFlnC4pO.js";import"./eachDayOfInterval-RgSC8RY9.js";import"./chevron-right-Cm6iGss1.js";import"./lightbulb--lm9laPg.js";import"./trending-down-BEv5rkre.js";/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=$("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=$("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=$("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=$("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=$("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);function ce(m,n){const t=+O(m),[u,a]=[+O(n.start),+O(n.end)].sort((l,b)=>l-b);return t>=u&&t<=a}const F=v.memo(({active:m,payload:n,label:t})=>!m||!n||!n.length?null:e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-slate-200",children:[t&&e.jsx("p",{className:"font-semibold text-slate-900 mb-1",children:t}),n.map((u,a)=>e.jsxs("p",{className:"text-sm",style:{color:u.color},children:[u.name,": ",e.jsx("span",{className:"font-semibold",children:u.value})]},a))]}));F.displayName="CustomTooltip";const W=v.memo(({type:m,data:n,dataKey:t="value",xKey:u="name",colors:a=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],height:l=300,showGrid:b=!0,showLegend:c=!0,showTooltip:s=!0,animate:j=!0})=>{const o=v.useMemo(()=>{if(!n||n.length===0)return[];if(n.length>100){const r=Math.ceil(n.length/100);return n.filter((i,y)=>y%r===0)}return n},[n]),h=v.useMemo(()=>({margin:{top:5,right:30,left:20,bottom:5},animationDuration:j?300:0}),[j]);if(!o||o.length===0)return e.jsx("div",{className:"flex items-center justify-center bg-slate-50 rounded-lg border border-slate-200",style:{height:l},children:e.jsx("p",{className:"text-slate-400",children:"No data available"})});const x=()=>{switch(m){case"bar":return e.jsxs(Re,{data:o,...h,children:[b&&e.jsx(le,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(ae,{dataKey:u,stroke:"#64748b",tick:{fill:"#64748b",fontSize:12}}),e.jsx(re,{stroke:"#64748b",tick:{fill:"#64748b",fontSize:12}}),s&&e.jsx(q,{content:e.jsx(F,{})}),c&&e.jsx(Q,{wrapperStyle:{fontSize:12}}),e.jsx(Se,{dataKey:t,fill:a[0],radius:[4,4,0,0],animationDuration:h.animationDuration})]});case"line":return e.jsxs(ze,{data:o,...h,children:[b&&e.jsx(le,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(ae,{dataKey:u,stroke:"#64748b",tick:{fill:"#64748b",fontSize:12}}),e.jsx(re,{stroke:"#64748b",tick:{fill:"#64748b",fontSize:12}}),s&&e.jsx(q,{content:e.jsx(F,{})}),c&&e.jsx(Q,{wrapperStyle:{fontSize:12}}),e.jsx(Me,{type:"monotone",dataKey:t,stroke:a[0],strokeWidth:2,dot:{fill:a[0],r:4},activeDot:{r:6},animationDuration:h.animationDuration})]});case"pie":return e.jsxs(Ce,{children:[e.jsx(De,{data:o,dataKey:t,nameKey:u,cx:"50%",cy:"50%",outerRadius:100,label:!0,animationDuration:h.animationDuration,children:o.map((r,i)=>e.jsx(ke,{fill:a[i%a.length]},`cell-${i}`))}),s&&e.jsx(q,{content:e.jsx(F,{})}),c&&e.jsx(Q,{wrapperStyle:{fontSize:12}})]});default:return null}};return e.jsx(we,{width:"100%",height:l,children:x()})},(m,n)=>m.type===n.type&&m.data===n.data&&m.dataKey===n.dataKey&&m.xKey===n.xKey&&m.height===n.height&&m.animate===n.animate);W.displayName="OptimizedChart";const Xe=({isOpen:m,onClose:n,resourceId:t})=>{const{resourcePool:u,updateResource:a}=T(),l=u.find(d=>d.id===t),[b,c]=v.useState("basic"),[s,j]=v.useState({}),[o,h]=v.useState([]),[x,r]=v.useState([]),[i,y]=v.useState(null);v.useEffect(()=>{l&&(j({name:l.name,totalQuantity:l.totalQuantity,costPerUnit:l.costPerUnit}),h(l.members||[]),r(l.skills||[]))},[l]);const k=()=>{var d;l&&(a(l.id,{...s,totalQuantity:parseInt(((d=s.totalQuantity)==null?void 0:d.toString())||"0")}),alert("åŸºæœ¬ä¿¡æ¯å·²ä¿å­˜"))},w=()=>{l&&(a(l.id,{members:o}),alert("æˆå‘˜åˆ—è¡¨å·²ä¿å­˜"))},p=()=>{l&&(a(l.id,{skills:x}),alert("æŠ€èƒ½åˆ—è¡¨å·²ä¿å­˜"))},g=()=>{const d={id:`member-${Date.now()}`,name:"æ–°æˆå‘˜",role:(l==null?void 0:l.name)||"Engineer",skills:[],availability:100,assignments:[],joinDate:new Date().toISOString().split("T")[0]};h([...o,d]),y(d)},N=d=>{confirm("ç¡®å®šè¦åˆ é™¤è¿™ä½æˆå‘˜å—ï¼Ÿ")&&(h(o.filter(C=>C.id!==d)),(i==null?void 0:i.id)===d&&y(null))},f=(d,C)=>{h(o.map(D=>D.id===d?{...D,...C}:D)),(i==null?void 0:i.id)===d&&y({...i,...C})};return!m||!l?null:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl h-[80vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(se,{className:"text-blue-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:l.name}),e.jsx("p",{className:"text-sm text-slate-500",children:"èµ„æºè¯¦æƒ…ç®¡ç†"})]})]}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(G,{size:20,className:"text-slate-500"})})]}),e.jsxs("div",{className:"flex border-b border-slate-200 px-6",children:[e.jsx("button",{onClick:()=>c("basic"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${b==="basic"?"border-blue-600 text-blue-600":"border-transparent text-slate-600 hover:text-slate-900"}`,children:"åŸºæœ¬ä¿¡æ¯"}),e.jsxs("button",{onClick:()=>c("members"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${b==="members"?"border-blue-600 text-blue-600":"border-transparent text-slate-600 hover:text-slate-900"}`,children:["æˆå‘˜ç®¡ç† (",o.length,")"]}),e.jsxs("button",{onClick:()=>c("skills"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${b==="skills"?"border-blue-600 text-blue-600":"border-transparent text-slate-600 hover:text-slate-900"}`,children:["æŠ€èƒ½å®šä¹‰ (",x.length,")"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50",children:[b==="basic"&&e.jsxs("div",{className:"max-w-2xl mx-auto bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"åŸºæœ¬é…ç½®"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"èµ„æºåç§°"}),e.jsx("input",{type:"text",value:s.name||"",onChange:d=>j({...s,name:d.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"æ€»å®¹é‡ (äººæ•°)"}),e.jsx("input",{type:"number",value:s.totalQuantity||0,onChange:d=>j({...s,totalQuantity:parseInt(d.target.value)}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"æ³¨æ„ï¼šä¿®æ”¹æ€»å®¹é‡ä¸ä¼šè‡ªåŠ¨æ·»åŠ æˆ–åˆ é™¤æˆå‘˜è®°å½•ã€‚"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"å•ä½æˆæœ¬ (æ¯äººæœˆ)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-slate-500",children:"$"}),e.jsx("input",{type:"number",value:s.costPerUnit||0,onChange:d=>j({...s,costPerUnit:parseFloat(d.target.value)}),className:"w-full pl-8 pr-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"pt-4 border-t border-slate-100 flex justify-end",children:e.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(K,{size:18}),e.jsx("span",{children:"ä¿å­˜æ›´æ”¹"})]})})]})]}),b==="members"&&e.jsxs("div",{className:"flex h-full gap-6",children:[e.jsxs("div",{className:"w-1/3 bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"æˆå‘˜åˆ—è¡¨"}),e.jsx("button",{onClick:g,className:"p-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:e.jsx(H,{size:18})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:[o.map(d=>e.jsxs("div",{onClick:()=>y(d),className:`p-3 rounded-lg cursor-pointer transition-colors flex items-center justify-between group ${(i==null?void 0:i.id)===d.id?"bg-blue-50 border border-blue-200":"hover:bg-slate-50 border border-transparent"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-slate-600 text-xs font-bold",children:d.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-slate-900",children:d.name}),e.jsx("div",{className:"text-xs text-slate-500",children:d.role})]})]}),e.jsx("button",{onClick:C=>{C.stopPropagation(),N(d.id)},className:"opacity-0 group-hover:opacity-100 p-1.5 text-red-500 hover:bg-red-50 rounded transition-all",children:e.jsx(te,{size:14})})]},d.id)),o.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-500 text-sm",children:"æš‚æ— æˆå‘˜ï¼Œç‚¹å‡»å³ä¸Šè§’æ·»åŠ "})]})]}),e.jsx("div",{className:"flex-1 bg-white rounded-xl shadow-sm border border-slate-200 p-6 overflow-y-auto",children:i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"ç¼–è¾‘æˆå‘˜ä¿¡æ¯"}),e.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(K,{size:16}),e.jsx("span",{children:"ä¿å­˜åˆ—è¡¨"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"å§“å"}),e.jsx("input",{type:"text",value:i.name,onChange:d=>f(i.id,{name:d.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"èŒä½/è§’è‰²"}),e.jsx("input",{type:"text",value:i.role,onChange:d=>f(i.id,{role:d.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"é‚®ç®±"}),e.jsxs("div",{className:"relative",children:[e.jsx(We,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),e.jsx("input",{type:"email",value:i.email||"",onChange:d=>f(i.id,{email:d.target.value}),className:"w-full pl-9 pr-3 py-2 border border-slate-300 rounded-lg",placeholder:"email@example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"ç”µè¯"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),e.jsx("input",{type:"text",value:i.phone||"",onChange:d=>f(i.id,{phone:d.target.value}),className:"w-full pl-9 pr-3 py-2 border border-slate-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"å…¥èŒæ—¥æœŸ"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),e.jsx("input",{type:"date",value:i.joinDate||"",onChange:d=>f(i.id,{joinDate:d.target.value}),className:"w-full pl-9 pr-3 py-2 border border-slate-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"å¯ç”¨æ€§ (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:i.availability,onChange:d=>f(i.id,{availability:parseInt(d.target.value)}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"æŠ€èƒ½ (é€—å·åˆ†éš”)"}),e.jsx("textarea",{value:i.skills.join(", "),onChange:d=>f(i.id,{skills:d.target.value.split(",").map(C=>C.trim()).filter(Boolean)}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg h-24",placeholder:"React, TypeScript, Node.js..."})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400",children:[e.jsx(se,{size:48,className:"mb-4 opacity-20"}),e.jsx("p",{children:"é€‰æ‹©å·¦ä¾§æˆå‘˜è¿›è¡Œç¼–è¾‘"})]})})]}),b==="skills"&&e.jsxs("div",{className:"max-w-3xl mx-auto bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"æŠ€èƒ½å®šä¹‰"}),e.jsxs("button",{onClick:()=>{const d={id:`skill-${Date.now()}`,name:"New Skill",level:"intermediate"};r([...x,d])},className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx(H,{size:16}),e.jsx("span",{children:"æ·»åŠ æŠ€èƒ½"})]})]}),e.jsxs("div",{className:"space-y-3",children:[x.map((d,C)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:d.name,onChange:D=>{const S=[...x];S[C].name=D.target.value,r(S)},className:"w-full px-2 py-1 bg-transparent border-b border-transparent focus:border-blue-500 focus:outline-none font-medium"})}),e.jsxs("select",{value:d.level,onChange:D=>{const S=[...x];S[C].level=D.target.value,r(S)},className:"px-2 py-1 bg-white border border-slate-200 rounded text-sm",children:[e.jsx("option",{value:"beginner",children:"åˆçº§"}),e.jsx("option",{value:"intermediate",children:"ä¸­çº§"}),e.jsx("option",{value:"advanced",children:"é«˜çº§"}),e.jsx("option",{value:"expert",children:"ä¸“å®¶"})]}),e.jsx("button",{onClick:()=>r(x.filter(D=>D.id!==d.id)),className:"text-red-500 hover:bg-red-50 p-1.5 rounded",children:e.jsx(te,{size:16})})]},d.id)),x.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-500",children:"æš‚æ— æŠ€èƒ½å®šä¹‰"})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-slate-100 flex justify-end",children:e.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(K,{size:18}),e.jsx("span",{children:"ä¿å­˜æŠ€èƒ½"})]})})]})]})]})})},Ye=(m,n,t,u="smoothing")=>{let a=JSON.parse(JSON.stringify(n));const l=new Map(n.map(g=>[g.id,g])),b=[],c=Pe(a),s=new Date(Math.min(...a.map(g=>new Date(g.startDate).getTime()))),j=new Date(Math.max(...a.map(g=>new Date(g.endDate).getTime()))),o=U(j,s);let h=0,x=0;a.sort((g,N)=>new Date(g.startDate).getTime()-new Date(N.startDate).getTime());const r=new Set;let i=j,y=new Date(s);const k=o*2+365;let w=0;for(;w<k&&!(y>i&&u==="smoothing"||r.size===a.length&&y>i);){const g=E(y,"yyyy-MM-dd");t.forEach(N=>{const f=N.totalQuantity,d=a.filter(C=>C.assignee===N.id&&C.startDate<=g&&C.endDate>=g);if(d.length>f){const C=d.length-f;x=Math.max(x,C),d.sort((S,z)=>{const R=c.criticalPath.includes(S.id),M=c.criticalPath.includes(z.id);if(R!==M)return R?1:-1;const Y={P0:3,P1:2,P2:1,P3:0},Z=S.priority&&Y[S.priority]||0,ee=z.priority&&Y[z.priority]||0;return Z!==ee?Z-ee:0});let D=0;for(const S of d){if(D>=C)break;const z=c.slack[S.id]||0;if(u==="smoothing"){if(z>0){const R=A(P(S.startDate),1),M=A(P(S.endDate),1);S.startDate=E(R,"yyyy-MM-dd"),S.endDate=E(M,"yyyy-MM-dd"),D++,h++}}else if(u==="leveling"){const R=A(P(S.startDate),1),M=A(P(S.endDate),1);S.startDate=E(R,"yyyy-MM-dd"),S.endDate=E(M,"yyyy-MM-dd"),M>i&&(i=M),D++,h++}}}}),y=A(y,1),w++}a.forEach(g=>{const N=l.get(g.id);if(N&&N.startDate!==g.startDate){const f=U(P(g.startDate),P(N.startDate));b.push({taskId:g.id,taskName:g.name,originalStart:N.startDate,newStart:g.startDate,delay:f,reason:u==="smoothing"?"èµ„æºå¹³æ»‘ï¼ˆåˆ©ç”¨æµ®åŠ¨æ—¶é—´ï¼‰":"èµ„æºå¹³è¡¡ï¼ˆè§£å†³å†²çªï¼‰"})}});const p=U(i,s);return{optimizedTasks:a,changes:b,metrics:{originalDuration:o,newDuration:p,conflictsResolved:h,resourcePeakReduced:x}}},Ze=({project:m,tasks:n,resourcePool:t,onApplyChanges:u})=>{const[a,l]=v.useState("smoothing"),[b,c]=v.useState(!1),[s,j]=v.useState(null),o=()=>{c(!0),setTimeout(()=>{const x=Ye(m,n,t,a);j(x),c(!1)},500)},h=()=>{s&&(u(s.optimizedTasks),j(null))};return e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ee,{size:20,className:"text-blue-600"}),e.jsx("h3",{className:"font-semibold text-slate-900",children:"æ™ºèƒ½è¿›åº¦è°ƒåº¦"})]}),e.jsx("p",{className:"text-sm text-slate-500",children:"è‡ªåŠ¨è°ƒæ•´ä»»åŠ¡æ—¶é—´ä»¥è§£å†³èµ„æºå†²çªå¹¶ä¼˜åŒ–å·¥æœŸ"})]}),e.jsxs("div",{className:"p-6 border-b border-slate-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>l("smoothing"),className:`p-4 rounded-lg border-2 text-left transition-all ${a==="smoothing"?"border-blue-500 bg-blue-50":"border-slate-200 hover:border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"èµ„æºå¹³æ»‘ (Smoothing)"}),a==="smoothing"&&e.jsx(I,{size:18,className:"text-blue-600"})]}),e.jsxs("p",{className:"text-sm text-slate-600",children:["åˆ©ç”¨ä»»åŠ¡æµ®åŠ¨æ—¶é—´è°ƒæ•´è¿›åº¦ï¼Œ",e.jsx("span",{className:"font-medium text-blue-700",children:"ä¸å»¶é•¿é¡¹ç›®å·¥æœŸ"}),"ã€‚é€‚ç”¨äºŽèµ„æºæœ‰é™ä½†å·¥æœŸå›ºå®šçš„åœºæ™¯ã€‚"]})]}),e.jsxs("button",{onClick:()=>l("leveling"),className:`p-4 rounded-lg border-2 text-left transition-all ${a==="leveling"?"border-purple-500 bg-purple-50":"border-slate-200 hover:border-purple-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:"èµ„æºå¹³è¡¡ (Leveling)"}),a==="leveling"&&e.jsx(I,{size:18,className:"text-purple-600"})]}),e.jsxs("p",{className:"text-sm text-slate-600",children:["å½»åº•è§£å†³èµ„æºå†²çªï¼Œå¯èƒ½",e.jsx("span",{className:"font-medium text-purple-700",children:"å»¶é•¿é¡¹ç›®å·¥æœŸ"}),"ã€‚é€‚ç”¨äºŽèµ„æºåˆšæ€§çº¦æŸçš„åœºæ™¯ã€‚"]})]})]}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("button",{onClick:o,disabled:b,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-2 font-medium",children:b?e.jsxs(e.Fragment,{children:[e.jsx(je,{size:18,className:"animate-spin"}),"æ­£åœ¨è®¡ç®—æœ€ä¼˜è§£..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{size:18}),"å¼€å§‹ä¼˜åŒ–è®¡ç®—"]})})})]}),s&&e.jsxs("div",{className:"p-6 bg-slate-50 animate-in fade-in slide-in-from-top-4 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:"ä¼˜åŒ–æ–¹æ¡ˆé¢„è§ˆ"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>j(null),className:"px-3 py-1.5 text-slate-600 hover:text-slate-900 text-sm font-medium",children:"æ”¾å¼ƒ"}),e.jsxs("button",{onClick:h,className:"px-4 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium flex items-center gap-2",children:[e.jsx(I,{size:16}),"åº”ç”¨æ–¹æ¡ˆ"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"é¡¹ç›®å·¥æœŸ"}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("span",{className:"text-xl font-bold text-slate-900",children:[s.metrics.newDuration," å¤©"]}),e.jsxs("span",{className:`text-xs mb-1 ${s.metrics.newDuration>s.metrics.originalDuration?"text-red-600":"text-green-600"}`,children:["(",s.metrics.newDuration-s.metrics.originalDuration>0?"+":"",s.metrics.newDuration-s.metrics.originalDuration," å¤©)"]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"è§£å†³å†²çª"}),e.jsxs("div",{className:"text-xl font-bold text-green-600",children:[s.metrics.conflictsResolved," ä¸ª"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"text-sm text-slate-500 mb-1",children:"èµ„æºå³°å€¼å‰Šå‡"}),e.jsxs("div",{className:"text-xl font-bold text-blue-600",children:[s.metrics.resourcePeakReduced," å•ä½"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-200 bg-slate-50 font-medium text-sm text-slate-700",children:["å˜æ›´è¯¦æƒ… (",s.changes.length,")"]}),e.jsx("div",{className:"max-h-64 overflow-y-auto divide-y divide-slate-100",children:s.changes.length===0?e.jsx("div",{className:"p-8 text-center text-slate-500 text-sm",children:"æ²¡æœ‰éœ€è¦è°ƒæ•´çš„ä»»åŠ¡ï¼Œå½“å‰è®¡åˆ’å·²æ˜¯æœ€ä¼˜ã€‚"}):s.changes.map((x,r)=>e.jsxs("div",{className:"p-4 hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-slate-900 text-sm",children:x.taskName}),e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-orange-100 text-orange-700 rounded",children:["æŽ¨è¿Ÿ ",x.delay," å¤©"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(B,{size:12}),e.jsx("span",{children:x.originalStart}),e.jsx(ge,{size:12}),e.jsx("span",{className:"text-slate-900 font-medium",children:x.newStart})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-400",children:["åŽŸå› : ",x.reason]})]},r))})]}),a==="leveling"&&s.metrics.newDuration>s.metrics.originalDuration&&e.jsxs("div",{className:"mt-4 flex items-start gap-2 p-3 bg-yellow-50 text-yellow-800 rounded-lg text-sm",children:[e.jsx(L,{size:16,className:"mt-0.5 flex-shrink-0"}),e.jsxs("p",{children:["æ³¨æ„ï¼šä¸ºäº†è§£å†³èµ„æºå†²çªï¼Œé¡¹ç›®æ€»å·¥æœŸå»¶é•¿äº† ",s.metrics.newDuration-s.metrics.originalDuration," å¤©ã€‚ è¯·ç¡®è®¤è¿™æ˜¯å¦ç¬¦åˆé¡¹ç›®äº¤ä»˜è¦æ±‚ã€‚"]})]})]})]})},es=()=>{var w;const m=de(),n=me(),{updateProject:t,addNotification:u}=T(),[a,l]=v.useState("month"),[b,c]=v.useState(null),[s,j]=v.useState(!1),[o,h]=v.useState(null),x=v.useMemo(()=>he(m,12,a),[m,a]),r=v.useMemo(()=>ue(m,n,x,a),[m,n,x,a]),i=v.useMemo(()=>{var D;const p=n.reduce((S,z)=>S+(z.totalQuantity||0),0),g=(D=x[0])==null?void 0:D.label;let N=0,f=0,d=0;r.forEach(S=>{const z=S.allocations[g],R=z?z.total:0;N+=R;const M=S.capacity>0?R/S.capacity*100:0;M>100&&f++,M<50&&d++});const C=p>0?N/p*100:0;return{totalResources:p,totalUsed:N,avgUtilization:C,overallocated:f,underutilized:d,available:p-N}},[n,r,x]),y=v.useMemo(()=>r.map(p=>{var C;const g=(C=x[0])==null?void 0:C.label,N=p.allocations[g],f=N?N.total:0,d=p.capacity>0?f/p.capacity*100:0;return{id:p.resourceId,name:p.resourceName,utilization:Math.round(d),capacity:p.capacity,used:f}}),[r,x]),k=v.useMemo(()=>x.slice(0,6).map(p=>{let g=0,N=0;return r.forEach(f=>{const d=f.allocations[p.label];g+=d?d.total:0,N+=f.capacity}),{name:p.label,utilization:N>0?Math.round(g/N*100):0,used:g,capacity:N}}),[r,x]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"èµ„æºæ€»è§ˆ"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"å®žæ—¶ç›‘æŽ§èµ„æºåˆ†é…å’Œåˆ©ç”¨æƒ…å†µ"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("select",{value:a,onChange:p=>l(p.target.value),className:"px-4 py-2 border border-slate-200 rounded-lg bg-white",children:[e.jsx("option",{value:"week",children:"æœ¬å‘¨"}),e.jsx("option",{value:"month",children:"æœ¬æœˆ"}),e.jsx("option",{value:"quarter",children:"æœ¬å­£åº¦"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(J,{className:"text-blue-600",size:24})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"æ€»èµ„æº"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:i.totalResources}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["ä½¿ç”¨ä¸­: ",i.totalUsed," (",Math.round(i.avgUtilization),"%)"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(X,{className:"text-green-600",size:24})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"å¹³å‡åˆ©ç”¨çŽ‡"})]}),e.jsxs("div",{className:"text-3xl font-bold text-slate-900",children:[Math.round(i.avgUtilization),"%"]}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx("div",{className:"flex-1 h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${i.avgUtilization>90?"bg-red-500":i.avgUtilization>70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(i.avgUtilization,100)}%`}})})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(L,{className:"text-red-600",size:24})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"è¶…é¢åˆ†é…"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:i.overallocated}),e.jsx("div",{className:"text-sm text-slate-600 mt-1",children:i.overallocated>0?"éœ€è¦è°ƒæ•´":"çŠ¶æ€è‰¯å¥½"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(ie,{className:"text-purple-600",size:24})}),e.jsx("span",{className:"text-xs font-medium text-slate-500",children:"å¯ç”¨èµ„æº"})]}),e.jsx("div",{className:"text-3xl font-bold text-slate-900",children:i.available}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:[Math.round(i.available/i.totalResources*100),"% å¯ç”¨"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"èµ„æºåˆ©ç”¨çŽ‡"}),e.jsx(fe,{className:"text-slate-400",size:20})]}),e.jsx(W,{type:"bar",data:y,dataKey:"utilization",xKey:"name",height:300,colors:["#3B82F6","#10B981","#F59E0B","#EF4444"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"åˆ©ç”¨çŽ‡è¶‹åŠ¿"}),e.jsx(Ie,{className:"text-slate-400",size:20})]}),e.jsx(W,{type:"line",data:k,dataKey:"utilization",xKey:"name",height:300,colors:["#8B5CF6"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"èµ„æºè¯¦æƒ…"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"èµ„æºåç§°"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"æ€»å®¹é‡"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"å·²ä½¿ç”¨"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"å¯ç”¨"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"åˆ©ç”¨çŽ‡"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"çŠ¶æ€"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:y.map((p,g)=>{const N=p.capacity-p.used,f=p.utilization>100?"overallocated":p.utilization>80?"high":p.utilization>50?"normal":"low";return e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors cursor-pointer",onClick:()=>{c(p.id),j(!0)},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-slate-900",children:p.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:p.capacity})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:p.used})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-slate-900",children:N})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 max-w-[100px] h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${f==="overallocated"?"bg-red-500":f==="high"?"bg-yellow-500":f==="normal"?"bg-green-500":"bg-blue-500"}`,style:{width:`${Math.min(p.utilization,100)}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-slate-900",children:[p.utilization,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${f==="overallocated"?"bg-red-100 text-red-800":f==="high"?"bg-yellow-100 text-yellow-800":f==="normal"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:f==="overallocated"?"è¶…é¢":f==="high"?"é«˜è´Ÿè½½":f==="normal"?"æ­£å¸¸":"ä½Žè´Ÿè½½"})})]},g)})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"æ™ºèƒ½è¿›åº¦è°ƒåº¦"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"è‡ªåŠ¨ä¼˜åŒ–èµ„æºåˆ†é…ï¼Œè§£å†³å†²çª"})]}),e.jsxs("select",{value:o||"",onChange:p=>h(p.target.value||null),className:"px-4 py-2 border border-slate-200 rounded-lg bg-white",children:[e.jsx("option",{value:"",children:"é€‰æ‹©é¡¹ç›®..."}),m.filter(p=>p.status==="active").map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))]})]}),o?e.jsx(Ze,{project:m.find(p=>p.id===o),tasks:((w=m.find(p=>p.id===o))==null?void 0:w.tasks)||[],resourcePool:n,onApplyChanges:p=>{const g=m.find(N=>N.id===o);g&&(t(o,{...g,tasks:p}),u({message:`é¡¹ç›®"${g.name}"çš„ä»»åŠ¡å·²æ ¹æ®ä¼˜åŒ–æ–¹æ¡ˆé‡æ–°è°ƒåº¦`,type:"success",duration:5e3}))}}):e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(ie,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"è¯·é€‰æ‹©ä¸€ä¸ªé¡¹ç›®ä»¥å¼€å§‹è°ƒåº¦ä¼˜åŒ–"})]})]}),b&&e.jsx(Xe,{isOpen:s,onClose:()=>j(!1),resourceId:b})]})},ss=({resourceLoads:m,buckets:n})=>{const t=v.useMemo(()=>m.map(l=>{const b=n.map(c=>{const s=l.allocations[c.label],j=s?s.total:0,o=l.capacity>0?j/l.capacity*100:0;return{month:c.label,used:j,capacity:l.capacity,utilization:o,projects:s?s.projects:[]}});return{resourceName:l.resourceName,cells:b}}),[m,n]),u=l=>l===0?"bg-slate-50":l<25?"bg-blue-100":l<50?"bg-green-100":l<75?"bg-yellow-100":l<100?"bg-orange-100":"bg-red-200",a=l=>l===0?"text-slate-400":l<25?"text-blue-700":l<50?"text-green-700":l<75?"text-yellow-700":l<100?"text-orange-700":"text-red-700";return e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"èµ„æºåˆ†é…çƒ­åŠ›å›¾"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"æŸ¥çœ‹èµ„æºåœ¨ä¸åŒæ—¶é—´æ®µçš„åˆ†é…æƒ…å†µ"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 bg-white z-10 px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-r border-slate-200",children:"èµ„æº"}),n.map((l,b)=>e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 min-w-[100px]",children:l.label},b))]})}),e.jsx("tbody",{children:t.map((l,b)=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"sticky left-0 bg-white z-10 px-4 py-3 font-medium text-sm text-slate-900 border-r border-slate-200",children:l.resourceName}),l.cells.map((c,s)=>e.jsxs("td",{className:`px-4 py-3 text-center border-r border-b border-slate-100 ${u(c.utilization)} transition-colors group relative`,children:[e.jsxs("div",{className:`text-sm font-semibold ${a(c.utilization)}`,children:[Math.round(c.utilization),"%"]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-0.5",children:[c.used,"/",c.capacity]}),c.projects.length>0&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block z-20",children:e.jsxs("div",{className:"bg-slate-900 text-white text-xs rounded-lg p-3 shadow-xl min-w-[200px]",children:[e.jsx("div",{className:"font-semibold mb-2",children:"åˆ†é…åˆ°çš„é¡¹ç›®:"}),c.projects.map((j,o)=>e.jsxs("div",{className:"flex justify-between items-center py-1",children:[e.jsx("span",{className:"truncate",children:j.name}),e.jsx("span",{className:"ml-2 font-mono",children:j.amount})]},o))]})})]},s))]},b))})]})}),e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-6",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"åˆ©ç”¨çŽ‡:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-slate-50 border border-slate-200 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"0%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"1-25%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"26-50%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"51-75%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-100 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"76-99%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-200 rounded"}),e.jsx("span",{className:"text-xs text-slate-600",children:"â‰¥100%"})]})]})]})},ts=(m,n)=>{const t=[],a=Fe(new Date),l=ne(a,12),b=Ae({start:a,end:l});return n.forEach(c=>{b.forEach(s=>{const j=E(s,"yyyy-MM"),o=[];let h=0;m.forEach(x=>{if(!x.startDate||!x.endDate||x.status==="completed")return;const r=P(x.startDate),i=P(x.endDate);if(!ce(s,{start:r,end:i}))return;const k=(x.resourceRequirements||[]).find(N=>N.resourceId===c.id);if(!k)return;const w=k.count;let p=k.duration;k.unit==="day"&&(p=k.duration/30),k.unit==="year"&&(p=k.duration*12);const g=ne(r,p);ce(s,{start:r,end:g})&&(o.push({projectId:x.id,projectName:x.name,allocation:w}),h+=w)}),h>c.totalQuantity&&t.push({resourceId:c.id,resourceName:c.name,period:j,capacity:c.totalQuantity,allocated:h,overallocation:h-c.totalQuantity,conflictingProjects:o})})}),t},ls=()=>{const{projects:m,resourcePool:n}=T(),{t}=xe(),u=v.useMemo(()=>ts(m,n),[m,n]),a=v.useMemo(()=>{const s=new Map;return u.forEach(j=>{const o=s.get(j.resourceId)||[];s.set(j.resourceId,[...o,j])}),s},[u]),l=u.length,b=a.size,c=u.filter(s=>s.overallocation>s.capacity*.5).length;return l===0?e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-2xl border-2 border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(I,{className:"text-green-600",size:28}),e.jsx("h3",{className:"text-lg font-bold text-green-900",children:t("conflicts.noConflicts")})]}),e.jsx("p",{className:"text-green-700",children:t("conflicts.allResourcesOptimal")})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-red-50 p-6 rounded-2xl border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(L,{className:"text-red-600",size:24}),e.jsx("h4",{className:"font-bold text-red-900",children:t("conflicts.totalConflicts")})]}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:l}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:t("conflicts.periodsAffected")})]}),e.jsxs("div",{className:"bg-orange-50 p-6 rounded-2xl border border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(J,{className:"text-orange-600",size:24}),e.jsx("h4",{className:"font-bold text-orange-900",children:t("conflicts.affectedResources")})]}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:b}),e.jsx("p",{className:"text-sm text-orange-700 mt-1",children:t("conflicts.resourceTypes")})]}),e.jsxs("div",{className:"bg-yellow-50 p-6 rounded-2xl border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(L,{className:"text-yellow-600",size:24}),e.jsx("h4",{className:"font-bold text-yellow-900",children:t("conflicts.critical")})]}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:c}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:t("conflicts.over50Percent")})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 bg-gradient-to-r from-red-50 to-orange-50",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t("conflicts.detailedView")}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:t("conflicts.reviewAndResolve")})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:Array.from(a.entries()).map(([s,j])=>{const o=n.find(h=>h.id===s);return o?e.jsxs("div",{className:"p-6 hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 text-lg",children:o.name}),e.jsxs("p",{className:"text-sm text-slate-500",children:[t("conflicts.capacity"),": ",o.totalQuantity," ",t("conflicts.units")]})]}),e.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-bold",children:[j.length," ",t("conflicts.conflicts")]})]}),e.jsx("div",{className:"space-y-3",children:j.map((h,x)=>e.jsxs("div",{className:"bg-red-50 p-4 rounded-xl border border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"text-red-600",size:18}),e.jsx("span",{className:"font-bold text-red-900",children:h.period})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-red-700",children:[t("conflicts.overallocated"),":",e.jsxs("span",{className:"font-bold ml-1",children:["+",h.overallocation," (",(h.overallocation/h.capacity*100).toFixed(0),"%)"]})]}),e.jsxs("div",{className:"text-xs text-red-600",children:[h.allocated," / ",h.capacity," ",t("conflicts.allocated")]})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"h-3 bg-red-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-red-600 transition-all",style:{width:`${Math.min(h.allocated/h.capacity*100,100)}%`}})})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-bold text-red-800 mb-2",children:[t("conflicts.conflictingProjects"),":"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:h.conflictingProjects.map(r=>e.jsxs("div",{className:"px-3 py-1 bg-white border border-red-300 rounded-lg text-xs",children:[e.jsx("span",{className:"font-medium text-slate-900",children:r.projectName}),e.jsxs("span",{className:"text-red-600 ml-2",children:["(",r.allocation," ",t("conflicts.units"),")"]})]},r.projectId))})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-red-300",children:e.jsxs("p",{className:"text-xs text-red-800",children:[e.jsxs("span",{className:"font-bold",children:["ðŸ’¡ ",t("conflicts.recommendation"),":"]}),h.overallocation>h.capacity*.5?t("conflicts.criticalRecommendation"):t("conflicts.moderateRecommendation")]})})]},`${h.period}-${x}`))})]},s):null})})]})]})},oe={beginner:1,intermediate:2,advanced:3,expert:4},be=(m,n,t="intermediate")=>{if(!n||n.length===0)return{matchScore:100,matchedSkills:[],missingSkills:[],qualifiedSkills:[]};if(!m||m.length===0)return{matchScore:0,matchedSkills:[],missingSkills:n,qualifiedSkills:[]};const u=oe[t],a=[],l=[],b=[];n.forEach(o=>{const h=m.find(x=>x.id===o);h?(a.push(o),oe[h.level]>=u&&l.push(o)):b.push(o)});const c=a.length/n.length*100,s=l.length/n.length*20;return{matchScore:Math.min(c+s,100),matchedSkills:a,missingSkills:b,qualifiedSkills:l}},as=(m,n,t=60)=>n.map(a=>{const l=be(a.skills||[],m.requiredSkills||[]);return{resourceId:a.id,resourceName:a.name,matchScore:l.matchScore,matchDetails:l}}).filter(a=>a.matchScore>=t).sort((a,l)=>l.matchScore-a.matchScore),rs=(m,n)=>{const t=new Map;let u=0,a=0,l=0,b=0;m.forEach(j=>{(j.resourceRequirements||[]).forEach(o=>{if(!o.requiredSkills||o.requiredSkills.length===0)return;u++;const h=n.find(r=>r.id===o.resourceId);if(!h){b++,o.requiredSkills.forEach(r=>{const i=t.get(r)||{occurrences:0,projects:[]};t.set(r,{occurrences:i.occurrences+1,projects:[...i.projects,j.name]})});return}const x=be(h.skills||[],o.requiredSkills);x.matchScore===100?a++:x.matchScore>0?(l++,x.missingSkills.forEach(r=>{const i=t.get(r)||{occurrences:0,projects:[]};t.set(r,{occurrences:i.occurrences+1,projects:[...i.projects,j.name]})})):(b++,o.requiredSkills.forEach(r=>{const i=t.get(r)||{occurrences:0,projects:[]};t.set(r,{occurrences:i.occurrences+1,projects:[...i.projects,j.name]})}))})});const c=Array.from(t.entries()).map(([j,o])=>({skillId:j,occurrences:o.occurrences,projects:o.projects})).sort((j,o)=>o.occurrences-j.occurrences),s=[];if(c.length>0){const j=c[0];s.push(`Consider hiring or training resources with "${j.skillId}" skill (needed in ${j.occurrences} projects)`)}return b>u*.3&&s.push(`High skill mismatch rate (${(b/u*100).toFixed(0)}%). Review resource allocation strategy.`),l>a&&s.push("Many partial matches detected. Consider upskilling existing resources."),{totalRequirements:u,fullyMatched:a,partiallyMatched:l,unmatched:b,missingSkills:c,recommendations:s}},is=()=>{const{projects:m,resourcePool:n}=T(),{t}=xe(),[u,a]=v.useState(""),[l,b]=v.useState(60),c=v.useMemo(()=>rs(m,n),[m,n]),s=m.find(r=>r.id===u),j=v.useMemo(()=>{var i;if(!s||!((i=s.resourceRequirements)!=null&&i.length))return[];const r=[];return(s.resourceRequirements||[]).forEach(y=>{if(y.requiredSkills&&y.requiredSkills.length>0){const k=as(y,n,l);r.push({requirement:y,recommendations:k})}}),r},[s,n,l]),o=c.totalRequirements>0?(c.fullyMatched+c.partiallyMatched)/c.totalRequirements*100:100,h=r=>{switch(r){case"beginner":return"bg-blue-100 text-blue-700";case"intermediate":return"bg-green-100 text-green-700";case"advanced":return"bg-orange-100 text-orange-700";case"expert":return"bg-purple-100 text-purple-700";default:return"bg-slate-100 text-slate-700"}},x=r=>({beginner:t("skills.beginner"),intermediate:t("skills.intermediate"),advanced:t("skills.advanced"),expert:t("skills.expert")})[r]||r;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 p-6 rounded-2xl border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(pe,{className:"text-blue-600",size:24}),e.jsx("h4",{className:"font-bold text-blue-900",children:t("skills.totalRequirements")})]}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:c.totalRequirements}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:t("skills.acrossProjects")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-2xl border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Ve,{className:"text-green-600",size:24}),e.jsx("h4",{className:"font-bold text-green-900",children:t("skills.fullyMatched")})]}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:c.fullyMatched}),e.jsxs("p",{className:"text-sm text-green-700 mt-1",children:[c.totalRequirements>0?`${(c.fullyMatched/c.totalRequirements*100).toFixed(0)}%`:"0%"," ",t("skills.perfect")]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 p-6 rounded-2xl border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(X,{className:"text-yellow-600",size:24}),e.jsx("h4",{className:"font-bold text-yellow-900",children:t("skills.partialMatches")})]}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:c.partiallyMatched}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:t("skills.needsImprovement")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 p-6 rounded-2xl border border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(V,{className:"text-red-600",size:24}),e.jsx("h4",{className:"font-bold text-red-900",children:t("skills.unmatched")})]}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:c.unmatched}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:t("skills.criticalGaps")})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-100",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:t("skills.overallMatchRate")}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"h-8 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-500 transition-all duration-500 flex items-center justify-end pr-4",style:{width:`${o}%`},children:e.jsxs("span",{className:"text-white font-bold text-sm",children:[o.toFixed(1),"%"]})})})})]}),c.missingSkills.length>0&&e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(He,{className:"text-orange-600",size:24}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t("skills.topMissingSkills")})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.missingSkills.slice(0,9).map((r,i)=>e.jsxs("div",{className:"p-4 bg-orange-50 rounded-xl border border-orange-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:r.skillId}),e.jsxs("span",{className:"px-2 py-1 bg-orange-200 text-orange-800 rounded-full text-xs font-bold",children:["#",i+1]})]}),e.jsxs("p",{className:"text-sm text-slate-600 mb-2",children:[t("skills.neededIn")," ",e.jsx("span",{className:"font-bold text-orange-600",children:r.occurrences})," ",t("skills.projects")]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.projects.slice(0,3).map((y,k)=>e.jsx("span",{className:"text-xs bg-white px-2 py-1 rounded border border-orange-300",children:y.length>15?y.substring(0,15)+"...":y},k)),r.projects.length>3&&e.jsxs("span",{className:"text-xs text-orange-600 px-2 py-1",children:["+",r.projects.length-3," ",t("skills.more")]})]})]},r.skillId))})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(J,{className:"text-blue-600",size:24}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:t("skills.resourceRecommendations")})]}),e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:t("skills.selectProject")}),e.jsxs("select",{value:u,onChange:r=>a(r.target.value),className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:t("skills.chooseProject")}),m.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{className:"w-full md:w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:t("skills.minMatchScore")}),e.jsx("input",{type:"number",min:"0",max:"100",value:l,onChange:r=>b(parseInt(r.target.value)||0),className:"w-full p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),s&&j.length>0?e.jsx("div",{className:"space-y-6",children:j.map((r,i)=>{const y=n.find(k=>k.id===r.requirement.resourceId);return e.jsxs("div",{className:"border border-slate-200 rounded-xl p-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("h4",{className:"font-bold text-slate-900",children:[t("skills.requirement")," #",i+1,": ",(y==null?void 0:y.name)||t("skills.unknownResource")]}),r.requirement.requiredSkills&&r.requirement.requiredSkills.length>0&&e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:[t("skills.requiredSkills"),": ",r.requirement.requiredSkills.join(", ")]})]}),r.recommendations.length>0?e.jsx("div",{className:"space-y-2",children:r.recommendations.map((k,w)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-bold text-slate-900",children:k.resourceName}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:k.matchDetails.matchedSkills.map(p=>{var f;const g=n.find(d=>d.id===k.resourceId),N=(f=g==null?void 0:g.skills)==null?void 0:f.find(d=>d.id===p);return N?e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${h(N.level)}`,children:[N.name," (",x(N.level),")"]},p):null})}),k.matchDetails.missingSkills.length>0&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:[t("skills.missing"),": ",k.matchDetails.missingSkills.join(", ")]})]}),e.jsxs("div",{className:"ml-4 text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[k.matchScore.toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-slate-500",children:t("skills.match")})]})]},w))}):e.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:t("skills.noRecommendations")})]},i)})}):s?e.jsx("p",{className:"text-slate-500 text-center py-8",children:t("skills.noRequirements")}):e.jsx("p",{className:"text-slate-500 text-center py-8",children:t("skills.selectProjectPrompt")})]}),c.recommendations.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-2xl border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(V,{className:"text-purple-600",size:24}),e.jsx("h3",{className:"text-lg font-bold text-purple-900",children:t("skills.actionableRecommendations")})]}),e.jsx("div",{className:"space-y-3",children:c.recommendations.map((r,i)=>e.jsxs("div",{className:"flex gap-3 p-4 bg-white rounded-xl border border-purple-300",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ’¡"}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:r})]},i))})]})]})},ns=(m,n)=>{const t=["èµ„æºåç§°","æ€»å®¹é‡",...n.map(s=>s.label),"å¹³å‡åˆ©ç”¨çŽ‡"],u=m.map(s=>{const j=n.map(h=>{const x=s.allocations[h.label],r=x?x.total:0,i=s.capacity>0?r/s.capacity*100:0;return`${Math.round(i)}%`}),o=n.reduce((h,x)=>{const r=s.allocations[x.label],i=r?r.total:0,y=s.capacity>0?i/s.capacity*100:0;return h+y},0)/n.length;return[s.resourceName,s.capacity.toString(),...j,`${Math.round(o)}%`]}),a=[t.join(","),...u.map(s=>s.join(","))].join(`
`),l=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a"),c=URL.createObjectURL(l);b.setAttribute("href",c),b.setAttribute("download",`èµ„æºåˆ©ç”¨çŽ‡_${new Date().toISOString().split("T")[0]}.csv`),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b)},cs=m=>{const n=["èµ„æºåç§°","æ€»æ•°é‡","å·²åˆ†é…","å¯ç”¨","æŠ€èƒ½"],t=m.map(c=>{var h;const s=((h=c.skills)==null?void 0:h.map(x=>x.name).join("; "))||"",j=0,o=c.totalQuantity-j;return[c.name,c.totalQuantity.toString(),j.toString(),o.toString(),s]}),u=[n.join(","),...t.map(c=>c.map(s=>`"${s}"`).join(","))].join(`
`),a=new Blob(["\uFEFF"+u],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),b=URL.createObjectURL(a);l.setAttribute("href",b),l.setAttribute("download",`èµ„æºæ± _${new Date().toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)},os=(m,n)=>{const t=JSON.stringify(m,null,2),u=new Blob([t],{type:"application/json"}),a=document.createElement("a"),l=URL.createObjectURL(u);a.setAttribute("href",l),a.setAttribute("download",`${n}_${new Date().toISOString().split("T")[0]}.json`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},ds=({isOpen:m,onClose:n})=>{const{addResource:t}=T(),[u,a]=v.useState({name:"",totalQuantity:1}),l=c=>{if(c.preventDefault(),!u.name.trim()){alert("è¯·è¾“å…¥èµ„æºåç§°");return}if(u.totalQuantity<=0){alert("èµ„æºæ•°é‡å¿…é¡»å¤§äºŽ0");return}const s={id:`resource-${Date.now()}`,name:u.name.trim(),totalQuantity:u.totalQuantity,skills:[],members:[]};t(s),a({name:"",totalQuantity:1}),n()},b=()=>{a({name:"",totalQuantity:1}),n()};return m?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:b}),e.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"æ·»åŠ èµ„æº"}),e.jsx("button",{onClick:b,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(G,{size:20,className:"text-slate-500"})})]}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["èµ„æºåç§° ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:u.name,onChange:c=>a({...u,name:c.target.value}),placeholder:"ä¾‹å¦‚ï¼šå¼€å‘å·¥ç¨‹å¸ˆã€è®¾è®¡å¸ˆ",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["æ€»æ•°é‡ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"1",value:u.totalQuantity,onChange:c=>a({...u,totalQuantity:parseInt(c.target.value)||1}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:b,className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors",children:"å–æ¶ˆ"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:"æ·»åŠ "})]})]})]})]}):null},_s=()=>{const[m,n]=v.useState("dashboard"),[t,u]=v.useState(!1),[a,l]=v.useState(!1),[b,c]=v.useState(!1),[s,j]=v.useState("all"),o=de(),h=me(),x=v.useMemo(()=>he(o,12),[o]),r=v.useMemo(()=>ue(o,h,x),[o,h,x]),i=v.useMemo(()=>s==="all"?r:r.filter(w=>{var d;const p=(d=x[0])==null?void 0:d.label,g=w.allocations[p],N=g?g.total:0,f=w.capacity>0?N/w.capacity*100:0;switch(s){case"low":return f<50;case"normal":return f>=50&&f<=80;case"high":return f>80&&f<=100;case"over":return f>100;default:return!0}}),[r,s,x]),y=[{id:"dashboard",label:"æ€»è§ˆ",icon:ve,color:"blue"},{id:"heatmap",label:"çƒ­åŠ›å›¾",icon:Je,color:"purple"},{id:"gantt",label:"æ—¶é—´çº¿",icon:B,color:"green"},{id:"conflicts",label:"å†²çªæ£€æµ‹",icon:V,color:"red"},{id:"costs",label:"æˆæœ¬åˆ†æž",icon:_e,color:"yellow"},{id:"skills",label:"æŠ€èƒ½åŒ¹é…",icon:pe,color:"indigo"},{id:"decision",label:"å†³ç­–æ”¯æŒ",icon:Ne,color:"rose"},{id:"prediction",label:"è´Ÿè·é¢„æµ‹",icon:X,color:"blue"}],k=w=>{w==="csv"?m==="heatmap"||m==="dashboard"?ns(i,x):cs(h):os({resourceLoads:i,resourcePool:h,exportDate:new Date().toISOString()},"èµ„æºæ•°æ®"),u(!1)};return e.jsxs(Oe,{children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-30 -mx-6 -mt-6 px-6 pt-6",children:[e.jsx(Ue,{title:"èµ„æºç®¡ç†",description:"å…¨æ–¹ä½èµ„æºç›‘æŽ§ä¸Žåˆ†æž",actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(_,{onClick:w=>{w.stopPropagation(),l(!a)},variant:a||s!=="all"?"primary":"secondary",icon:Qe,children:["ç­›é€‰",s!=="all"&&e.jsx(qe,{variant:"danger",size:"sm",rounded:"full",className:"ml-2",children:"1"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{onClick:()=>u(!t),variant:"secondary",icon:Ke,children:"å¯¼å‡º"}),t&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-slate-800 rounded-lg shadow-xl border border-slate-200 dark:border-slate-700 py-2 z-50",children:[e.jsx("button",{onClick:()=>k("csv"),className:"w-full px-4 py-2 text-left text-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"å¯¼å‡ºä¸º CSV"}),e.jsx("button",{onClick:()=>k("json"),className:"w-full px-4 py-2 text-left text-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"å¯¼å‡ºä¸º JSON"}),e.jsx("button",{onClick:()=>{window.print(),u(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"æ‰“å°æŠ¥è¡¨"})]})]}),e.jsx(_,{onClick:()=>c(!0),variant:"primary",icon:H,children:"æ·»åŠ èµ„æº"})]})}),a&&e.jsxs("div",{className:"mb-4 p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-medium text-slate-900",children:"ç­›é€‰æ¡ä»¶"}),e.jsx("button",{onClick:()=>{j("all"),l(!1)},className:"text-sm text-slate-600 hover:text-slate-900",children:e.jsx(G,{size:16})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"åˆ©ç”¨çŽ‡èŒƒå›´"}),e.jsx("div",{className:"flex gap-2",children:[{value:"all",label:"å…¨éƒ¨"},{value:"low",label:"ä½Žè´Ÿè½½ (<50%)"},{value:"normal",label:"æ­£å¸¸ (50-80%)"},{value:"high",label:"é«˜è´Ÿè½½ (80-100%)"},{value:"over",label:"è¶…é¢ (>100%)"}].map(w=>e.jsx("button",{onClick:p=>{p.stopPropagation(),j(w.value)},className:`px-3 py-1.5 text-sm rounded-lg transition-colors ${s===w.value?"bg-blue-600 text-white":"bg-white text-slate-700 hover:bg-slate-100 border border-slate-200"}`,children:w.label},w.value))})]})]}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:y.map(w=>{const p=w.icon,g=m===w.id;return e.jsxs("button",{onClick:()=>n(w.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium transition-all whitespace-nowrap ${g?"bg-blue-100 text-blue-700 shadow-sm":"text-slate-600 hover:bg-slate-100"}`,children:[e.jsx(p,{size:18}),e.jsx("span",{children:w.label})]},w.id)})})]}),e.jsxs("div",{className:"mt-6",children:[m==="dashboard"&&e.jsx(es,{}),m==="heatmap"&&e.jsx(ss,{resourceLoads:i,buckets:x}),m==="gantt"&&e.jsx($e,{projects:o,resources:h}),m==="conflicts"&&e.jsx(ls,{}),m==="costs"&&e.jsx(Le,{}),m==="skills"&&e.jsx(is,{}),m==="decision"&&e.jsx(Be,{}),m==="prediction"&&e.jsx(ye,{projects:o,resourcePool:h})]}),(t||a)&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>{u(!1)}}),e.jsx(ds,{isOpen:b,onClose:()=>c(!1)})]})};export{_s as default};
