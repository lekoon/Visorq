# CTPM Tool - 国际化功能说明

## 概述

CTPM Tool 现已支持**中英文双语切换**，为全球用户提供本地化体验。

---

## 功能特性

### ✅ 已实现的国际化功能

1. **自动语言检测**
   - 系统自动检测浏览器语言
   - 首次访问时自动设置为浏览器语言

2. **一键切换**
   - 点击右上角的语言切换按钮
   - 实时切换，无需刷新页面
   - 切换后的语言设置会被保存

3. **全面覆盖**
   - ✅ 导航菜单
   - ✅ 登录页面
   - ✅ 仪表板（Dashboard）
   - ✅ 项目管理
   - ✅ 资源管理
   - ✅ 分析报告
   - ✅ 系统设置
   - ✅ 所有按钮和标签

---

## 使用方法

### 切换语言

1. 登录系统后，在页面右上角找到语言切换按钮
2. 按钮显示当前语言：
   - **English** - 当前为英文
   - **中文** - 当前为中文
3. 点击按钮即可切换语言

### 支持的语言

| 语言 | 代码 | 状态 |
|------|------|------|
| 英文 | `en` | ✅ 完全支持 |
| 中文 | `zh` | ✅ 完全支持 |

---

## 技术实现

### 使用的技术栈

```json
{
  "i18next": "^23.x",
  "react-i18next": "^14.x",
  "i18next-browser-languagedetector": "^7.x"
}
```

### 文件结构

```
src/
├── i18n/
│   ├── config.ts          # i18n 配置文件
│   ├── en.ts              # 英文翻译
│   └── zh.ts              # 中文翻译
├── main.tsx               # 导入 i18n 配置
└── components/
    └── Layout.tsx         # 语言切换按钮
```

### 翻译文件示例

**英文 (en.ts)**:
```typescript
export const en = {
  common: {
    dashboard: 'Dashboard',
    projects: 'Projects',
    // ...
  },
  dashboard: {
    title: 'Executive Dashboard',
    subtitle: 'Real-time portfolio insights',
    // ...
  }
}
```

**中文 (zh.ts)**:
```typescript
export const zh = {
  common: {
    dashboard: '仪表板',
    projects: '项目管理',
    // ...
  },
  dashboard: {
    title: '高管仪表板',
    subtitle: '实时项目组合洞察',
    // ...
  }
}
```

### 在组件中使用

```tsx
import { useTranslation } from 'react-i18next';

const MyComponent = () => {
  const { t } = useTranslation();
  
  return (
    <h1>{t('dashboard.title')}</h1>
  );
};
```

---

## 翻译对照表

### 常用术语

| 英文 | 中文 | 说明 |
|------|------|------|
| Dashboard | 仪表板 | 主页面 |
| Projects | 项目管理 | 项目列表页 |
| Resources | 资源管理 | 资源池管理 |
| Analysis | 分析报告 | 数据分析页 |
| Settings | 系统设置 | 配置页面 |
| Portfolio Health | 组合健康度 | KPI 指标 |
| At Risk | 风险项目 | 警告指标 |
| High Priority | 高优先级 | 重要项目 |
| Resource Utilization | 资源利用率 | 效率指标 |
| Export Report | 导出报告 | 数据导出 |
| Backup Now | 立即备份 | 数据备份 |
| Restore | 恢复 | 数据恢复 |

### 项目状态

| 英文 | 中文 |
|------|------|
| Planning | 规划中 |
| Active | 进行中 |
| On Hold | 已暂停 |
| Completed | 已完成 |

### 资源状态

| 英文 | 中文 |
|------|------|
| Healthy | 健康 |
| High | 高负荷 |
| Overloaded | 超载 |

---

## 扩展新语言

### 步骤

1. **创建新的翻译文件**

```typescript
// src/i18n/fr.ts (法语示例)
export const fr = {
  common: {
    dashboard: 'Tableau de bord',
    projects: 'Projets',
    // ... 其他翻译
  }
}
```

2. **更新配置文件**

```typescript
// src/i18n/config.ts
import { fr } from './fr';

i18n.init({
  resources: {
    en: { translation: en },
    zh: { translation: zh },
    fr: { translation: fr }, // 添加新语言
  },
  // ...
});
```

3. **更新语言切换器**

```tsx
// src/components/Layout.tsx
const languages = [
  { code: 'en', name: 'English' },
  { code: 'zh', name: '中文' },
  { code: 'fr', name: 'Français' }, // 添加新语言
];
```

---

## 最佳实践

### 1. 翻译键命名规范

```typescript
{
  "模块名.功能.具体内容": "翻译文本"
}
```

**示例**:
```typescript
{
  "dashboard.kpi.totalProjects": "Total Projects",
  "projects.form.projectName": "Project Name",
  "settings.data.backup": "Backup Data"
}
```

### 2. 避免硬编码文本

❌ **错误**:
```tsx
<h1>Dashboard</h1>
```

✅ **正确**:
```tsx
<h1>{t('common.dashboard')}</h1>
```

### 3. 处理复数和变量

```typescript
// 翻译文件
{
  "projects.count": "{{count}} projects",
  "projects.count_plural": "{{count}} projects"
}

// 使用
t('projects.count', { count: 5 }) // "5 projects"
```

---

## 常见问题

### Q: 如何设置默认语言？

A: 在 `src/i18n/config.ts` 中修改 `fallbackLng`:

```typescript
i18n.init({
  fallbackLng: 'zh', // 改为中文
  // ...
});
```

### Q: 语言切换后没有生效？

A: 确保：
1. 已导入 `useTranslation` hook
2. 使用 `t()` 函数包裹所有文本
3. 翻译键在翻译文件中存在

### Q: 如何添加新的翻译？

A: 
1. 在 `src/i18n/en.ts` 和 `src/i18n/zh.ts` 中添加相同的键
2. 在组件中使用 `t('新的键')`

---

## 性能优化

### 1. 懒加载翻译文件

对于大型应用，可以按需加载翻译：

```typescript
import i18next from 'i18next';
import Backend from 'i18next-http-backend';

i18next
  .use(Backend)
  .init({
    backend: {
      loadPath: '/locales/{{lng}}/{{ns}}.json',
    },
  });
```

### 2. 缓存翻译

浏览器会自动缓存已加载的翻译文件，提高性能。

---

## 测试

### 手动测试清单

- [ ] 切换语言后所有文本正确显示
- [ ] 刷新页面后语言设置保持
- [ ] 登录页面支持多语言
- [ ] 所有页面的按钮、标签都已翻译
- [ ] 表格标题、图表标签已翻译
- [ ] 错误提示信息已翻译

### 自动化测试示例

```typescript
import { renderHook } from '@testing-library/react';
import { useTranslation } from 'react-i18next';

test('translation works', () => {
  const { result } = renderHook(() => useTranslation());
  expect(result.current.t('common.dashboard')).toBe('Dashboard');
});
```

---

## 更新日志

### v1.0.0 (2025-11-24)

- ✅ 实现中英文双语支持
- ✅ 添加语言自动检测
- ✅ 实现一键切换功能
- ✅ 翻译所有核心页面
- ✅ 添加语言切换按钮到导航栏

---

## 贡献指南

### 添加新翻译

1. Fork 项目
2. 在 `src/i18n/` 下添加新语言文件
3. 更新 `config.ts`
4. 提交 Pull Request

### 改进现有翻译

1. 在 `src/i18n/en.ts` 或 `zh.ts` 中修改
2. 确保两个文件的键保持一致
3. 提交 Pull Request

---

## 技术支持

如有问题，请参考：
- [i18next 官方文档](https://www.i18next.com/)
- [react-i18next 文档](https://react.i18next.com/)
- 项目 Issues 页面

---

**文档版本**: 1.0  
**最后更新**: 2025-11-24  
**维护者**: 开发团队
